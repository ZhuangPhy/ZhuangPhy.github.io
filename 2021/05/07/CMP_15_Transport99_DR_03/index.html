<!DOCTYPE html>
<html lang="en">





<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="JPZhuang">
  <meta name="keywords" content="">
  <title>纳米尺度下量子输运理论-3 - JPZ</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Physics</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('https://jptanjing.oss-cn-beijing.aliyuncs.com/blog_QuantumAI/CMP_15_Transport99.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2021-05-07 23:03">
      May 7, 2021 pm
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      17k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      337
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>[TOC]</p>
<h4 id="reference">Reference:</h4>
<ol type="1">
<li>《Theory of Quantum Transport at Nanoscale - An Introduction》 Dmitry A. Ryndyk</li>
</ol>
<p>outline</p>
<p>[TOC]</p>
<h4 id="reference-1">Reference:</h4>
<ol type="1">
<li>《Theory of Quantum Transport at Nanoscale - An Introduction》 Dmitry A. Ryndyk</li>
</ol>
<h2 id="chapter-3-green-functions">Chapter 3 Green Functions</h2>
<style>
  /* 设置整个页面的字体 */
  html, body, .markdown-body {
    font-family: KaiTi,"Microsoft YaHei",Georgia, sans, serif;
    font-size: 15px;
  }
</style>
<p>In this chapter we formulate the Landauer approach using the Green function (GF) formalism. It is a mathematically elegant and numerically effective method to describe quantum scattering and transport. In Sect.3.1 we consider definitions and basic properties of retarded (and advanced) Green functions and discuss the relations between</p>
<ol type="1">
<li>Schrödinger equation,</li>
<li>wave functions,</li>
<li>GFs,</li>
<li>and the scattering matrix.</li>
</ol>
<p>Atomic and molecular scale systems are naturally described by discrete-level models, based, for example, on atomic orbitals and molecular orbitals. For continuous systems with complex geometries and/or disorder, discretization is a first step towards numerical computational methods.</p>
<ol type="1">
<li>Starting from discrete-level representations we come to matrix Green functions, being the main theoretical tool at nanoscale. On the other hand, electrodes are assumed to be infinitely large and have continuous energy spectrum.</li>
<li>To include the electrode effects systematically, it is reasonable to start from the discrete-level representation for the whole system. It can be made with a help of the tight-binding (TB) model, which was proposed to describe quantum systems in which the localized electronic states play essential role, it is widely used as an alternative to the plane wave description of electrons in solids, and also as a method to calculate the electronic structure of molecules in quantum chemistry.</li>
<li>All effects of the equilibrium electrodes can be included into the matrix equations for the central region through the self-energies.</li>
</ol>
<p>框架 1. We consider the matrix formalism in general in Sect. <span class="math inline">\(3.2\)</span> 2. and the recursive method for long or complex systems in Sect. <span class="math inline">\(3.3\)</span> 3. Finally, calculation of self-energies for semi-infinite electrodes requires some special methods, which are considered in Sect. <span class="math inline">\(3.4\)</span></p>
<p>Note that Green functions introduced in this section are single-particle GFs in non-interacting systems. The extension of the technique to many-body systems with interactions will be considered in Chap. 7 .</p>
<h2 id="green-functions-and-the-scattering-problem">3.1 Green Functions and the Scattering Problem</h2>
<h3 id="retarded-and-advanced-green-functions">3.1.1 Retarded and Advanced Green Functions</h3>
<p>Green functions are known to be a convenient tool to solve linear differential equations, including the Schrödinger equation in quantum mechanics. Being completely equivalent to the Landauer scattering approach, the GF technique has the advantage that it calculates relevant transport quantities (e.g. transmission function) using effective numerical techniques. Besides, the Green function formalism is well adopted for atomic and molecular discrete-level systems and can be easily extended to include inelastic and many-body effects. First of all, we give the formal general definition and the basic properties of retarded and advanced Green functions (also called propagators). Let us start from the time-dependent Schrödinger equation <span class="math display">\[
i \hbar \frac{\partial|\Psi(t)\rangle}{\partial t}=\hat{H}|\Psi(t)\rangle
\]</span> In this section we use general Dirac notations <span class="math inline">\(|\ldots\rangle\)</span> for quantum states and general operator notations <span class="math inline">\(\therefore\)</span>. to show that the representation is arbitrary (coordinate and matrix representations considered below are special cases). The solution of this equation at time <span class="math inline">\(t\)</span> can be written in terms of the solution at time <span class="math inline">\(t^{\prime}:\)</span> <span class="math display">\[
|\Psi(t)\rangle=\hat{U}\left(t, t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> where <span class="math inline">\(\hat{U}\left(t, t^{\prime}\right)\)</span> is called the time-evolution operator.</p>
<h4 id="基底">基底</h4>
<p>Below we consider only the case of a time-independent Hermitian Hamiltonian <span class="math inline">\(\hat{H}\)</span>, so that the eigenstates <span class="math inline">\(\left|\Psi_{n}(t)\right\rangle=e^{-i E_{n} t / \hbar}\left|\Psi_{n}\right\rangle\)</span> with energies <span class="math inline">\(E_{n}\)</span> are found from the stationary Schrödinger equation <span class="math display">\[
\hat{H}\left|\Psi_{n}\right\rangle=E_{n}\left|\Psi_{n}\right\rangle
\]</span> The eigenfunctions <span class="math inline">\(\left|\Psi_{n}\right\rangle\)</span> are orthogonal and normalized, for discrete energy levels <span class="math inline">\({ }^{1}\)</span> : <span class="math display">\[
\left\langle\Psi_{n} \mid \Psi_{m}\right\rangle=\delta_{n m}
\]</span> and form a complete set of states ( <span class="math inline">\(\hat{I}\)</span> is the unity operator) <span class="math display">\[
\sum_{n}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|=\hat{I}
\]</span> For continuous spectrum the orthogonality condition is <span class="math display">\[
\left\langle\Psi_{k} \mid \Psi_{k^{\prime}}\right\rangle=\delta\left(k-k^{\prime}\right)
\]</span> and the completeness in the case of combined (discrete and continuous) spectrum is written explicitly as <span class="math display">\[
\sum_{n}\left|\Psi_{n}\right\rangle \langle\Psi_{n} |+\int d k | \Psi_{k} \rangle\left\langle\Psi_{k}\right|=\hat{I}
\]</span> #### 时间演化算符在基底展开</p>
<p>The time-evolution operator for a time-independent Hamiltonian can be written as <span class="math display">\[
\hat{U}\left(t-t^{\prime}\right)=e^{-i\left(t-t^{\prime}\right) \hat{H} / \hbar} .
\]</span> This formal solution is difficult to use directly in most cases, but one can obtain the useful eigenstate representation from it. From the identity <span class="math inline">\(\hat{U}=\hat{U} \hat{I}\)</span> it follows that <span class="math inline">\(^{2}\)</span> <span class="math display">\[
\hat{U}\left(t-t^{\prime}\right)=\sum_{n} e^{-\frac{i}{\hbar} E_{n}\left(t-t^{\prime}\right)}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|
\]</span> which demonstrates the superposition principle.</p>
<p>The wave function at time <span class="math inline">\(t\)</span> is <span class="math display">\[
|\Psi(t)\rangle=\hat{U}\left(t, t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle=\sum_{n} e^{-\frac{i}{\hbar} E_{n}\left(t-t^{\prime}\right)}\left\langle\Psi_{n} \mid \Psi\left(t^{\prime}\right)\right\rangle\left|\Psi_{n}\right\rangle
\]</span> where</p>
<ul>
<li><span class="math inline">\(\left\langle\Psi_{n} \mid \Psi\left(t^{\prime}\right)\right\rangle\)</span> are the coefficients of the expansion of the initial function <span class="math inline">\(\left|\Psi\left(t^{\prime}\right)\right\rangle\)</span> in the basis of eigenstates.</li>
</ul>
<h4 id="时间演化算符与格林函数">时间演化算符与格林函数</h4>
<p>It is equivalent and more convenient to introduce two Green operators, called also propagators, retarded <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)\)</span> and advanced <span class="math inline">\(\hat{G}^{A}\left(t, t^{\prime}\right)\)</span> : <span class="math display">\[
\begin{array}{c}
\hat{G}^{R}\left(t, t^{\prime}\right)=-\frac{i}{\hbar} \theta\left(t-t^{\prime}\right) \hat{U}\left(t, t^{\prime}\right)=-\frac{i}{\hbar} \theta\left(t-t^{\prime}\right) e^{-i\left(t-t^{\prime}\right) \hat{H} / \hbar} \\
\hat{G}^{A}\left(t, t^{\prime}\right)=\frac{i}{\hbar} \theta\left(t^{\prime}-t\right) \hat{U}\left(t, t^{\prime}\right)=\frac{i}{\hbar} \theta\left(t^{\prime}-t\right) e^{-i\left(t-t^{\prime}\right) \hat{H} / \hbar}
\end{array}
\]</span> so that at <span class="math inline">\(t&gt;t^{\prime}\)</span> one has <span class="math display">\[
|\Psi(t)\rangle=i \hbar \hat{G}^{R}\left(t-t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle 
\]</span> while at <span class="math inline">\(t&lt;t^{\prime}\)</span> it follows <span class="math display">\[
|\Psi(t)\rangle=-i \hbar \hat{G}^{A}\left(t-t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> From the definition one can see that <span class="math inline">\(G^{R}\left(t-t^{\prime}\right)=0\)</span> at $t&lt;t^{}, <span class="math display">\[G^{A}\left(t-t^{\prime}\right)=0$ at $t^{\prime}&lt;t$, and $^{3}$
\]</span> ^{A}(t, t<sup>{})=</sup>{R }(t^{}, t) $$ We can conclude that</p>
<ul>
<li>retarded functions describe propagation into future</li>
<li>while advanced into past.</li>
</ul>
<p>Actually retarded and advanced propagators are related because of the <strong>time-symmetry</strong> of quantum mechanics (we neglect here any dissipation).</p>
<p>The operators <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)\)</span> at <span class="math inline">\(t \geqslant t^{\prime}\)</span> and <span class="math inline">\(\hat{G}^{A}\left(t, t^{\prime}\right)\)</span> at <span class="math inline">\(t \leqslant t^{\prime}\)</span> are the <strong>solutions</strong> of the equation <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}\right] \hat{G}^{R(A)}\left(t, t^{\prime}\right)=\hat{I} \delta\left(t-t^{\prime}\right)
\]</span> #### boundary conditions</p>
<p>with the boundary conditions</p>
<ul>
<li><span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)=0\)</span> at <span class="math inline">\(t&lt;t^{\prime},\)</span></li>
<li>$ ^{A}(t, t^{})=0$ at <span class="math inline">\(t&gt;t^{\prime}\)</span>.</li>
</ul>
<p>Integrating <span class="math inline">\(\left[i \hbar \frac{\partial}{\partial t}-\hat{H}\right] \hat{G}^{R(A)}\left(t, t^{\prime}\right)=\hat{I} \delta\left(t-t^{\prime}\right)\)</span> from <span class="math inline">\(t=t^{\prime}-\eta\)</span> to <span class="math inline">\(t=t^{\prime}+\eta\)</span>, where <span class="math inline">\(\eta\)</span> is an infinitesimally small positive number <span class="math inline">\(\eta=0^{+}\)</span>, one gets <span class="math display">\[
\hat{G}^{R}\left(t+\eta, t^{\prime}\right)=\frac{1}{i \hbar} \hat{I},
\]</span> giving correct boundary condition at <span class="math inline">\(t=t^{\prime}\)</span>. Thus, if we know the retarded Green operator <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)\)</span>, we can find the time-dependent wave function at any initial condition (and make many other useful things, as we will see below).</p>
<h4 id="retarded-fourier-transform">retarded Fourier transform</h4>
<p>For a time-independent Hamiltonian the Green function is a function of the time difference <span class="math inline">\(\tau=t-t^{\prime}\)</span>, and one can consider the Fourier transform <span class="math display">\[
\hat{G}^{R(A)}(E)=\int_{-\infty}^{\infty} \hat{G}^{R(A)}(\tau) e^{i E \tau / \hbar} d \tau
\]</span> This transform, however, can not be performed in all cases, because <span class="math inline">\(G^{R(A)}(\tau)\)</span> includes oscillating terms <span class="math inline">\(e^{-\frac{i}{\hbar} E_{n} \tau}\)</span>. To avoid this problem we define the retarded Fourier transform <span class="math display">\[
\hat{G}^{R}(E)=\lim _{\eta \rightarrow 0^{+}} \int_{-\infty}^{\infty} \hat{G}^{R}(\tau) e^{i(E+i \eta) \tau / \hbar} d \tau
\]</span> and the advanced one <span class="math display">\[
\hat{G}^{A}(E)=\lim _{\eta \rightarrow 0^{+}} \int_{-\infty}^{\infty} \hat{G}^{A}(\tau) e^{i(E-i \eta) \tau / \hbar} d \tau
\]</span> where the limit <span class="math inline">\(\eta \rightarrow 0\)</span> is assumed in the end of calculation. With this addition the integrals are convergent. This definition is equivalent to the definition of a retarded (advanced) function as a function of complex energy variable at the upper (lower) part of the complex plain.</p>
<h4 id="transform-of-green-equation">transform of Green equation</h4>
<p>Applying this transform to <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}\right] \hat{G}^{R(A)}\left(t, t^{\prime}\right)=\hat{I} \delta\left(t-t^{\prime}\right)
\]</span> we get the equation for the retarded Green operator <span class="math inline">\(\hat{G}^{R}(E)\)</span> <span class="math display">\[
[(E+i \eta) \hat{I}-\hat{H}] \hat{G}^{R}(E)=\hat{I}
\]</span> or <span class="math display">\[
\hat{G}^{R}(E)=[(E+i \eta) \hat{I}-\hat{H}]^{-1}
\]</span> The advanced operator <span class="math inline">\(\hat{G}^{A}(E)\)</span> is related to the retarded one through <span class="math display">\[
\hat{G}^{A}(E)=\hat{G}^{R \dagger}(E)
\]</span> It is possible to represent the Green function in the basis of the eigenstates <span class="math inline">\(\left|\Psi_{n}\right\rangle .\)</span> Using the completeness property <span class="math inline">\(\sum_{n}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|=1\)</span>, we obtain <span class="math display">\[
\hat{G}^{R}(E)=\frac{1}{(E+i \eta) \hat{I}-\hat{H}} \sum_{n}\left|\Psi_{n}\right\rangle \langle\Psi_{n} |=\sum_{n} \frac{1}{(E+i \eta) \hat{I}-\hat{H}} | \Psi_{n} \rangle\left\langle\Psi_{n}\right|
\]</span> if we expand now <span class="math inline">\([(E+i \eta) \hat{I}-\hat{H}]^{-1}\)</span> into a power series and use <span class="math inline">\(\hat{H} \Psi_{n}=E_{n} \Psi_{n}\)</span>, we obtain the eigenstate expansion <span class="math display">\[
\hat{G}^{R}(E)=\sum_{n} \frac{\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|}{E-E_{n}+i \eta}
\]</span> Note, that if we apply the ordinary inverse Fourier transform to <span class="math inline">\(\hat{G}^{R}(E)\)</span>, we automatically obtain the retarded function <span class="math display">\[
\hat{G}^{R}(\tau)=\int_{-\infty}^{\infty} \hat{G}^{R}(E) e^{-i E \tau / \hbar} \frac{d E}{2 \pi \hbar}=-\frac{i}{\hbar} \theta(\tau) \sum_{n} e^{-\frac{i}{\hbar} E_{n} \tau}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|
\]</span> Indeed, a simple pole in the complex <span class="math inline">\(E\)</span> plain is at <span class="math inline">\(E=E_{n}-i \eta\)</span>, the residue in this point determines the integral at <span class="math inline">\(\tau&gt;0\)</span> when the integration contour is closed through the lower half-plane, while at <span class="math inline">\(\tau&lt;0\)</span> the integration should be closed through the upper half-plane and the integral is zero.</p>
<h3 id="green-functions-in-the-coordinate-representation">3.1.2 Green Functions in the Coordinate Representation</h3>
<p>The formalism of retarded Green functions is quite general and can be applied to quantum systems in an arbitrary representation. Below in this section we consider the scattering problem in the coordinate representation for the wave function <span class="math inline">\(|\Psi(t)\rangle \equiv \Psi( r , t)\)</span>. The coordinate representation can be obtained from the general equations of the previous section, if one uses the position states <span class="math inline">\(|r\rangle\)</span> (the eigenvectors of the position operator) as a basis. The orthonormality conditions are <span class="math display">\[
\begin{array}{c}
\left\langle r \mid r ^{\prime}\right\rangle=\delta\left( r - r ^{\prime}\right), \\
\int d r | r \rangle\langle r |=1
\end{array}
\]</span> where</p>
<ul>
<li>The scalar product is defined as <span class="math inline">\(\langle\Phi \mid \Psi\rangle=\int \Phi^{*}( r ) \Psi( r ) d r\)</span></li>
<li>the unity operator is <span class="math inline">\(\hat{I}=\delta\left(r-r^{\prime}\right) .\)</span></li>
</ul>
<p>The following transition rules relate the Dirac states and operators with the states and operators in the ordinary coordinate representation (time or energy variable is omitted): 态在坐标表象的转换关系 <span class="math display">\[
\begin{array}{c}
\Psi(r)=\langle r \mid \Psi\rangle, \quad \Psi^{*}(r)=\langle\Psi \mid r\rangle, \\
\delta\left(r-r^{\prime}\right) \hat{H}( r )=\left\langle r |\hat{H}| r ^{\prime}\right\rangle, \\
G^{R}\left( r , r ^{\prime}\right)=\left\langle r \left|\hat{G}^{R}\right| r ^{\prime}\right\rangle, \\
\sum_{n} \Psi_{n}( r ) \Psi_{n}^{*}\left( r ^{\prime}\right)=\delta\left( r - r ^{\prime}\right)
\end{array}
\]</span> Applying these rules to <span class="math display">\[
|\Psi(t)\rangle=i \hbar \hat{G}^{R}\left(t-t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> we obtain <span class="math display">\[
\Psi( r , t)=i \hbar \int d r ^{\prime} G^{R}\left( r , t, r ^{\prime}, t^{\prime}\right) \Psi\left( r ^{\prime}, t^{\prime}\right)
\]</span> where <span class="math inline">\(G^{R}\left( r , t, r ^{\prime}, t^{\prime}\right)\)</span> is the retarded Green function, to be defined from the equation <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}( r )\right] G^{R}\left( r , t, r ^{\prime}, t^{\prime}\right)=\delta\left( r - r ^{\prime}\right) \delta\left(t-t^{\prime}\right)
\]</span> where</p>
<ul>
<li><span class="math inline">\(\hat{H}( r )\)</span> is the single-particle Hamiltonian</li>
</ul>
<p><span class="math display">\[
\hat{H}( r )=-\frac{\hbar^{2}}{2 m} \nabla^{2}+V( r )
\]</span></p>
<ul>
<li>The equation is obtained, if one takes the matrix element <span class="math inline">\(\left\langle r |\ldots| r ^{\prime}\right\rangle\)</span> of the left and right parts of</li>
</ul>
<p><span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}\right] \hat{G}^{R(A)}\left(t, t^{\prime}\right)=\hat{I} \delta\left(t-t^{\prime}\right)
\]</span></p>
<p>The equation for the stationary retarded Green function is <span class="math display">\[
[E+i \eta-\hat{H}( r )] G^{R}\left( r , r ^{\prime}, E\right)=\delta\left( r - r ^{\prime}\right)
\]</span> This Green function corresponds to the Schrödinger equation <span class="math display">\[
\left[-\frac{\hbar^{2}}{2 m} \nabla^{2}+V( r )\right] \Psi( r )=E \Psi( r )
\]</span> #### 例子</p>
<p>Let us consider as an example the one dimensional GF for free electrons. The corresponding equation is <span class="math display">\[
\left[E \pm i \eta+\frac{\hbar^{2}}{2 m} \frac{\partial^{2}}{\partial x^{2}}\right] G^{R(A)}\left(x, x^{\prime}, E\right)=\delta\left(x-x^{\prime}\right)
\]</span> This equation has two exact solutions: <span class="math display">\[
\begin{array}{l}
G_{1}\left(x-x^{\prime}, E\right)=-\frac{i m}{\hbar^{2} k} e^{i k\left|x-x^{\prime}\right|} \\
G_{2}\left(x-x^{\prime}, E\right)=\frac{i m}{\hbar^{2} k} e^{-i k\left|x-x^{\prime}\right|}
\end{array}
\]</span> where</p>
<ul>
<li><span class="math inline">\(\hbar k=\sqrt{2 m(E \pm i \eta)}\)</span>.</li>
</ul>
<p>Note, that <span class="math inline">\(k\)</span> has an imaginary part, positive for retarded and negative for advanced Green functions: <span class="math display">\[
k=\frac{\sqrt{2 m(E \pm i \eta)}}{\hbar}=\frac{\sqrt{2 m E}}{\hbar} \sqrt{1 \pm \frac{i \eta}{E}} \approx \frac{\sqrt{2 m E}}{\hbar}\left(1 \pm \frac{i \eta}{2 E}\right) .
\]</span> From the condition of being finite at infinity, we select <span class="math inline">\(G_{1}\left(x-x^{\prime}, E\right)\)</span> to be the retarded function <span class="math inline">\((\hbar k=\sqrt{2 m(E+i \eta)})\)</span> and <span class="math inline">\(G_{2}\left(x-x^{\prime}, E\right)\)</span> to be the advanced function <span class="math inline">\((\hbar k=\sqrt{2 m(E-i \eta)})\)</span>. At the same time, we can consider <span class="math inline">\(x^{\prime}\)</span> as a position of the scatterer. From this point of view, <span class="math inline">\(G_{1}\left(x-x^{\prime}, E\right)\)</span> corresponds to the outgoing wave, while <span class="math inline">\(G_{2}\left(x-x^{\prime}, E\right)\)</span> for incoming.</p>
<h4 id="ldos">LDOS</h4>
<blockquote>
<p>坐标表象的retarded function可以和局域态密度(local density of states)联系在一起</p>
</blockquote>
<p>The coordinate retarded function has many useful properties. In particular, it is related to the <strong>local density of states</strong> <span class="math inline">\(\rho( r , E)\)</span>, which can be determined as <span class="math display">\[
\rho( r , E)=\sum_{n}\left|\Psi_{n}( r )\right|^{2} \delta\left(E-E_{n}\right)
\]</span> On the other hand, from <span class="math display">\[
\hat{G}^{R}(E)=\sum_{n} \frac{\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|}{E-E_{n}+i \eta}
\]</span> we get the eigenstate expansion <span class="math display">\[
G^{R}\left(r, r^{\prime}, E\right)=\sum_{n} \frac{\left\langle r \mid \Psi_{n}\right\rangle\left\langle\Psi_{n} \mid r^{\prime}\right\rangle}{E-E_{n}+i \eta}=\sum_{n} \frac{\Psi_{n}(r) \Psi_{n}^{*}\left(r^{\prime}\right)}{E-E_{n}+i \eta},
\]</span> or for the coinciding coordinates <span class="math inline">\(r=r^{\prime}\)</span> : <span class="math display">\[
G^{R}( r , r , E)=\sum_{n} \frac{\left\langle r \mid \Psi_{n}\right\rangle\left\langle\Psi_{n} \mid r \right\rangle}{E-E_{n}+i \eta}=\sum_{n} \frac{\left|\Psi_{n}( r )\right|^{2}}{E-E_{n}+i \eta}
\]</span> Comparing these expressions and using the relation <span class="math display">\[
\frac{1}{x \pm i \eta}=P\left(\frac{1}{x}\right) \mp i \pi \delta(x)
\]</span> where <span class="math inline">\(P\)</span> stands for the principal value in the case of integration, one obtains <span class="math display">\[
\rho( r , E)=-\frac{1}{\pi} \operatorname{Im}\left\{G^{R}( r , r , E)\right\}
\]</span> It is also possible to show that the real and imaginary parts of <span class="math inline">\(G^{R(A)}(E)\)</span> are related through a Hilbert transformation <span class="math display">\[
\operatorname{Re}\left\{G^{R(A)}(E)\right\}=\mp P \int_{-\infty}^{\infty} \frac{\operatorname{Im}\left\{G^{R(A)}\left(E^{\prime}\right)\right\}}{E-E^{\prime}} \frac{d E^{\prime}}{\pi}
\]</span> and the following representation holds: <span class="math display">\[
G^{R(A)}( r , r , E)=\int_{-\infty}^{\infty} \frac{\rho\left( r , E^{\prime}\right) d E^{\prime}}{E-E^{\prime} \pm i \eta}
\]</span> ### 3.1.3 Lippmann-Schwinger Equation</p>
<blockquote>
<p>用格林函数的方法重新描述散射理论</p>
</blockquote>
<p>Using Green functions, we can reformulate the scattering theory. Assume that our system can be divided into an unperturbed part with the Hamiltonian <span class="math inline">\(\hat{H}_{0}\)</span> and the perturbation <span class="math inline">\(\hat{V}\)</span>, both time-independent: <span class="math display">\[
\hat{H}=\hat{H}_{0}+\hat{V}
\]</span> This decomposition can be naturally done for scattering of particles in free space, where <span class="math inline">\(\hat{H}_{0}\)</span> includes only (the operators of) kinetic energies and <span class="math inline">\(\hat{V}\)</span> is the scattering potential. For quantum junctions <span class="math inline">\(\hat{H}_{0}\)</span> can be taken for infinite electrodes and <span class="math inline">\(\hat{V}\)</span> should then describe all possible scattering events between electrodes and channels. Usually it is difficult to formulate such a problem explicitly, but the analysis is important for qualitative understanding.</p>
<h4 id="lippmann-schwinger-方程">Lippmann-Schwinger 方程</h4>
<p>Writing the time-dependent equation for the full Hamiltonian <span class="math inline">\(\hat{H}=\hat{H}_{0}+\hat{V}\)</span> and for <span class="math inline">\(\hat{H}_{0}\)</span> only: <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}_{0}-\hat{V}\right] \hat{G}^{R}\left(t, t_{0}\right)=\hat{I} \delta\left(t-t_{0}\right)
\]</span></p>
<p><span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}_{0}\right] \hat{G}_{0}^{R}\left(t, t_{0}\right)=\hat{I} \delta\left(t-t_{0}\right)
\]</span> ##### 1 for Green</p>
<p>combining these equations together and integrating over the time we get the Lippmann-Schwinger equation for the Green functions in two different forms: <span class="math display">\[
\hat{G}^{R}\left(t-t_{0}\right)=\hat{G}_{0}^{R}\left(t-t_{0}\right)+\int_{t_{0}}^{t} \hat{G}_{0}^{R}\left(t-t^{\prime}\right) \hat{V} \hat{G}^{R}\left(t^{\prime}-t_{0}\right) d t^{\prime},
\]</span> or <span class="math display">\[
\hat{G}^{R}\left(t-t_{0}\right)=\hat{G}_{0}^{R}\left(t-t_{0}\right)+\int_{t_{0}}^{t} \hat{G}^{R}\left(t-t^{\prime}\right) \hat{V} \hat{G}_{0}^{R}\left(t^{\prime}-t_{0}\right) d t^{\prime} .
\]</span> Before going further we define the incoming state as a result of the time evolution of the initial state <span class="math inline">\(\Psi_{0}\left(t_{0}\right)\)</span> from the infinite past under the action of unperturbed Hamiltonian, in accordance with (3.13) it is determined by the Green function <span class="math inline">\(\hat{G}_{0}\left(t-t_{0}\right)\)</span> while the full scattering state is obtained by the full Green function <span class="math inline">\(\hat{G}\left(t-t_{0}\right)\)</span> : <span class="math display">\[
\begin{array}{c}
\left|\Psi^{i n}(t)\right\rangle=i \hbar \lim _{t_{0} \rightarrow-\infty} \hat{G}_{0}^{R}\left(t-t_{0}\right)\left|\Psi_{0}\left(t_{0}\right)\right\rangle, \\
|\Psi(t)\rangle=i \hbar \lim _{t_{0} \rightarrow-\infty} \hat{G}^{R}\left(t-t_{0}\right)\left|\Psi_{0}\left(t_{0}\right)\right\rangle .
\end{array}
\]</span> The sense of this procedure is to "clean" the time-dependent state from the transient contributions and stay only with the state supported by the boundary conditions.</p>
<h5 id="for-wave-function">2 for wave function</h5>
<p>Now we substitute (3.53) into (3.55) and replace the upper limit of integration over <span class="math inline">\(t\)</span> by <span class="math inline">\(\infty\)</span>, we can do that because <span class="math inline">\(\hat{G}^{R}\left(t-t^{\prime}&lt;0\right)=0 .\)</span> We obtain the LippmannSchwinger equation for the wave function: <span class="math display">\[
|\Psi(t)\rangle=\left|\Psi^{i n}(t)\right\rangle+\int_{-\infty}^{\infty} d t^{\prime} \hat{G}^{R}\left(t-t^{\prime}\right) \hat{V}\left|\Psi^{i n}\left(t^{\prime}\right)\right\rangle
\]</span> or (if we use <span class="math inline">\((3.52)\)</span> instead <span class="math inline">\()\)</span> <span class="math display">\[
|\Psi(t)\rangle=\left|\Psi^{i n}(t)\right\rangle+\int_{-\infty}^{\infty} d t^{\prime} \hat{G}_{0}^{R}\left(t-t^{\prime}\right) \hat{V}\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> Making the Fourier transform (3.19) we get the time-independent LippmannSchwinger equations, e.g. with the retarded functions <span class="math display">\[
\begin{aligned}
\hat{G}^{R}(E) &amp;=\hat{G}_{0}^{R}(E)+\hat{G}^{R}(E) \hat{V} \hat{G}_{0}^{R}(E) \\
\left|\Psi_{E}\right\rangle &amp;=\left|\Psi_{E}^{i n}\right\rangle+\hat{G}^{R}(E) \hat{V}\left|\Psi_{E}^{i n}\right\rangle
\end{aligned}
\]</span> or <span class="math display">\[
\begin{aligned}
\hat{G}^{R}(E) &amp;=\hat{G}_{0}^{R}(E)+\hat{G}_{0}^{R}(E) \hat{V} \hat{G}^{R}(E) \\
\left|\Psi_{E}\right\rangle &amp;=\left|\Psi_{E}^{i n}\right\rangle+\hat{G}_{0}^{R}(E) \hat{V}\left|\Psi_{E}\right\rangle
\end{aligned}
\]</span> In the coordinate representation <span class="math display">\[
\Psi_{E}( r )=\Psi_{E}^{i n}( r )+\int d r ^{\prime} G^{R}\left( r , r ^{\prime}, E\right) V\left( r ^{\prime}\right) \Psi_{E}^{i n}\left( r ^{\prime}\right)
\]</span> or <span class="math display">\[
\Psi_{E}( r )=\Psi_{E}^{i n}( r )+\int d r^{\prime} G_{0}^{R}\left( r , r ^{\prime}, E\right) V\left( r ^{\prime}\right) \Psi_{E}\left( r ^{\prime}\right)
\]</span> Both equations describe the wave function as a superposition of incoming wave and all outgoing waves produced by this incoming wave. As a direct computational tool the Lippmann-Schwinger equations are useful in free space with localized scattering region or in rather simple geometries, when the unperturbed Green functions can be easily defined analytically.</p>
<h4 id="例子">例子</h4>
<p>Consider as an example scattering at the <span class="math inline">\(\delta\)</span> -potential <span class="math inline">\(V(x)=\alpha \delta(x)\)</span>. The retarded Green function for free <span class="math inline">\(1 D\)</span> electrons is given by <span class="math inline">\((3.39)\)</span> : <span class="math display">\[
G_{0}^{R}\left(x-x^{\prime}, E\right)=-\frac{i m}{\hbar^{2} k} e^{i k\left|x-x^{\prime}\right|}
\]</span> Using the equation (3.63) we get <span class="math inline">\(\left(\Psi^{i n}(x)=e^{i k x}\right)\)</span> : <span class="math display">\[
\Psi(x)=e^{i k x}-\frac{i m \alpha}{\hbar^{2} k} \int d x^{\prime} e^{i k\left|x-x^{\prime}\right|} \delta\left(x^{\prime}\right) \Psi\left(x^{\prime}\right)=e^{i k x}-\frac{i m \alpha}{\hbar^{2} k} e^{i k|x|} \Psi(0)
\]</span> Boundary conditions at infinity suggest that the solution has the form <span class="math display">\[
\Psi(x)=A\left\{\begin{array}{ll}
e^{i k x}+r e^{-i k x}, &amp; x&lt;0, \\
t e^{i k x}, &amp; x&gt;0
\end{array}\right.
\]</span> Substituting it into (3.65) for <span class="math inline">\(x=+0\)</span> and <span class="math inline">\(x=-0\)</span> we obtain the equations for the reflection amplitude <span class="math inline">\(r\)</span> and the transmission amplitude <span class="math inline">\(t\)</span> : <span class="math display">\[
1+r=1-\frac{i m \alpha}{\hbar^{2} k}(1+r), \quad t=1-\frac{i m \alpha}{\hbar^{2} k} t
\]</span> with the solution <span class="math display">\[
r=\frac{1}{i \frac{\hbar^{2} k}{m \alpha}-1}, \quad t=\frac{i \frac{\hbar^{2} k}{m \alpha}}{i \frac{\hbar^{2} k}{m \alpha}-1}
\]</span> It is exactly the same result which we obtained solving the Schrödinger equation <span class="math inline">\((2.29)-(2.36)\)</span></p>
<p>For more details about the Lippmann-Schwinger equations we recommend the book of M. Di Ventra [1], Sect. <span class="math inline">\(3.4\)</span></p>
<h3 id="fisher-lee-relation-between-s-and-gr">3.1.4 Fisher-Lee Relation Between <span class="math inline">\(S\)</span> and <span class="math inline">\(G^{R}\)</span></h3>
<blockquote>

</blockquote>
<p>Finally, let us establish the relation between the Green function <span class="math inline">\(G^{R}\left(r_{1}, r_{2}, E\right)\)</span> and the scattering matrix <span class="math inline">\(S\)</span>. Although we will not use it explicitly below (instead we derive more practical matrix formulas), it is important to demonstrate equivalence between the Landauer's scattering approach based on the wave function picture and the Green function formalism.</p>
<h4 id="例子-1">例子</h4>
<p>Let us start from a simple <span class="math inline">\(1 D\)</span> case. The multi-channel scattering states <span class="math inline">\((2.126)\)</span>, (2.127) become <span class="math display">\[
\begin{array}{l}
\Psi_{L E}(z)=\left\{\begin{array}{l}
\frac{1}{\sqrt{2 \pi \hbar v_{L}}} e^{i k z}+\frac{r(E)}{\sqrt{2 \pi \hbar v_{L}}} e^{-i k z}, z&lt;z_{L} \\
\frac{t(E)}{\sqrt{2 \pi \hbar v_{R}}} e^{i k^{\prime} z}, z&gt;z_{R}
\end{array}\right. \\
\Psi_{R E}(z)=\left\{\begin{array}{l}
\frac{1}{\sqrt{2 \pi \hbar v_{R}}} e^{-i k^{\prime} z}+\frac{r^{\prime}(E)}{\sqrt{2 \pi \hbar v_{R}}} e^{i k^{\prime} z}, z&gt;z_{R} \\
\frac{t^{\prime}(E)}{\sqrt{2 \pi \hbar v_{L}}} e^{-i k z}, z&lt;z_{L}
\end{array}\right.
\end{array}
\]</span> where we keep different left and right velocities <span class="math inline">\(v_{L}=\hbar k / m, v_{R}=\hbar k^{\prime} / m, k(E)\)</span> and <span class="math inline">\(k^{\prime}(E)\)</span> can be different. These states form a full set of eigenstates and we can use the representation (3.43): <span class="math display">\[
G^{R}\left(z, z^{\prime}, E\right)=\int_{0}^{\infty} \frac{\Psi_{L E_{k}}(z) \Psi_{L E_{k}}^{*}\left(z^{\prime}\right)}{E-E_{k}+i \eta} d E_{k}+\int_{0}^{\infty} \frac{\Psi_{R E_{k}}(z) \Psi_{R E_{k}}^{*}\left(z^{\prime}\right)}{E-E_{k}+i \eta} d E_{k} .
\]</span> Let us calculate these integrals at <span class="math inline">\(z \rightarrow \infty, z^{\prime} \rightarrow-\infty\)</span> taking into account that <span class="math inline">\(t(E) r^{*}(E)+r^{\prime}(E) t^{\prime *}(E)=0\)</span> .</p>
<p>Finally we get the relation between the retarded Green function and the transmission amplitude: <span class="math display">\[
G^{R}\left(z, z^{\prime}, E\right)=\frac{-i t(E)}{\hbar \sqrt{v_{L} v_{R}}} e^{i k^{\prime} z-i k z^{\prime}}
\]</span> or <span class="math display">\[
t(E)=i \hbar \sqrt{v_{L} v_{R}} G^{R}\left(z, z^{\prime}, E\right) e^{-i k^{\prime} z+i k z^{\prime}}
\]</span></p>
<h4 id="拓展">拓展</h4>
<p>Now we can extend this approach to multi-channel and multi-terminal case. In the general case of multi-terminal scattering the wave functions in the leads, far from the scattering region, are determined by the asymptotic expressions <span class="math display">\[
\Psi_{s n E}( r )=\left\{\begin{array}{l}
\frac{1}{\sqrt{2 \pi \hbar v_{s n}}} \phi_{s n}(x, y) e^{i k_{n} z}+\sum_{n^{\prime}} \frac{r_{n^{\prime} n}(E)}{\sqrt{2 \pi \hbar v_{s n^{\prime}}}} \phi_{s n^{\prime}}(x, y) e^{-i k_{n} z}, n, z \in s, \\
\sum_{m} \frac{t_{m n}(E)}{\sqrt{2 \pi \hbar v_{p m}}} \phi_{p m}(x, y) e^{i k_{m}^{\prime} z}, p \neq s, m, z \in p
\end{array}\right.
\]</span> The Green functions for scattering from the electrode <span class="math inline">\(s\)</span> into the electrode <span class="math inline">\(p\)</span> at energy <span class="math inline">\(E\)</span> are: <span class="math display">\[
\begin{aligned}
G^{R}\left( r _{p}, r _{s}, E\right) &amp;=\sum_{m n} \frac{-i t_{m n}}{\hbar \sqrt{v_{m} v_{n}}} \phi_{m}\left( r _{p}\right) \phi_{n}^{*}\left( r _{s}\right) e^{-i k_{m} z_{p}-i k_{n} z_{s}}, m \in p, n \in s, \quad(3.74\\
G^{R}\left( r _{s}^{\prime}, r _{s}, E\right) &amp;=\sum_{n^{\prime} n}\left[-\frac{i \delta_{n^{\prime} n}}{\hbar v_{n}}-\frac{i r_{n^{\prime} n}}{\hbar \sqrt{v_{n}^{\prime} v_{n}}}\right] \phi_{n^{\prime}}\left( r _{s}^{\prime}\right) \phi_{n}^{*}\left( r _{s}\right) e^{-i k_{n}^{\prime} z_{p}^{\prime}-i k_{n} z_{s}}, n, n^{\prime} \in s
\end{aligned}
\]</span> Making the inversion of these expressions and assuming the points with coordinates <span class="math inline">\(z_{s}=z_{p}=0\)</span> in the leads (we are free to choose the beginning of coordinate axes), we get the Fisher-Lee relations <span class="math inline">\([2]\)</span> in the form: <span class="math display">\[
\begin{array}{l}
t_{p m, s n}=i \hbar \sqrt{v_{n} v_{m}} \int d r _{s} \int d r _{p} \phi_{m}^{*}\left( r _{p}\right) G^{R}\left( r _{p}, r _{s}\right) \phi_{n}\left( r _{s}\right), p \neq s \\
r_{s n^{\prime}, s n}=-\delta_{n^{\prime} n}+i \hbar \sqrt{v_{n} v_{n^{\prime}}} \int d r _{s} \int d r _{s}^{\prime} \phi_{n^{\prime}}^{*}\left( r _{s}^{\prime}\right) G^{R}\left( r _{s}^{\prime}, r _{s}\right) \phi_{n}\left( r _{s}\right)
\end{array}
\]</span> or, combining both together, <span class="math display">\[
S_{p m, s n}=-\delta_{p s} \delta_{m n}+i \hbar \sqrt{v_{n} v_{m}} \int d r _{s} \int d r _{p} \phi_{m}^{*}\left( r _{p}\right) G^{R}\left( r _{p}, r _{s}\right) \phi_{n}\left( r _{s}\right)
\]</span> Using these expressions and</p>
<ul>
<li><span class="math inline">\(T_{s p}=\sum_{n m}\left|S_{s n, p m}\right|^{2}=\sum_{n m}\left|t_{s n, p m}\right|^{2}\)</span></li>
<li><span class="math inline">\(R_{s s}=\sum_{n n^{\prime}}\left|S_{s n, s n^{\prime}}\right|^{2}\)</span></li>
</ul>
<p>we can get the transmission function <span class="math inline">\(T_{s p}(E)\)</span> from the lead <span class="math inline">\(p\)</span> into <span class="math inline">\(s\)</span> : <span class="math display">\[
\begin{aligned}
T_{s p}(E)=\sum_{n m}\left|t_{s n, p m}\right|^{2}=&amp; \int d r_{p 2} \int d r_{p 1} \int d r_{s 1} \int d r_{s 2} \\
&amp; \Gamma_{p}\left( r _{p 2}, r _{p 1}\right) G^{R}\left( r _{p 1}, r _{s 1}\right) \Gamma_{s}\left( r _{s 1}, r _{s 2}\right) G^{A}\left( r _{s 2}, r _{p 2}\right)
\end{aligned}
\]</span> where we introduced the functions <span class="math display">\[
\Gamma_{s}\left(r_{s 1}, r_{s 2}\right)=\hbar \sum_{n} v_{n} \phi_{n}\left(r_{s 1}\right) \phi_{n}^{*}\left(r_{s 2}\right)
\]</span> which describe the properties of the <span class="math inline">\(s\)</span> -th electrode and are independent from other electrodes.</p>
<h2 id="matrix-green-functions">3.2 Matrix Green Functions</h2>
<p>3.2.1哈密顿量怎么写成矩阵</p>
<p>3.2.2 格林函数矩阵通过求逆获得</p>
<p>3.2.3</p>
<h3 id="matrix-tight-binding-lattice-hamiltonian">3.2.1 Matrix (Tight-Binding, Lattice) Hamiltonian</h3>
<p>Before we considered only continuous quantum systems described by wave functions in real space. However, the nanoscale systems are typically discrete-level systems due to spatial quantization in quantum dots and molecules or importance of atomistic structure. From here on our focus will be on the systems described by the matrix Hamiltonians <span class="math display">\[
H =\left(\begin{array}{cccc}
H_{11} &amp; H_{12} &amp; \cdots &amp; H_{1 N} \\
H_{21} &amp; H_{22} &amp; \cdots &amp; H_{2 N} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
H_{N 1} &amp; H_{N 2} &amp; \cdots &amp; H_{N N}
\end{array}\right)
\]</span> Actually, any Hamiltonian of this type has some basis states <span class="math inline">\(|i\rangle, i=1, \ldots, N\)</span> in its origin. The physical nature of these states is not important from mathematical point of view, but we note that the matrix structure appears as a result of matrix element calculation of some Hamiltonian <span class="math inline">\(\langle i|\hat{H}| j\rangle\)</span>, and the vector wave function <span class="math display">\[
\Psi =\left(\begin{array}{c}
c_{1} \\
c_{2} \\
\vdots \\
c_{N}
\end{array}\right)
\]</span> represents the coefficients of the expansion <span class="math display">\[
|\Psi\rangle=\sum_{i} c_{i}|i\rangle
\]</span> The Hamilton operator can be written also using the basis states and matrix elements as <span class="math display">\[
\hat{H}=\sum_{i j}|i\rangle H_{i j}\langle j|
\]</span> The eigenstates <span class="math inline">\(\Psi_{n}\)</span> are to be found from the matrix Schrödinger equation <span class="math display">\[
H \Psi_{n}=E_{n} \Psi_{n}
\]</span> Let us consider some typical systems, for which the matrix method is appropriate starting point.</p>
<h4 id="例子quantum-dot">例子quantum dot</h4>
<p>The simplest example is a single quantum dot, in the basis formed by the eigenstates, the corresponding Hamiltonian is diagonal: <span class="math display">\[
H=\left(\begin{array}{ccccc}
\varepsilon_{1} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \varepsilon_{2} &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; 0 &amp; \varepsilon_{N-1} &amp; 0 \\
0 &amp; \cdots &amp; 0 &amp; 0 &amp; \varepsilon_{N}
\end{array}\right)
\]</span> We can write it also, using Dirac notations and second quantization, as <span class="math display">\[
\hat{H}=\sum_{i}|i\rangle \varepsilon_{i}\langle i|=\sum_{i} \varepsilon_{i} d_{i}^{\dagger} d_{i}
\]</span> #### 例子nearest neighbor</p>
<p>The next typical example is a linear chain of single-state sites with only nearest neighbor couplings (Fig. 3.1) <span class="math display">\[
H=\left(\begin{array}{ccccc}
\varepsilon_{1} &amp; t &amp; 0 &amp; \cdots &amp; 0 \\
t &amp; \varepsilon_{2} &amp; t &amp; \cdots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; t &amp; \varepsilon_{N-1} &amp; t \\
0 &amp; \cdots &amp; 0 &amp; t &amp; \varepsilon_{N}
\end{array}\right)
\]</span> Two important ways to obtain discrete Hamiltonians are the tight-binding approximation and discretization of the Scrödinger equation (or the equivalent equations for Green functions) using finite differences and discretized space grid (lattice) instead of derivatives in continuous space.</p>
<h4 id="tight-binding-model">Tight-Binding Model</h4>
<p>The main idea of the method is to represent the wave function of a particle as a linear combination of some known localized states <span class="math inline">\(\psi_{\alpha}( r , \sigma)\)</span>, where <span class="math inline">\(\alpha\)</span> denote the set of quantum numbers, and <span class="math inline">\(\sigma\)</span> is the spin index (for example, atomic orbitals, in this particular case the method is called LCAO-linear combination of atomic orbitals) <span class="math display">\[
\psi(\xi)=\sum_{\alpha} c_{\alpha} \psi_{\alpha}(\xi)
\]</span> here and below we use <span class="math inline">\(\xi \equiv( r , \sigma)\)</span> to denote both spatial coordinates and spin.</p>
<p>Using the Dirac notations <span class="math inline">\(|\alpha\rangle \equiv \psi_{\alpha}(\xi)\)</span> and assuming that <span class="math inline">\(\psi_{\alpha}(\xi)\)</span> are orthonormal functions <span class="math inline">\(\langle\alpha \mid \beta\rangle=\delta_{\alpha \beta}\)</span> we can write the single-particle tight-binding Hamiltonian in the Hilbert space formed by <span class="math inline">\(\psi_{\alpha}(\xi)\)</span> <span class="math display">\[
\hat{H}=\sum_{\alpha}\left(\varepsilon_{\alpha}+e \varphi_{\alpha}\right)|\alpha\rangle \langle\alpha |+\sum_{\alpha \beta} t_{\alpha \beta} | \alpha \rangle\langle\beta|
\]</span> where</p>
<ul>
<li>the first term in this Hamiltonian describes the states with energies <span class="math inline">\(\varepsilon_{\alpha}, \varphi_{\alpha}\)</span> is the electrical potential,</li>
<li>the second term should be included if the states <span class="math inline">\(|\alpha\rangle\)</span> are not eigenstates of the Hamiltonian.</li>
<li>In the TB model <span class="math inline">\(t_{\alpha \beta}\)</span> is the hopping matrix element between states <span class="math inline">\(|\alpha\rangle\)</span> and <span class="math inline">\(|\beta\rangle\)</span>, which is nonzero, as a rule, for nearest neighbor sites.</li>
</ul>
<p>The two-particle interaction is described by the Hamiltonian <span class="math display">\[
\hat{H}=\sum_{\alpha \beta, \delta \gamma} V_{\alpha \beta, \delta \gamma}|\alpha\rangle|\beta\rangle\langle\delta|\langle\gamma|
\]</span> in the two-particle Hilbert space, and so on. The energies and hopping matrix elements in this Hamiltonian can be calculated as matrix elements of the single-particle real-space Hamiltonian <span class="math inline">\(\hat{h}(\xi)\)</span> : <span class="math display">\[
\varepsilon_{\alpha \beta}=\varepsilon_{\alpha} \delta_{\alpha \beta}+t_{\alpha \beta}\left(1-\delta_{\alpha \beta}\right)=\int \psi_{\alpha}^{*}(\xi) \hat{h}(\xi) \psi_{\beta}(\xi) d \xi
\]</span> We combined in this expression the energies and hopping terms into one energy matrix <span class="math inline">\(\varepsilon_{\alpha \beta}\)</span> with the matrix elements of the single-particle Hamiltonian <span class="math display">\[
H_{\alpha \beta} \equiv \varepsilon_{\alpha \beta}=\left\{\begin{array}{ll}
\varepsilon_{\alpha}+e \varphi_{\alpha}, \alpha &amp; =\beta \\
t_{\alpha \beta}, &amp; \alpha \neq \beta
\end{array}\right.
\]</span> This approach was developed originally as an approximate method, if the wave functions of isolated atoms are taken as a basis wave functions <span class="math inline">\(\psi_{\alpha}(\xi)\)</span>, but also can be formulated exactly with the help of Wannier functions. Only in the last case the expansion (3.89) and the Hamiltonian (3.90) are exact, but some extension to the arbitrary basis functions is possible. The method is useful to calculate the conductance of complex quantum systems in combination with <span class="math inline">\(a b\)</span> initio methods. It is particular important to describe small molecules, when the atomic orbitals form the basis. Finally, in the second quantized form the tight-binding Hamiltonian is <span class="math display">\[
\hat{H}=\sum_{\alpha}\left(\varepsilon_{\alpha}+e \varphi_{\alpha}\right) c_{\alpha}^{\dagger} c_{\alpha}+\sum_{\alpha \neq \beta} t_{\alpha \beta} c_{\alpha}^{\dagger} c_{\beta}
\]</span> The formalism of second quantization we will use in the second part devoted to advanced methods.</p>
<p>In the mathematical sense, the TB model represents also a discrete (grid) version of the continuous Schrödinger equation, thus it is routinely used in numerical calculations.</p>
<h5 id="例子-2">例子</h5>
<p>Consider, as an example, the one-dimensional Schrödinger equation with the Hamiltonian <span class="math display">\[
\hat{H}(x)=-\frac{\hbar^{2}}{2 m} \frac{d^{2}}{d x^{2}}+V(x)
\]</span> For numerical calculation we introduce the discrete lattice of sites with coordinates <span class="math inline">\(x_{i}=a i, i \in Z, a\)</span> is the lattice constant. The continuous functions are replaced by their values in points <span class="math inline">\(x_{i}\)</span> : <span class="math display">\[
\Psi(x) \Rightarrow \Psi_{i}, \quad V(x) \Rightarrow V_{i}
\]</span> the derivatives are approximated by the finite differences <span class="math inline">\(^{4}\)</span> <span class="math display">\[
\frac{d}{d x} \Psi(x) \Rightarrow\left(\frac{d}{d x} \Psi(x)\right)_{i}=\frac{\Psi_{i+1}-\Psi_{i}}{a}
\]</span> <span class="math display">\[
\left(\frac{d^{2}}{d x^{2}} \Psi(x)\right)_{i}=\frac{1}{a}\left[\left(\frac{d}{d x} \Psi(x)\right)_{i}-\left(\frac{d}{d x} \Psi(x)\right)_{i-1}\right]=\frac{\Psi_{i+1}-2 \Psi_{i}+\Psi_{i-1}}{a^{2}} .
\]</span> Introducing <span class="math inline">\(t=\frac{\hbar^{2}}{2 m a}\)</span>, we get the TB Hamiltonian <span class="math display">\[
\hat{H}=\sum_{i}\left[\left(2 t+V_{i}\right)|i\rangle\langle i|-t| i\rangle\langle i-1|-t| i\rangle\langle i+1|\right] .
\]</span> This Hamiltonian in the matrix form is <span class="math display">\[
H=\left(\begin{array}{ccccc}
\ddots &amp; -t &amp; 0 &amp; 0 &amp; \ddots \\
-t &amp; 2 t+V_{i-1} &amp; -t &amp; 0 &amp; 0 \\
0 &amp; -t &amp; 2 t+V_{i} &amp; -t &amp; 0 \\
0 &amp; 0 &amp; -t &amp; 2 t+V_{i+1} &amp; -t \\
\ddots &amp; 0 &amp; 0 &amp; -t &amp; \ddots
\end{array}\right)
\]</span></p>
<h3 id="retarded-single-particle-matrix-green-function">3.2.2 Retarded Single-Particle Matrix Green Function</h3>
<ol type="1">
<li>The solution of single-particle quantum problems, formulated with the help of a matrix Hamiltonian, is possible along the usual line of finding the wave-functions on a lattice, solving the Schrödinger equation</li>
</ol>
<p><span class="math display">\[
H \Psi_{n}=E_{n} \Psi_{n}
\]</span></p>
<ol start="2" type="1">
<li>The other method, namely matrix Green functions, considered in this section, was found to be <strong>more convenient</strong> for transport calculations, especially when interactions are included.</li>
</ol>
<p>The retarded single-particle matrix Green function <span class="math display">\[
G^{R}(E)=\left(\begin{array}{cccc}
G_{11} &amp; G_{12} &amp; \cdots &amp; G_{1 N} \\
G_{21} &amp; G_{22} &amp; \cdots &amp; G_{2 N} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
G_{N 1} &amp; G_{N 2} &amp; \cdots &amp; G_{N N}
\end{array}\right)
\]</span> is determined by the equation <span class="math display">\[
[(E+i \eta) I-H] G^{R}=I,
\]</span> where</p>
<ul>
<li><span class="math inline">\(\eta\)</span> is an infinitesimally small positive number <span class="math inline">\(\eta=0^{+}\)</span>.</li>
</ul>
<p>For an isolated non-interacting system the Green function is simply obtained after the <strong>matrix inversion</strong> <span class="math display">\[
G^{R}(E)=[(E+i \eta) I-H]^{-1}
\]</span> All general properties of GFs, discussed above, are applicable also for matrix GFs. For example, the local density of states in state <span class="math inline">\(\alpha\)</span> at energy <span class="math inline">\(E\)</span> is determined by <span class="math display">\[
\rho_{\alpha}(E)=-\frac{1}{\pi} \operatorname{Im} G_{\alpha \alpha}^{R}(E)
\]</span></p>
<h5 id="例子-quantum-dot">例子 quantum dot</h5>
<p>For simple quantum dot Hamiltonian <span class="math display">\[
\hat{H}=\sum_{i}|i\rangle \varepsilon_{i}\langle i|=\sum_{i} \varepsilon_{i} d_{i}^{\dagger} d_{i}=\left(\begin{array}{ccccc}
\varepsilon_{1} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \varepsilon_{2} &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; 0 &amp; \varepsilon_{N-1} &amp; 0 \\
0 &amp; \cdots &amp; 0 &amp; 0 &amp; \varepsilon_{N}
\end{array}\right)
\]</span> the matrix Green function is easily found to be <span class="math display">\[
G_{\alpha \beta}^{R}(E)=\frac{\delta_{\alpha \beta}}{E-\varepsilon_{\alpha}+i \eta} .
\]</span> ##### 例子 two-level system</p>
<p>Let us consider the example of a two-level system with the Hamiltonian <span class="math display">\[
H=\left(\begin{array}{cc}
\varepsilon_{1} &amp; t \\
t &amp; \varepsilon_{2}
\end{array}\right) .
\]</span> The retarded GF is <span class="math display">\[
G^{R}(E)=\frac{1}{\left(E+i \eta-\varepsilon_{1}\right)\left(E+i \eta-\varepsilon_{2}\right)-t^{2}}\left(\begin{array}{cc}
E+i \eta-\varepsilon_{2} &amp; t \\
t &amp; E+i \eta-\varepsilon_{1}
\end{array}\right) .
\]</span> The tight-binding and lattice Hamiltonians are applied as well to consider the semi-infinite leads. Although the matrices are formally infinitely-dimensional in this case, we shall show below, that the problem is reduced to the finite-dimensional problem for the quantum system of interest, and the semi-infinite leads can be integrated out.</p>
<p>For more details about the lattice Hamiltonians and Green functions we recommend the book of D.K. Ferry and S.M. Goodnick [3], Sect. 3.8.</p>
<h3 id="electrode-self-energies">3.2.3 Electrode Self-Energies</h3>
<p>Now let us consider the case, when the system of interest is coupled to the electrodes and forms the nanojunction (Fig. 3.2).</p>
<p><img src="https://jptanjing.oss-cn-beijing.aliyuncs.com/img/image-20210507200736403.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p>
<blockquote>
<p>Fig. 3.2 A quantum system coupled to the left and right equilibrium electrodes</p>
</blockquote>
<p>We assume here that the electrodes are also described by the tight-binding model and by the matrix GFs. Actually, the semi-infinite contacts should be described by the matrix of infinite dimension. We shall consider the semi-infinite contacts later. As usually, we assume, that the electrodes are equilibrium (with possibly different electrochemical potentials), and the central region includes leads and scatterer.</p>
<h4 id="系统的哈密顿矩阵">系统的哈密顿矩阵</h4>
<p>Let us present the full Hamiltonian of the considered system in the following block form <span class="math display">\[
H=\left(\begin{array}{ccc}
H_{L} &amp; V_{L C} &amp; 0 \\
V_{C L} &amp; H_{C} &amp; V_{C R} \\
0 &amp; V_{R C} &amp; H_{R}
\end{array}\right)
\]</span> where</p>
<ul>
<li><span class="math inline">\(H_{L}, H_{C}\)</span>, and <span class="math inline">\(H_{R}\)</span> are the matrix Hamiltonians of the left electrode, the central region, and the right electrode respectively.</li>
<li>And the off-diagonal terms describe the coupling to the electrodes.</li>
<li>Here we neglect the direct coupling between the electrodes.</li>
</ul>
<p>The Hamiltonian should be Hermitian, such that <span class="math display">\[
V _{C L}= V _{L C}^{\dagger}, \quad V _{C R}= V _{R C}^{\dagger}
\]</span> #### 矩阵方程</p>
<p>The equation <span class="math inline">\([(E+i \eta) I-H] G^{R}=I\)</span> can be written as <span class="math display">\[
\left(\begin{array}{ccc}
E-H_{L} &amp; -V_{L C} &amp; 0 \\
-V_{L C}^{\dagger} &amp; E-H_{C} &amp; -V_{R C}^{\dagger} \\
0 &amp; -V_{R C} &amp; E-H_{R}
\end{array}\right)\left(\begin{array}{ccc}
G_{L} &amp; G_{L C} &amp; 0 \\
G_{C L} &amp; G_{C} &amp; G_{C R} \\
0 &amp; G_{R C} &amp; G_{R}
\end{array}\right)=I
\]</span> where</p>
<ul>
<li>we introduce the matrix <span class="math inline">\(E=(E+i \eta) I\)</span>,</li>
<li>and represent the matrix Green function in a convenient form, the notation of retarded function is omitted in intermediate formulas.</li>
</ul>
<p>Now our first goal is to find the system Green function <span class="math inline">\(G_{C}\)</span> which defines all quantities of interest.</p>
<p>From the matrix equation <span class="math display">\[
\begin{aligned}
\left( E - H _{L}\right) G _{L C}- V _{L C} G _{C} &amp;=0 \\
- V _{L C}^{\dagger} G _{L C}+\left( E - H _{C}\right) G _{C}- V _{R C}^{\dagger} G _{R C} &amp;= I , \\
- V _{R C} G _{C}+\left( E - H _{R}\right) G _{R C} &amp;=0 .
\end{aligned}
\]</span> From the first and the third equations one has <span class="math display">\[
\begin{array}{l}
G_{L C}=\left( E - H _{L}\right)^{-1} V _{L C} G _{C} \\
G _{R C}=\left( E - H _{R}\right)^{-1} V _{R C} G _{C}
\end{array}
\]</span> and substituting it into the second equation we arrive at the equation <span class="math display">\[
\left(E-H_{C}-\Sigma\right) G_{C}=I
\]</span> where we introduce the electrode <strong>self-energy</strong> (which should be also called retarded) <span class="math display">\[
\Sigma = V _{L C}^{\dagger}\left( E - H _{L}\right)^{-1} V _{L C}+ V _{R C}^{\dagger}\left( E - H _{R}\right)^{-1} V _{R C}
\]</span> #### GF of a nanosystem</p>
<p>Finally, we found, that the retarded GF of a nanosystem coupled to the leads is determined by the expression (we restore the <span class="math inline">\(R\)</span> notation for retarded functions) <span class="math display">\[
G_{C}^{R}(E)=\left[E-H_{C}-\Sigma^{R}\right]^{-1}
\]</span> the effects of the leads are included <strong>through</strong> the self-energy. Here we should stress the important property of the self-energy <span class="math display">\[
\Sigma=V_{L C}^{\dagger}\left(E-H_{L}\right)^{-1} V_{L C}+V_{R C}^{\dagger}\left(E-H_{R}\right)^{-1} V_{R C}
\]</span> it is determined only by the coupling Hamiltonians <span class="math inline">\(V_{s C}\)</span> and the retarded GFs of the isolated leads <span class="math inline">\(G_{s}^{R}(s=L, R)\)</span> <span class="math display">\[
\begin{array}{c} 
G _{s}^{R}=\left( E - H _{s}\right)^{-1}, \\
\Sigma _{s}^{R}= V _{s C}^{\dagger}\left( E - H _{s}\right)^{-1} V _{s C}= V _{s C}^{\dagger} G_{s}^{R} V _{s C}
\end{array}
\]</span> or, in index notation, <span class="math display">\[
\Sigma _{s ; \alpha \beta}^{R}=\sum_{\delta \gamma}\left(V_{s C}^{\dagger}\right)_{\alpha \delta} G_{s ; \delta \gamma}^{R} V_{s ; \gamma \beta}=\sum_{\delta \gamma} V_{s ; \delta \alpha}^{*} V_{s ; \gamma \beta} G_{s ; \delta \gamma}^{R}
\]</span> It means, that the contact self-energy is <strong>independent</strong> of the state of the nanosystem itself and describes completely the influence of the electrodes. Later we shall see that this property is also conserved for interacting central systems, if the leads are still non-interacting.</p>
<blockquote>
<p>接触自能与纳米系统本身的状态无关，完全描述了电极的影响。</p>
</blockquote>
<p>The extension from two-electrode to multi-electrode case is straightforward, the self-energies <span class="math inline">\((s=1, \ldots, N)\)</span> are given by the formulas (3.119)-(3.121) and <span class="math inline">\(\Sigma^{R}\)</span> in (3.118) is the sum over all electrodes <span class="math display">\[
\Sigma^{R}=\sum_{s} \Sigma_{s}^{R}
\]</span> ### 3.2.4 Transmission Function and Current</p>
<p>Now we want to calculate the current through a junction. We assume, as before, that the electrodes are equilibrium, and there is the voltage <span class="math inline">\(V\)</span> applied between the left and right electrodes. The calculation of the current in a general case is more convenient to perform using the full power of the nonequilibrium Green function method. Here we present a simplified approach, valid for non-interacting systems only.</p>
<h4 id="矩阵薛定谔">矩阵薛定谔</h4>
<p>First, we consider a very simple approach, following Paulsson [4]. Let us come back to the Schrödinger equation in the matrix representation <span class="math display">\[
H \Psi_{n}=E_{n} \Psi _{n}
\]</span> and write it in the following form <span class="math display">\[
\left(\begin{array}{ccc}
H_{L}^{0} &amp; V_{L S} &amp; 0 \\
V_{L S}^{\dagger} &amp; H_{C}^{0} &amp; V_{R S}^{\dagger} \\
0 &amp; V_{R S} &amp; H_{R}^{0}
\end{array}\right)\left(\begin{array}{c}
\Psi_{L} \\
\Psi_{C} \\
\Psi_{R}
\end{array}\right)=E\left(\begin{array}{c}
\Psi_{L} \\
\Psi_{C} \\
\Psi_{R}
\end{array}\right)
\]</span> where <span class="math inline">\(\Psi_{L}, \Psi_{C}\)</span>, and <span class="math inline">\(\Psi_{R}\)</span> are vector wave functions of the left lead, the central system, and the right lead correspondingly.</p>
<p>Now we find the solution in the scattering form (which is difficult to call true scattering because we do not define explicitly the geometry of the leads). Namely, in the left lead <span class="math display">\[
\Psi_{L}=\Psi_{L}^{0}+\Psi_{L}^{1}
\]</span> where</p>
<ul>
<li><span class="math inline">\(\Psi_{L}^{0}\)</span> is the eigenstate of <span class="math inline">\(H_{L}^{0}\)</span>, and is considered as known initial wave.</li>
<li>The "reflected" wave <span class="math inline">\(\Psi_{L}^{1}\)</span>,</li>
<li>as well as the transmitted wave in the right lead <span class="math inline">\(\Psi_{R}\)</span>, appear only as a result of the interaction between subsystems. The main trick is, that we find a retarded solution.</li>
</ul>
<p>Solving the Schrödinger equation in the matrix representation with these conditions, the solution is <span class="math display">\[
\begin{aligned}
\Psi_{L}&amp;=\left(1+G_{L}^{0 R} V_{L S} G_{C}^{R} V_{L S}^{\dagger}\right) \Psi_{L}^{0} \\
\Psi_{R}&amp;=G_{R}^{0 R} V_{R S} G_{C}^{R} V_{L S}^{\dagger} \Psi_{L}^{0} \\
\Psi_{C}&amp;=G_{C}^{R} V_{L S}^{\dagger} \Psi_{L}^{0}
\end{aligned}
\]</span> &gt; 薛定谔方程的解——波函数：<span class="math inline">\(\Psi_{L}\)</span> 可以写成无微扰波函数 <span class="math inline">\(\Psi_{L}^{0}\)</span> 与格林函数的关系。它们描述了散射过程的量子幅度。</p>
<p>The physical sense of this expressions is quite transparent, they describe the quantum amplitudes of the scattering processes. Three functions <span class="math inline">\(\Psi_{L}, \Psi _{C}\)</span>, and <span class="math inline">\(\Psi _{R}\)</span> are equivalent together to the scattering state in the Landauer-Büttiker theory. Note, that <span class="math inline">\(G_{C}^{R}\)</span> here is the full GF of the nanosystem including the lead self-energies.</p>
<h4 id="流">流</h4>
<p>Now the next step. We want to calculate the current. The partial (for some particular eigenstate <span class="math inline">\(\Psi_{L \lambda}^{0}\)</span> ) current from the lead to the system is <span class="math display">\[
j_{s=L, R}=\frac{i e}{\hbar}\left(\Psi_{s}^{\dagger} V _{s C} \Psi _{C}- \Psi _{C}^{\dagger} H _{s C}^{\dagger} \Psi _{s}\right)
\]</span> To calculate the total current we should substitute the expressions for the wave functions</p>
<ul>
<li><span class="math inline">\(\Psi _{L}=\left(1+ G _{L}^{0 R} V _{L S} G _{C}^{R} V _{L S}^{\dagger}\right) \Psi _{L}^{0}\)</span>,</li>
<li><span class="math inline">\(\Psi _{R}= G _{R}^{0 R} V _{R S} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L}^{0}\)</span></li>
<li><span class="math inline">\(\Psi _{C}= G _{C}^{R} V _{L S}^{\dagger} \Psi _{L}^{0}\)</span></li>
</ul>
<p>and summarize all contributions [4]. As a result the Landauer formula is obtained. We present the calculation for the transmission function.</p>
<h5 id="level-width-function">level-width function</h5>
<p>First, after substitution of the wave functions we have for the partial current through the system <span class="math display">\[
\begin{aligned}
j_{\lambda} &amp;=j_{L}=-j_{R}=-\frac{i e}{\hbar}\left(\Psi_{R}^{\dagger} V_{R S} \Psi_{C}-\Psi_{C}^{\dagger} H_{R S}^{\dagger} \Psi_{R}\right) \\
&amp;=-\frac{i e}{\hbar}\left(\Psi_{L}^{0 \dagger} V_{L S} G_{C}^{A} V_{R S}^{\dagger}\left(G_{R}^{0 \dagger}-G_{R}^{0}\right) V_{R S} G_{C}^{R} V_{L S}^{\dagger} \Psi_{L}^{0}\right) \\
&amp;=\frac{e}{\hbar}\left(\Psi_{L}^{0 \dagger} V_{L S} G_{C}^{A} \Gamma_{R} G_{C}^{R} V_{L S}^{\dagger} \Psi_{L}^{0}\right)
\end{aligned}
\]</span> Here we introduce and use for the first time the new function (matrix) <span class="math display">\[
\Gamma _{s}=i\left( \Sigma _{s}^{R}- \Sigma _{s}^{A}\right),
\]</span> called the <strong>level-width function</strong>.</p>
<h5 id="full-current">full current</h5>
<p>The full current of all possible left eigenstates is given by <span class="math display">\[
I=\sum_{\lambda} j_{\lambda}=\sum_{\lambda} \frac{e}{\hbar}\left(\Psi_{L \lambda}^{0 \dagger} V_{L S} G_{C}^{A} \Gamma_{R} G_{C}^{R} H_{L S}^{\dagger} \Psi_{L \lambda}^{0}\right) f_{L}\left(E_{\lambda}\right)
\]</span> the distribution function <span class="math inline">\(f_{L}\left(E_{\lambda}\right)\)</span> describes the population of the left states, the distribution function of the right lead is absent here, because we consider only the current from the left to the right.</p>
<h4 id="transmission-function">Transmission function</h4>
<p>The same current is given by the Landauer formula through the transmission function <span class="math inline">\(T(E)\)</span> <span class="math display">\[
I=\frac{e}{h} \int_{-\infty}^{\infty} T(E) f_{L}(E) d E
\]</span> If one compares these two expressions for the current, the transmission function at some energy is obtained as <span class="math display">\[
\begin{aligned}
T(E) &amp;=2 \pi \sum_{\lambda} \delta\left(E-E_{\lambda}\right)\left(\Psi_{L \lambda}^{0 \dagger} V _{L S} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L \lambda}^{0}\right) \\
&amp;=2 \pi \sum_{\lambda} \sum_{\delta} \delta\left(E-E_{\lambda}\right)\left( \Psi _{L \lambda}^{0 \dagger} V _{L S} \Psi _{\delta}\right)\left( \Psi _{\delta}^{\dagger} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L \lambda}^{0}\right) \\
&amp;=\sum_{\delta}\left( \Psi _{\delta}^{\dagger} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger}\left(2 \pi \sum_{\lambda} \delta\left(E-E_{\lambda}\right) \Psi _{L \lambda}^{0} \Psi _{L \lambda}^{0 \dagger}\right) V _{L S} \Psi _{\delta}\right) \\
&amp;=\operatorname{Tr}\left( \Gamma _{L} G _{C}^{A} \Gamma _{R} G _{C}^{R}\right)
\end{aligned}
\]</span> To evaluate the sum in brackets we used the eigenfunction expansion <span class="math inline">\(G_{\alpha \beta}^{R}(\varepsilon)=\sum_{\lambda} \frac{\Psi_{\lambda}(\alpha) \Psi_{\lambda}^{*}(\beta)}{\varepsilon+i \eta-E_{\lambda}}\)</span> for the left contact.</p>
<p>We obtained a new representation for the transmission function, which is very <strong>convenient for numerical</strong> calculations <span class="math display">\[
T(E)=\operatorname{Tr}\left(t t^{\dagger}\right)=\operatorname{Tr}\left(\Gamma_{L}(E) G^{R}(E) \Gamma_{R}(E) G^{A}(E)\right)
\]</span> If one compares this expression with <span class="math display">\[
\begin{aligned}
T_{s p}(E)=&amp;\sum_{n m}\left|t_{s n, p m}\right|^{2} \\
=&amp; \int d r _{p 2} \int d r _{p 1} \int d r _{s 1} \int d r _{s 2}  \Gamma_{p}\left( r _{p 2}, r _{p 1}\right) G^{R}\left( r _{p 1}, r _{s 1}\right) \Gamma_{s}\left( r _{s 1}, r _{s 2}\right) G^{A}\left( r _{s 2}, r _{p 2}\right)
\end{aligned}
\]</span> obtained from the Fisher-Lee relation</p>
<ul>
<li><p>it becomes clear that our new formula <span class="math inline">\(T(E)=\operatorname{Tr}\left( \Gamma _{L} G _{C}^{A} \Gamma _{R} G _{C}^{R}\right)\)</span> is the <strong>discretized version</strong></p></li>
<li><p>and the function <span class="math inline">\(\Gamma_{s}\left(r_{s 1}, r_{s 2}\right)\)</span> is analog of the level-width function.</p></li>
</ul>
<p>Indeed, one can calculate the self-energy explicitly from the wave functions of a semi-infinite electrode. It means that (3.133) can be derived from the Landauer approach directly.</p>
<h5 id="finite-voltage">finite voltage</h5>
<p>Finally, one important remark, at finite voltage the diagonal energies in the Hamiltonians <span class="math inline">\(H _{L}^{0}, H _{C}^{0}\)</span>, and <span class="math inline">\(H _{R}^{0}\)</span> are shifted <span class="math inline">\(\varepsilon_{\alpha} \rightarrow \varepsilon_{\alpha}+e \varphi_{\alpha} .\)</span> Consequently, the energy dependencies of the self-energies defined by <span class="math display">\[
\Sigma _{s ; \alpha \beta}^{R}=\sum_{\delta \gamma}\left(V_{s C}^{\dagger}\right)_{\alpha \delta} G_{s ; \delta \gamma}^{R} V_{s ; \gamma \beta}=\sum_{\delta \gamma} V_{s ; \delta \alpha}^{*} V_{s ; \gamma \beta} G_{s ; \delta \gamma}^{R}
\]</span> are <strong>also changed</strong> and the lead self-energies are voltage dependent. However, it is convenient to define the selfenergies using the Hamiltonians at zero voltage, in that case the voltage dependence should be explicitly shown in the transmission formula <span class="math display">\[
T(E)=\operatorname{Tr}\left[\tilde{\Gamma}_{L}\left(E-e \varphi_{L}\right) G^{R}(E) \tilde{\Gamma}_{R}\left(E-e \varphi_{R}\right) G^{A}(E)\right]
\]</span> where <span class="math inline">\(\varphi_{R}\)</span> and <span class="math inline">\(\varphi_{L}\)</span> are electrical potentials of the right and left leads.</p>
<h2 id="recursive-method">3.3 Recursive Method</h2>
<h3 id="dyson-equation">3.3.1 Dyson Equation</h3>
<p>The recursive Green function method is an approach to calculate the Green functions of <strong>multi-component</strong> systems if the Green functions of isolated subsystems and the coupling matrices between subsystems are known. Starting at one end of the system (usually one of the electrodes), the subsystems are added one by one, finally the Green function of the whole system can be found.</p>
<p>优点 It is a convenient way to calculate the relevant Green function components for large complex systems which can be divided into many connected parts. From computational point of view the recursive method can be much faster than direct solution of the equations for large systems.</p>
<p>The method is based on the Dyson equation <span class="math inline">\(^{5}\)</span> for the full Green function <span class="math inline">\(G\)</span>, the Green function for a disconnected system <span class="math inline">\(G_{0}\)</span> and the coupling matrix <span class="math inline">\(V\)</span> : <span class="math display">\[
G=G_{0}+G_{0} V G
\]</span> The full GF is defined by the full Hamiltonian <span class="math display">\[
H=H_{0}+V
\]</span></p>
<p><span class="math display">\[
(E-H) G=I
\]</span></p>
<p>the GF of the particular parts of the system is defined as <span class="math display">\[
\left(E-H_{0}\right) G_{0}=I
\]</span> Comparing this two equations, it is easy to get <span class="math inline">\(G=G_{0}+G_{0} V G\)</span>. The advantage of the Dyson equation is that if one connects an additional external system to the system of interest, it is enough to know the Green function of this external system (independently of how it was calculated) and the coupling matrix. Note, that this procedure works only for non-interacting systems or as a perturbation in <span class="math inline">\(V\)</span> for interacting systems, otherwise <span class="math inline">\(V\)</span> should be replaced by a more general self-energy. However, the recursive method can be applied to interacting systems in combination with the iterative procedure.</p>
<p><img src="https://jptanjing.oss-cn-beijing.aliyuncs.com/img/image-20210508103852331.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p>
<blockquote>
<p>Fig. <span class="math inline">\(3.3\)</span> Two subsystems <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with known Green functions are connected by the coupling <span class="math inline">\(V\)</span> forming the system <span class="math inline">\(A+B\)</span></p>
</blockquote>
<p>Consider how this equation works if we couple two systems with Green functions <span class="math inline">\(G _{A}^{0}\)</span> and <span class="math inline">\(G _{B}^{0}\)</span> (Fig.3.3), note that we do not need any explicit Hamiltonian for the subsystems <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, they can be connected to an arbitrary number of other systems and electrodes through corresponding self-energies. The functions <span class="math inline">\(G _{A}^{0}\)</span> and <span class="math inline">\(G _{B}^{0}\)</span> are defined in the subspaces <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with the numbers of states <span class="math inline">\(N_{A}\)</span> and <span class="math inline">\(N_{B}\)</span> respectively, the full matrices <span class="math inline">\(G , G _{0}, V\)</span> have the dimensions <span class="math inline">\(\left(N_{A}+N_{B}\right) \times\left(N_{A}+N_{B}\right)\)</span>, and we write the equation <span class="math display">\[
G=G_{0}+G_{0} V G
\]</span> as <span class="math display">\[
\left(\begin{array}{cc}
G_{A} &amp; G_{A B} \\
G_{B A} &amp; G_{B}
\end{array}\right)=\left(\begin{array}{cc}
G_{A}^{0} &amp; 0 \\
0 &amp; G_{B}^{0}
\end{array}\right)+\left(\begin{array}{cc}
G_{A}^{0} &amp; 0 \\
0 &amp; G_{B}^{0}
\end{array}\right)\left(\begin{array}{cc}
0 &amp; V_{A B} \\
V_{B A} &amp; 0
\end{array}\right)\left(\begin{array}{cc}
G_{A} &amp; G_{A B} \\
G_{B A} &amp; G_{B}
\end{array}\right),
\]</span> where</p>
<ul>
<li><span class="math inline">\(V _{A B}\)</span> is the coupling matrix between subsystems with the dimensions <span class="math inline">\(N_{A} \times N_{B}\)</span>.</li>
</ul>
<p>We are interested in calculation of</p>
<ul>
<li>the function <span class="math inline">\(G^{A}\)</span> describing the subsystem <span class="math inline">\(A\)</span></li>
<li>and <span class="math inline">\(G_{B A}\)</span> describing mixing between subsystems <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</li>
</ul>
<p>After simple calculations we get <span class="math display">\[
\begin{array}{c}
\left(\left(G_{A}^{0}\right)^{-1}-V_{A B} G_{B}^{0} V_{B A}\right) G_{A}=\left(\left(G_{A}^{0}\right)^{-1}-\Sigma_{A B}\right) G_{A}=I \\
G_{B A}=G_{B}^{0} V_{B A} G_{A}
\end{array}
\]</span> We reproduce in a more general way the calculation of the self-energy <span class="math inline">\(\Sigma _{s}^{R}= V _{s C}^{\dagger}\left( E - H _{s}\right)^{-1} V _{s C}= V _{s C}^{\dagger} G _{s}^{R} V _{s C}\)</span> <span class="math display">\[
\Sigma _{A B}= V _{A B} G _{B}^{0} V _{B A}
\]</span> introduced by the system <span class="math inline">\(B\)</span> into the system <span class="math inline">\(A\)</span>. As an other example we prove that the multi-electrode self-energy <span class="math inline">\(\Sigma^{R}=\sum_{s} \Sigma_{s}^{R}\)</span> is a sum of the self-energies for particular electrodes. Assume that we add one more electrode with the Green function (of the isolated electrode) <span class="math inline">\(G_{s}\)</span> through the coupling matrix <span class="math inline">\(V_{s C}\)</span>. The Green function of the system before is <span class="math inline">\(G _{C}^{(0)}=\left[ E - H _{C}- \Sigma ^{(0)}\right]^{-1}\)</span>, with <span class="math inline">\(\Sigma ^{(0)}\)</span> being the self-energy of all electrodes coupled earlier. Using the equation (3.137) we get <span class="math display">\[
\left(\left(G_{C}^{0}\right)^{-1}-V_{C s} G_{s} V_{s C}\right) G_{C}=\left(E-H_{C}-\Sigma^{(0)}-\Sigma_{C s}\right) G_{C}=I
\]</span> so that the new self-energy is <span class="math inline">\(\Sigma = \Sigma ^{(0)}+ \Sigma _{C s}\)</span>.</p>
<h3 id="quad-recursive-method-for-1-d-systems">3.3.2 <span class="math inline">\(\quad\)</span> Recursive Method for <span class="math inline">\(1 D\)</span> Systems</h3>
<p>Direct calculation of the retarded Green function by means of matrix inversion <span class="math inline">\(G_{C}^{R}(E)=\left[ E - H _{C}- \Sigma ^{R}\right]^{-1}\)</span> may be computationally intractable for large systems. In the particularly important case of "long" systems with high aspect ratio and short range coupling between base orbitals (important examples are carbon nanotubes and nanoribbons) the central system can be divided into many parts (slices) with only neighbor coupling between slices (Fig. 3.4),</p>
<p><img src="https://jptanjing.oss-cn-beijing.aliyuncs.com/img/image-20210508104338074.png" srcset="/img/loading.gif" style="zoom: 50%;" /></p>
<blockquote>
<p>Fig. <span class="math inline">\(3.4\)</span> The central region (in the dashed box) divided into <span class="math inline">\(N\)</span> slices</p>
</blockquote>
<p>namely <span class="math inline">\(H _{i, i+1}\)</span> is the coupling of slice <span class="math inline">\(i\)</span> and <span class="math inline">\((i+1)\)</span>. The Hamiltonian has a tridiagonal form: <span class="math display">\[
H =\left(\begin{array}{ccccc} 
H _{11} &amp; H _{12} &amp; 0 &amp; \cdots &amp; 0 \\
H _{21} &amp; H _{22} &amp; H _{23} &amp; \cdots &amp; \cdots \\
0 &amp; H _{32} &amp; H _{33} &amp; &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; H _{N N-1} \\
0 &amp; \cdots &amp; 0 &amp; H _{N-1 N} &amp; H _{N N}
\end{array}\right)
\]</span> Besides, we assume here that 1 -st and <span class="math inline">\(N\)</span> -th slices are coupled to the left and right electrodes by the self-energies <span class="math inline">\(\Sigma_{L}\)</span> and <span class="math inline">\(\Sigma_{R}\)</span> respectively.</p>
<p>The Green function <span class="math inline">\(G\)</span> can be represented as a matrix in the "slice space" with the elements being matrices in the basis of corresponding slices: <span class="math display">\[
G=\left(\begin{array}{ccccc}
G_{11} &amp; G_{12} &amp; G_{13} &amp; \cdots &amp; G_{1 N} \\
G_{21} &amp; G_{22} &amp; G_{23} &amp; \cdots &amp; G_{2 N} \\
G_{31} &amp; G_{32} &amp; G_{33} &amp; \cdots &amp; G_{3 N} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
G_{N 1} &amp; G_{N 2} &amp; G_{N 3} &amp; \cdots &amp; G_{N N}
\end{array}\right)
\]</span> The full Green function can be found from the equation <span class="math display">\[
(E-H-\Sigma) G=I,
\]</span> where the electrode self-energy has only two components in slice space: <span class="math inline">\(\Sigma_{11}=\Sigma_{L}\)</span> and <span class="math inline">\(\Sigma_{N N}=\Sigma_{R}\)</span>.</p>
<p>Usually the calculation of all elements is not required. Indeed, substituting (3.142) into the expressions for</p>
<ul>
<li>the transmission function <span class="math inline">\(T(E)=\operatorname{Tr}\left(\Gamma_{L}(E) G^{R}(E) \Gamma_{R}(E) G^{A}(E)\right)\)</span></li>
<li>and the local density of states <span class="math inline">\(\rho_{\alpha}(E)=-\frac{1}{\pi} \operatorname{Im} G_{\alpha \alpha}^{R}(E)\)</span></li>
<li>and taking into account that only first and last slices are coupled to the electrodes <span class="math inline">\(\left(\Gamma_{L}\right.\)</span> has only one nonzero element <span class="math inline">\(\Gamma_{L, 11}=-2 \operatorname{Im} \Sigma _{L}\)</span> and <span class="math inline">\(\Gamma _{R, N N}=\)</span> <span class="math inline">\(-2 \operatorname{Im} \Sigma _{R}\)</span> ), we find <span class="math inline">\(^{6}\)</span></li>
</ul>
<p><span class="math display">\[
\begin{array}{l}
T(E)=\operatorname{Tr}\left( \Gamma _{L} G _{1 N} \Gamma _{R} G _{1 N}^{\dagger}\right) \\
\rho(E)=\sum_{i=1}^{N} \rho_{i}(E)=-\frac{1}{\pi} \sum_{i=1}^{N} \operatorname{Im}\left(\operatorname{Tr} G _{i i}\right)
\end{array}
\]</span> As one can see, for transmission and current calculation only <span class="math inline">\(G_{1 N}\)</span> is required, for DOS calculation also all <span class="math inline">\(G _{i j}\)</span></p>
<p>The Green functions can be calculated starting from any end, first we consider the direction of recursion from left to right (forward recursion). At the first step the Green function <span class="math inline">\(G _{11}^{\rightarrow(1)}\)</span> is <span class="math display">\[
G_{11}^{\rightarrow(1)}=\left[ E - H _{11}- \Sigma _{L}\right]^{-1}
\]</span> this function is not the function <span class="math inline">\(G_{11}\)</span> in (3.142), it is just the function of the first slice connected to the left electrode (Fig. <span class="math inline">\(3.5\)</span> ). We repeat this procedure <span class="math inline">\(N\)</span> times for functions <span class="math inline">\(G_{i i}^{\rightarrow(i)}\)</span> and <span class="math inline">\(G_{1 i}^{\rightarrow(i)}\)</span>, for <span class="math inline">\(2 \leq i \leq N:\)</span> <span class="math display">\[
\begin{aligned}
G_{i i}^{\rightarrow(i)} &amp;=\left[ E - H _{i i}- \Sigma _{R} \delta_{i N}- H _{i, i-1} G _{i-1, i-1}^{\rightarrow(i-1)} H _{i-1, i}\right]^{-1} \\
G _{1 i}^{\rightarrow(i)} &amp;= G _{1, i-1}^{\rightarrow(i-1)} H _{i-1, i} G _{i i}^{\rightarrow(i)}
\end{aligned}
\]</span> The equation (3.147) follows from (3.137). To get the equation (3.148) we consider the Dyson equation (3.135) taken <span class="math inline">\(G _{0}\)</span> before connecting of the <span class="math inline">\(i\)</span> th slice as (we show only the elements calculated by the forward method): <span class="math display">\[
G_{0}=\left(\begin{array}{ccccc}
G_{11}^{\rightarrow(1)} &amp; G_{12}^{\rightarrow(2)} &amp; \cdots &amp; G_{1, i-1}^{\rightarrow(i-1)} &amp; 0 \\
&amp; G_{22}^{\rightarrow(2)} &amp; &amp; &amp; 0 \\
&amp; &amp; \ddots &amp; &amp; \\
&amp; &amp; &amp; &amp; \\
&amp; &amp; &amp; G_{i-1, i-1}^{\rightarrow(i-1)} &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; G_{i i}^{(0)}
\end{array}\right) .
\]</span> And the coupling matrix <span class="math inline">\(V\)</span> has only elements <span class="math inline">\(V _{i-1, i}= H _{i-1, i}\)</span> and <span class="math inline">\(V _{i, i-1}= H _{i, i-1}\)</span>. From the first line and <span class="math inline">\(i\)</span> -th column of (3.135) we get immediately the equation (3.148).</p>
<p>At each step we get the Green function of the <span class="math inline">\(i\)</span> -th slice <span class="math inline">\(G _{i i}^{\rightarrow(i)}\)</span> and the propagator between the first and the <span class="math inline">\(i\)</span> -th slice <span class="math inline">\(G _{1 i}^{\rightarrow i}\)</span> for the system connected up to the <span class="math inline">\(i\)</span> -th slice to the left electrode. At the last step we get <span class="math inline">\(G _{1 N}^{\rightarrow(N)}\)</span>, which is the true function <span class="math inline">\(G _{1 N}\)</span> and is sufficient to calculate the transmission function, as can be seen from (3.144).</p>
<p>Additional computational effort is required to calculate the density of states (3.145), as one needs all diagonal elements <span class="math inline">\(G _{i i}\)</span>, and during the recursion from left to right we got only intermediate functions <span class="math inline">\(G _{i i}^{\rightarrow(i)}\)</span> for partial systems. To get other slice Green functions we will apply the backward recursion, for <span class="math inline">\(N \geq i \geq 1\)</span> : <span class="math display">\[
\begin{array}{l}
G_{N N}^{\leftarrow(N)}=\left[ E - H _{N N}- \Sigma _{R}\right]^{-1} \\
G _{i i}^{\leftarrow(i)}=\left[ E - H _{i i}- \Sigma _{L} \delta_{i 1}- H _{i, i+1} G _{i+1, i+1}^{\leftarrow(i+1)} H _{i+1, i}\right]^{-1}
\end{array}
\]</span> in the end of this procedure we get the right answer for <span class="math inline">\(G _{11}\)</span>, as well as in the forward recursion we obtained <span class="math inline">\(G _{N N}\)</span>, all other <span class="math inline">\(G _{i i}\)</span> for <span class="math inline">\(1&lt;i&lt;N\)</span> are calculated as: <span class="math display">\[
G_{i i}=\left[ E - H _{i i}- H _{i, i-1} G _{i-1, i-1}^{\rightarrow(i-1)} H _{i-1, i}- H _{i, i+1} G _{i+1, i+1}^{\leftarrow(i+1)} H _{i+1, i}\right]^{-1}
\]</span> This is just the Dyson equation for slice <span class="math inline">\(i\)</span> with the left and right self-energies. Actually the first part in this expression is already calculated <span class="math inline">\(\left[ G _{i i}^{\rightarrow(i)}\right]^{-1}\)</span>. So that we can rewrite this expression as <span class="math display">\[
G_{i i}=G_{i i}^{\rightarrow(i)}\left[I-G_{i i}^{\rightarrow(i)} H_{i, i+1} G_{i+1, i+1}^{\leftarrow(i+1)} H_{i+1, i}\right]^{-1}
\]</span> For long systems with short range interactions the time required for calculation scales as <span class="math inline">\(M^{3} N\)</span>, where <span class="math inline">\(M \times M\)</span> are typical dimensions of one slice matrix (the typical time of matrix inversion is <span class="math inline">\(\left.M^{3}\right)\)</span>. If one uses the inversion for the whole system it scales as <span class="math inline">\((M N)^{3}\)</span> which is much larger for large <span class="math inline">\(N\)</span>.</p>
<h3 id="multi-connected-systems">3.3.3 Multi-connected Systems</h3>
<p>In the case of <span class="math inline">\(2 D\)</span> and <span class="math inline">\(3 D\)</span> multi-connected systems the recursive method in the form discussed above can be applied if the system is divided into slices with several subsystems in every slice. Alternatively, the Dyson equation can be applied to multiconnected systems with Green functions of isolated subsystems included into <span class="math inline">\(G _{0}\)</span> and all couplings between subsystems into <span class="math inline">\(V\)</span>.</p>
<p>Consider as an example three subsystems between two electrodes (Fig. 3.6). The fist slice consists of subsystems <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, the second of subsystem <span class="math inline">\(C .\)</span> The self-energy <span class="math inline">\(\Sigma_{L}\)</span> should be calculated for the system <span class="math inline">\(A+B\)</span>. It has a general non-diagonal form, as well as the Green function of the system <span class="math inline">\(A+B\)</span> connected to the electrode, which should be determined from the Dyson equation: <span class="math display">\[
\left(\begin{array}{cc}
G_{A} &amp; G_{A B} \\
G_{B A} &amp; G_{B}
\end{array}\right)^{\rightarrow(1)}=\left(\begin{array}{cc}
G_{A}^{0} &amp; 0 \\
0 &amp; G_{B}^{0}
\end{array}\right)+\left(\begin{array}{cc}
G_{A}^{0} &amp; 0 \\
0 &amp; G_{B}^{0}
\end{array}\right)\left(\begin{array}{ll}
\Sigma_{A A} &amp; \Sigma_{A B} \\
\Sigma_{B A} &amp; \Sigma_{B B}
\end{array}\right)\left(\begin{array}{cc}
G_{A} &amp; G_{A B} \\
G_{B A} &amp; G_{B}
\end{array}\right)^{\rightarrow(1)}
\]</span> this equation replaces the equation (3.146). The functions <span class="math inline">\(G _{A}\)</span> and <span class="math inline">\(G _{B}\)</span> are not independent and should be calculated simultaneously.</p>
<p>Let us consider in detail how the off-diagonal components appear. Following the previous approach we consider the coupling of systems <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> to the "left" system <span class="math inline">\(L\)</span>. The equation equivalent to (3.136) is: <span class="math display">\[
\begin{array}{c}
\left(\begin{array}{ccc} 
G _{A} &amp; G _{A B} &amp; G _{A C} \\
G _{B A} &amp; G _{B} &amp; G _{B C} \\
G _{L A} &amp; G _{L B} &amp; G _{L}
\end{array}\right)=\left(\begin{array}{ccc} 
G _{A}^{0} &amp; 0 &amp; 0 \\
0 &amp; G _{B}^{0} &amp; 0 \\
0 &amp; 0 &amp; G _{L}^{0}
\end{array}\right)+ \\
\left(\begin{array}{ccc} 
G _{A}^{0} &amp; 0 &amp; 0 \\
0 &amp; G _{B}^{0} &amp; 0 \\
0 &amp; 0 &amp; G _{L}^{0}
\end{array}\right)\left(\begin{array}{ccc}
0 &amp; 0 &amp; V _{A L} \\
0 &amp; 0 &amp; V _{B L} \\
V _{L A} &amp; V _{L B} &amp; 0
\end{array}\right)\left(\begin{array}{ccc} 
G _{A} &amp; G _{A B} &amp; G _{A L} \\
G _{B A} &amp; G _{B} &amp; G _{B L} \\
G _{L A} &amp; G _{L B} &amp; G _{L}
\end{array}\right)
\end{array}
\]</span> note that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are coupled to <span class="math inline">\(L\)</span>, but there is no direct coupling between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. From this equation one gets <span class="math inline">\((3.154)\)</span> with the self-energy <span class="math display">\[
\left(\begin{array}{cc}
\Sigma_{A A} &amp; \Sigma_{A B} \\
\Sigma_{B A} &amp; \Sigma_{B B}
\end{array}\right)=\left(\begin{array}{cc}
V_{A L} G_{L}^{0} V_{L A} &amp; V_{A L} G_{L}^{0} V_{L B} \\
V_{B L} G_{L}^{0} V_{L A} &amp; V_{B L} G_{L}^{0} V_{L B}
\end{array}\right)
\]</span> The diagonal elements reproduce (3.139), and the off-diagonal elements describe mutual influence of the systems <span class="math inline">\(A\)</span> and <span class="math inline">\(B .\)</span> Even if there is no direct coupling between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> (if this coupling <span class="math inline">\(V _{A B}\)</span> is present, it should be also included in <span class="math inline">\((3.155)\)</span> ), the effective coupling is established through the electrode.</p>
<p>The Green functions of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are calculated from (3.154). At the second step the Green function of the system <span class="math inline">\(C\)</span> is determined as: <span class="math display">\[
G _{C}=\left[ E - H _{C}- \Sigma _{R}- H _{C A} G _{A}^{\rightarrow(1)} H _{A C}- H _{C B} G _{B}^{\rightarrow(1)} H _{B C}\right]^{-1}
\]</span> For large systems with many elements and complex topology, the application of the recursive method starts to be cumbersome. It seems that the methods based on the direct solution of the Dyson equation in a subsystem space should be preferable.</p>
<h2 id="semi-infinite-electrodes">3.4 Semi-infinite Electrodes</h2>
<h3 id="surface-green-function">3.4.1 Surface Green Function</h3>
<p>Previously in this chapter we introduced the electrode self-energies <span class="math inline">\(\Sigma _{s}\)</span>, which are determined by (3.120), (3.121). Now let us discuss in more detail how these selfenergies can be calculated. The problem is that electrodes are usually assumed to be infinitely large at least in one direction. The direct matrix inversion (3.119) can not be performed in this case because the matrix has infinite size and the spectrum of an infinitely large system is continuous.</p>
<p>To proceed, we refine the model of electrodes and introduce the concept of surface Green function. First of all, one should note that usually (actually in all relevant cases) the electrode-to-system coupling <span class="math inline">\(V_{s C}\)</span> in the spatially localized (tight-binding) basis is nonzero only for limited number of close to the surface basis orbitals. We consider a semi-infinite electrode (Fig. 3.7) as a series of equivalent blocks with the Hamiltonian <span class="math inline">\(H_{0}\)</span> and interblock neighbor couplings <span class="math inline">\(H_{1} .\)</span> We assume that the size of the block is large enough to fulfill two conditions: (i) only couplings between neighbor blocks can be taken into account. The Hamiltonian of such an electrode is of the standard tridiagonal form: <span class="math display">\[
H =\left(\begin{array}{ccccc} 
H _{0} &amp; H _{1} &amp; 0 &amp; 0 &amp; \cdots \\
H _{1}^{\dagger} &amp; H _{0} &amp; H _{1} &amp; 0 &amp; \cdots \\
0 &amp; H _{1}^{\dagger} &amp; H _{0} &amp; H _{1} &amp; \cdots \\
0 &amp; 0 &amp; H _{1}^{\dagger} &amp; H _{0} &amp; \ddots \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \ddots
\end{array}\right),
\]</span> (ii) the central system is coupled only to the edge block. It means that the coupling matrix has the form <span class="math display">\[
V _{s C}=\left(\begin{array}{cccc}
\tilde{V}_{s C} &amp; 0 &amp; 0 &amp; \cdots \\
0 &amp; 0 &amp; 0 &amp; \cdots \\
0 &amp; 0 &amp; 0 &amp; \cdots \\
\vdots &amp; \vdots &amp; \ddots
\end{array}\right) .
\]</span> The Green function <span class="math inline">\(G_{s}^{R}\)</span> is of a general type (not periodic): <span class="math display">\[
G_{s}^{R}=\left(\begin{array}{cccc}
\tilde{ G }_{s}^{R} &amp; G _{12} &amp; G _{13} &amp; \cdots \\
G _{21} &amp; G _{22} &amp; G _{23} &amp; \cdots \\
G _{31} &amp; G _{32} &amp; G _{33} &amp; \cdots \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots
\end{array}\right)
\]</span> We introduce here the Green function of the edge block (rigorously, it is the part of the Green function corresponding to the basis of the edge block) <span class="math inline">\(\tilde{G}_{s}^{R}\)</span> and call it surface Green function. Because of the condition (ii) the self-energy is determined by <span class="math inline">\(\tilde{ G }_{s}^{R}\)</span> only, namely <span class="math display">\[
\Sigma _{s}^{R}=\tilde{ V }_{s C}^{\dagger} \tilde{ G }_{s}^{R} \tilde{ V }_{s C}
\]</span> Thus, our aim is to calculate the surface Green function <span class="math inline">\(\tilde{ G }_{s}^{R}\)</span>, all other parts of the matrix (3.160) are irrelevant.</p>
<p>We consider two different approaches to this problem: first the analytical solution, and second the numerical iterative method. 3.4.2 Analytical Solution To proceed, we use the relation between the Green function and the eigenfunctions <span class="math inline">\(\Psi_{\lambda}\)</span> of a system, which are solutions of the Schrödinger equation (3.85). Let us define <span class="math inline">\(\Psi_{\lambda}(\alpha) \equiv c_{\lambda}\)</span> in the eigenstate <span class="math inline">\(|\lambda\rangle\)</span> in the sense of definition (3.82), then <span class="math display">\[
G_{\alpha \beta}^{R}(\varepsilon)=\sum_{\lambda} \frac{\Psi_{\lambda}(\alpha) \Psi_{\lambda}^{*}(\beta)}{\varepsilon+i \eta-E_{\lambda}}
\]</span> where <span class="math inline">\(\alpha\)</span> is the TB state (site) index, <span class="math inline">\(\lambda\)</span> denotes the eigenstate, <span class="math inline">\(E_{\lambda}\)</span> is the energy of the eigenstate. The summation in this formula can be easily replaced by integration in the case of a continuous spectrum. It is important to notice, that the eigenfunctions <span class="math inline">\(\Psi_{\lambda}(\alpha)\)</span> should be calculated for the semi-infinite lead separately, because the Green function of the isolated lead is entering into the contact self-energy.</p>
<p>For example, for the semi-infinite <span class="math inline">\(1 D\)</span> chain of single-state sites <span class="math inline">\((n, m=1,2, \ldots)\)</span> we write <span class="math display">\[
G_{n m}^{R}(\varepsilon)=\int_{-\pi}^{\pi} \frac{d k}{2 \pi} \frac{\Psi_{k}(n) \Psi_{k}^{*}(m)}{\varepsilon+i \eta-E_{k}}
\]</span> with the eigenfunctions <span class="math inline">\(\Psi_{k}(n)=\sqrt{2} \sin k n\)</span>, and energies <span class="math inline">\(E_{k}=\varepsilon_{0}+2 t \cos k\)</span>.</p>
<p>Let us consider a simple situation, when the nanosystem is coupled only to the end site of the <span class="math inline">\(1 D\)</span> lead (Fig. 3.8). From (3.120) we obtain the matrix elements of the self-energy <span class="math display">\[
\Sigma_{\alpha \beta}=V_{1 \alpha}^{*} V_{1 \beta} G_{11}^{0 R}
\]</span> where the matrix element <span class="math inline">\(V_{1 \alpha}\)</span> describes the coupling between the end site of the lead <span class="math inline">\((n=m=1)\)</span> and the state <span class="math inline">\(|\alpha\rangle\)</span> of the nanosystem.</p>
<p>To make clear the main physical properties of the lead self-energy, let us analyze in detail the semi-infinite <span class="math inline">\(1 D\)</span> lead with the Green function (3.163). The integral can be calculated analytically <span class="math display">\[
G_{11}^{R}(\varepsilon)=\frac{1}{\pi} \int_{-\pi}^{\pi} \frac{\sin ^{2} k d k}{\varepsilon+i \eta-\varepsilon_{0}-2 t \cos k}=-\frac{\exp (i K(\varepsilon))}{t}
\]</span> where <span class="math inline">\(K(\varepsilon)\)</span> is determined from <span class="math inline">\(\varepsilon=\varepsilon_{0}+2 t \cos K .\)</span> Finally, we obtain the following expressions for the real and imaginary part of the self-energy <span class="math display">\[
\begin{array}{c}
\operatorname{Re} \Sigma_{\alpha \alpha}=\frac{\left|V_{1 \alpha}\right|^{2}}{t}\left(\kappa-\sqrt{\kappa^{2}-1}[\theta(\kappa-1)-\theta(-\kappa-1)]\right) \\
\operatorname{Im} \Sigma_{\alpha \alpha}=-\frac{\left|V_{1 \alpha}\right|^{2}}{t} \sqrt{1-\kappa^{2}} \theta(1-|\kappa|) \\
\kappa=\frac{\varepsilon-\varepsilon_{0}}{2 t}
\end{array}
\]</span> The real and imaginary parts of the self-energy, given by these expressions, are shown in Fig. 3.9. There are several important general conclusion that we can make looking at the formulas and the curves.</p>
<ol type="i">
<li>The self-energy is a complex function, the real part describes the energy shift of the level, and the imaginary part describes broadening. The finite imaginary part appears as a result of the continuous spectrum in the leads. The imaginary part determines the level-width function <span class="math display">\[
\Gamma=i\left(\Sigma-\Sigma^{\dagger}\right)
\]</span></li>
<li>In the wide-band limit <span class="math inline">\((t \rightarrow \infty)\)</span>, at the energies <span class="math inline">\(\varepsilon-\varepsilon_{0} \ll t\)</span>, it is possible to neglect the real part of the self-energy, and the only effect of the leads is level broadening. So that the self-energy of the left (right) lead is <span class="math display">\[
\Sigma_{L(R)}=-i \frac{\Gamma_{L(R)}}{2}
\]</span> These expressions we will use soon in Sect. <span class="math inline">\(3.5\)</span>.</li>
</ol>
<h3 id="the-iterative-method-for-1d-electrodes">3.4.3 The Iterative Method for 1D Electrodes</h3>
<p>In the case when analytical calculation of the electrode Green function is not possible, a numerical approach can be used. We consider the iterative method suggested in [5]. Here we first consider a 1D electrode: semi-infinite in one direction, but finite in other directions. The Hamiltonian in this case has the form (3.158) with all block matrices <span class="math inline">\(H _{0}, H _{1}\)</span> being finite-size, so that usual matrix inversion operations can be used for particular blocks.</p>
<p>We start from the exact equations for the elements of the Green function matrix (3.160), function <span class="math inline">\(\tilde{ G } \equiv G _{11}\)</span> is the surface Green function, <span class="math display">\[
\begin{array}{l}
\left( E - H _{0}\right) \tilde{ G }= I + H _{1} G _{21} \\
\left( E - H _{0}\right) G _{p 1}= H _{1}^{\dagger} G _{p-1,1}+ H _{1} G _{p+1,1}, \quad p \geqslant 2
\end{array}
\]</span> this infinite system of equations can be truncated to give the approximate answer. The convenient and numerically stable way to do it uses the following renormalization idea. Let us substitute the expression for <span class="math inline">\(G_{21}\)</span> from the second equation into the first one: <span class="math display">\[
\left( E - H _{0}- H _{1}\left( E - H _{0}\right)^{-1} H _{1}^{\dagger}\right) \tilde{ G }= I + H _{1}\left( E - H _{0}\right)^{-1} H _{1} G _{31}
\]</span> at the same time we rewrite (3.172) for only odd numbers <span class="math inline">\(p=3,5, \ldots\)</span> : <span class="math display">\[
\begin{aligned}
\left( E - H _{0}- H _{1}\left( E - H _{0}\right)^{-1} H _{1}^{\dagger}- H _{1}^{\dagger}\left( E - H _{0}\right)^{-1} H _{1}\right) &amp; \tilde{ G }_{p, 1}=\\
H _{1}^{\dagger}\left( E - H _{0}\right)^{-1} H _{1}^{\dagger} G _{p-2,1}+ H _{1}\left( E - H _{0}\right)^{-1} H _{1} G _{p+2,1}
\end{aligned}
\]</span> The structure of these equations is similar to the initial one, but they describe only odd slices. All even blocks participate through the renormalized coupling <span class="math inline">\(H _{1}^{\prime}=\)</span> <span class="math inline">\(H _{1}\left( E - H _{0}\right)^{-1} H _{1}\)</span>. If we change the numbering defining new Green functions at <span class="math inline">\(k&gt;1\)</span> as <span class="math inline">\(G _{k, 1}^{\prime}= G _{2 k-1,1}: G _{2,1}^{\prime}= G _{3,1}, G _{3,1}^{\prime}= G _{5,1}\)</span>, etc., and redefine the functions <span class="math display">\[
\begin{array}{l} 
A = H _{1} \\
B = H _{1}^{\dagger} \\
C = E - H _{0} \\
D = E - H _{0},
\end{array}
\]</span> with the following transformation <span class="math display">\[
\begin{array}{l} 
A ^{\prime}= A D^{-1} A , \\
B ^{\prime}= B D^{-1} B \\
C ^{\prime}= C - A D ^{-1} B , \\
D ^{\prime}= D - A D ^{-1} B - B D ^{-1} A ,
\end{array}
\]</span> we arrive at the (3.171), (3.172) with renormalized parameters. Note that <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> are the same in the beginning, but are transformed differently. Repeating the procedure <span class="math inline">\(n\)</span> times, we obtain the equations <span class="math display">\[
\begin{array}{l} 
C ^{(n)} \tilde{ G }= I + A ^{(n)} G _{21}^{(n)}, \\
D ^{(n)} G _{k 1}^{(n)}= B ^{(n)} G _{k-1,1}^{(n)}+ A ^{(n)} G _{k+1,1}^{(n)}, k \geqslant 2,
\end{array}
\]</span> The Green functions at each step are related to the functions of the initial problem, e.g. <span class="math inline">\(G _{21}^{(n)}= G _{2^{n}+1}\)</span>, but the first (surface) Green function <span class="math inline">\(G _{11}\)</span> is not changed by this transformation.</p>
<p>In the limit <span class="math inline">\(n \rightarrow \infty\)</span> one gets <span class="math inline">\(A^{(n)} \rightarrow 0\)</span> and <span class="math inline">\(\tilde{G}=\left(C^{(n)}\right)^{-1}\)</span>. The physical sense of this procedure is that the effective interaction for larger and larger distance between the blocks (at each step the number of "passive" slices between "active" is doubled) decreases and finally can be neglected. In practice, a large enough number of iterations should be done, the convergence criteria is small enough value of <span class="math inline">\(A^{(n)}\)</span>.</p>
<h3 id="the-iterative-method-for-2-d-and-3-d-electrodes">3.4.4 The Iterative Method for <span class="math inline">\(2 D\)</span> and <span class="math inline">\(3 D\)</span> Electrodes</h3>
<p>In the case of <span class="math inline">\(2 D\)</span> (for example graphene) or <span class="math inline">\(3 D\)</span> (usual metal and semiconductor) electrodes the iterative method should be combined with <span class="math inline">\(k\)</span> -sampling in the directions perpendicular to the surface. We assume here an ideal semi-infinite electrode formed from the blocks with the Hamiltonian <span class="math inline">\(H_{0}\)</span> and coupling dependent on the distance between blocks <span class="math inline">\(H _{\Delta n \Delta m \Delta l}\)</span>. <span class="math display">\[
H=\sum_{n m l, n^{\prime} m^{\prime} l^{\prime}} H_{n m l, n^{\prime} m^{\prime} l^{\prime}}, n \in[0, \infty], m, l \in[-\infty, \infty]
\]</span></p>
<p><span class="math display">\[
\Psi _{n m l}=\sum_{k_{x} k_{y}} \Psi _{n k} e^{i k_{x} m+i k_{y} l}, k_{x}, k_{y} \in[-\pi, \pi]
\]</span></p>
<p><span class="math display">\[
\sum_{n m l, n^{\prime} m^{\prime} l^{\prime}} H_{n m l, n^{\prime} m^{\prime} l^{\prime}} \Psi _{n^{\prime} k} e^{i k_{x} m^{\prime}+i k_{y} l^{\prime}}=E_{k} \Psi _{n k} e^{i k_{x} m+i k_{y} l}
\]</span></p>
<p><span class="math display">\[
\sum_{n^{\prime}} H_{n-n^{\prime}, k} \Psi _{n^{\prime} k}=E_{k} \Psi _{n k}
\]</span> where we introduced the <span class="math inline">\(k\)</span> -dependent Hamiltonian <span class="math display">\[
H _{n-n^{\prime}, k}=\sum_{\Delta m \Delta l} H _{n-n^{\prime}, \Delta m \Delta l} e^{i k_{x} \Delta m+i k_{y} \Delta l} .
\]</span> Now we assume that only neighbouring blocks in <span class="math inline">\(z\)</span> -direction are coupled and introduce the Hamiltonians <span class="math inline">\(H _{0}^{k}= H _{0, k}\)</span> and <span class="math inline">\(H _{1}^{k}= H _{1, k}\)</span>. We reduced the problem to the previously considered <span class="math inline">\(1 D\)</span> case, which can be solved by the iterative method. Thus for any <span class="math inline">\(k\)</span> we obtain the surface Green function <span class="math inline">\(\tilde{G}^{k}\)</span>.</p>
<p>The last thing to do is to calculate the surface Green function <span class="math inline">\(\tilde{ G }_{m l, m^{\prime} l^{\prime}}(E)\)</span> which takes all states into account. Using the eigenvalue expansion (3.25) and the Fourier representation (3.186) one gets: <span class="math display">\[
G_{n m l, n^{\prime} m^{\prime} l^{\prime}}(E)=\sum_{k}\left[\sum_{\lambda} \frac{\left| \Psi _{n k}^{\lambda}\right\rangle\left\langle \Psi _{n^{\prime} k}^{\lambda}\right|}{E+i \eta-E_{k}^{\lambda}}\right] e^{i k_{x}\left(m-m^{\prime}\right)+i k_{y}\left(l-l^{\prime}\right)}
\]</span> or <span class="math display">\[
\tilde{ G }_{\Delta m \Delta l}(E)=\sum_{k} \tilde{ G }^{k} e^{i k_{x} \Delta m+i k_{y} \Delta l}
\]</span> The surface Green function within one block is given simply by <span class="math inline">\(\sum_{k} \tilde{G}^{k}\)</span>. 3.5 Resonant Transport We can now analyze the basic features of coherent transport through discrete-level systems and some general properties described by the retarded Green function <span class="math inline">\((3.118):\)</span> <span class="math display">\[
G_{C}^{R}(E)=\left[ E - H _{C}- \Sigma ^{R}\right]^{-1}=\left[ E - H _{C}- \Sigma _{L}^{R}- \Sigma _{R}^{R}\right]^{-1}
\]</span> the transmission function (3.133): <span class="math display">\[
T(E)=\operatorname{Tr}\left( \Gamma _{L}(E) G _{C}^{R}(E) \Gamma _{R}(E) G _{C}^{A}(E)\right)
\]</span> clarify the physical sense of the self-energy (3.120): <span class="math display">\[
\begin{array}{c} 
\Sigma _{s=L(R)}^{R}=V_{s C}^{\dagger} G_{s}^{R} V _{s C} \\
\Sigma_{s=L(R) ; \alpha \beta}^{R}=\sum_{\delta \gamma}\left( V _{s C}^{\dagger}\right)_{\alpha \delta} G_{s ; \delta \gamma}^{R} V_{s ; \gamma \beta}=\sum_{\delta \gamma} V_{s ; \delta \alpha}^{*} V_{s ; \gamma \beta} G_{s ; \delta \gamma}^{R}
\end{array}
\]</span> and the level-width function (3.129): <span class="math display">\[
\Gamma _{s}=i\left( \Sigma _{s}^{R}- \Sigma _{s}^{A}\right) .
\]</span> We introduce also one new important function, the spectral function (matrix): <span class="math display">\[
A =i\left( G ^{R}- G ^{A}\right) .
\]</span> Comparing this expression with (3.104) one can see that <span class="math inline">\(A_{\alpha \alpha}(E)=2 \pi \rho_{\alpha \alpha}(E)\)</span> describes the local density of states</p>
<p>The level-width function can be in principle complex, for example in the situations with the external magnetic filed, but we will consider only the cases with a real <span class="math inline">\(\Gamma\)</span>. Moreover, we assume that <span class="math inline">\(\Gamma\)</span> is symmetric matrix <span class="math inline">\(\Gamma_{\alpha \beta}=\Gamma_{\beta \alpha}\)</span> and determines the imaginary part of <span class="math inline">\(\Sigma^{R}\)</span> : <span class="math display">\[
\Gamma =i\left( \Sigma ^{R}- \Sigma ^{A}\right)=-2 \operatorname{Im} \Sigma ^{R}, \quad \Sigma ^{R}=\operatorname{Re} \Sigma ^{R}-\frac{i}{2} \Gamma
\]</span> To understand the meaning of these functions, let us consider some simple examples of resonant transport, which take place for small couplings to the electrodes and energies close to the eigenenergies of the isolated system.</p>
<h3 id="single-level-model">3.5.1 Single-Level Model</h3>
<p>The simplest, but important case of resonant tunneling is transmission through a single level (Fig.3.10). We already considered it in Chap. 2 as the limiting case of transmission through a double-barrier potential and obtained the Lorentzian-shape formula (2.66). Now we get the same result using the Green function method. In the wide-band limit the energy independent electrode self-energies are <span class="math display">\[
\Sigma^{R}=\Sigma_{L}^{R}+\Sigma_{R}^{R}, \quad \Sigma_{L}^{R}=-i \frac{\Gamma_{L}}{2}, \quad \Sigma_{R}^{R}=-i \frac{\Gamma_{R}}{2}
\]</span> and for the retarded and advanced Green functions one gets <span class="math inline">\(\left(\varepsilon_{0}\right.\)</span> is the energy of the <span class="math display">\[
\begin{array}{c}
G^{R}(E)=\frac{1}{E-\varepsilon_{0}-\Sigma^{R}}=\frac{1}{E-\varepsilon_{0}+i\left(\Gamma_{L}+\Gamma_{R}\right) / 2} \\
G^{A}(E)=\frac{1}{E-\varepsilon_{0}-i\left(\Gamma_{L}+\Gamma_{R}\right) / 2}
\end{array}
\]</span> which gives the spectral function <span class="math display">\[
A(E)=-2 \operatorname{Im} G^{R}=\frac{\Gamma_{L}+\Gamma_{R}}{\left(E-\varepsilon_{0}\right)^{2}+(1 / 4)\left(\Gamma_{L}+\Gamma_{R}\right)^{2}}=\frac{\Gamma}{\left(E-\varepsilon_{0}\right)^{2}+\Gamma^{2} / 4}
\]</span> with <span class="math inline">\(\Gamma=\Gamma_{L}+\Gamma_{R}\)</span>. This function is shown in Fig. <span class="math inline">\(3.11\)</span> at three values of <span class="math inline">\(\Gamma=1,2,4\)</span>. It is nicely seen that <span class="math inline">\(\Gamma\)</span> determines the width of the curve at half-height.</p>
<p>Now using the general expression (3.194) we obtain the transmission function, recovering the result (2.66) generalized for asymmetric coupling: <span class="math display">\[
T(E)=\frac{\Gamma_{L} \Gamma_{R}}{\left[E-\varepsilon_{0}\right]^{2}+\left(\Gamma_{L}+\Gamma_{R}\right)^{2} / 4}
\]</span> This curve has the same Lorentzian shape as the spectral function. Interesting feature of the transmission for symmetric junctions <span class="math inline">\(\left(\Gamma_{L}=\Gamma_{R}\right)\)</span> is that its maximum value at <span class="math inline">\(E=\varepsilon_{0}\)</span> is always unity, even for very weak coupling.</p>
<p>It is useful to have some expressions to estimate current and conductance in the limiting cases. At Zero Temperature Note that the spin degeneracy is not taken into account and the Fermi distribution functions are assumed in the electrodes. The conductance at the Fermi energy is <span class="math display">\[
G=\frac{e^{2}}{h} T\left(E_{F}\right)=\frac{e^{2}}{h} \frac{\Gamma_{L} \Gamma_{R}}{\left(E_{F}-\varepsilon_{0}\right)^{2}+\left(\Gamma_{L}+\Gamma_{R}\right)^{2} / 4}
\]</span> with the maximum at <span class="math inline">\(\varepsilon_{0}=E_{F}\)</span>, we assume that the Fermi level is fixed by the electrodes and the energy of the level <span class="math inline">\(\varepsilon_{0}\)</span> is the parameter which can be changed. The maximum value of conductance is <span class="math display">\[
G_{\max }=\frac{e^{2}}{h} \frac{4 \Gamma_{L} \Gamma_{R}}{\left(\Gamma_{L}+\Gamma_{R}\right)^{2}}
\]</span> It is interesting that for symmetric junction <span class="math inline">\(\left(\Gamma_{L}=\Gamma_{R}\right)\)</span> it is always <span class="math inline">\(e^{2} / h\)</span> independently of the value of <span class="math inline">\(\Gamma_{L}\)</span>. For weaker coupling to the electrodes, exactly at the resonance the conductance is always the same, but the width of the resonance is decreasing.</p>
<p>The other useful formula is the exact expression for the current at finite voltage <span class="math display">\[
I(V)=\frac{e}{h} \frac{2 \Gamma_{L} \Gamma_{R}}{\Gamma_{L}+\Gamma_{R}}\left[\arctan \left(\frac{(1-\eta) e V-\varepsilon_{0}}{\left(\Gamma_{L}+\Gamma_{R}\right) / 2}\right)+\arctan \left(\frac{\eta e V+\varepsilon_{0}}{\left(\Gamma_{L}+\Gamma_{R}\right) / 2}\right)\right]
\]</span> if one assumes the linear shift of the energy level with voltage <span class="math inline">\(\tilde{\varepsilon}_{0}(V)=\varepsilon_{0}+\eta e V\)</span>. The saturation current at large voltage is <span class="math display">\[
I_{\max }=\frac{e}{h} \frac{2 \pi \Gamma_{L} \Gamma_{R}}{\Gamma_{L}+\Gamma_{R}}=\frac{e}{\hbar} \frac{\Gamma_{L} \Gamma_{R}}{\Gamma_{L}+\Gamma_{R}}
\]</span></p>
<h4 id="at-finite-temperature">At Finite Temperature</h4>
<p>The linear conductance is given by <span class="math display">\[
G(T)=\frac{e^{2}}{h} \frac{1}{4 T} \int_{-\infty}^{\infty}\left[\frac{\Gamma_{L} \Gamma_{R}}{\left(E-\varepsilon_{0}\right)^{2}+\left(\Gamma_{L}+\Gamma_{R}\right)^{2} / 4}\right] \frac{d E}{\cosh ^{2}(E /(2 T))}
\]</span> The off-resonant conductance at <span class="math inline">\(\left|\varepsilon_{0}\right| \gg \Gamma_{L}+\Gamma_{R}, T\)</span> is <span class="math display">\[
G=\frac{e^{2}}{h} \frac{\Gamma_{L} \Gamma_{R}}{\varepsilon_{0}^{2}}
\]</span> At weak coupling <span class="math inline">\(\Gamma_{L}, \Gamma_{R} \ll T\)</span> one gets <span class="math display">\[
G=\frac{e^{2}}{h} \frac{\pi \Gamma_{L} \Gamma_{R}}{\Gamma_{L}+\Gamma_{R}} \frac{1}{T \cosh ^{2}\left(\varepsilon_{0} /(2 T)\right)}
\]</span> These simple formulas are useful to estimate the currents and conductances.</p>
<h3 id="two-level-model-interference">3.5.2 Two-Level Model, Interference</h3>
<p>The other example (Fig. 3.12) is the two-level model (3.106): <span class="math display">\[
H =\left(\begin{array}{cc}
\varepsilon_{1} &amp; t \\
t &amp; \varepsilon_{2}
\end{array}\right) \text { , }
\]</span> we will consider the diagonal in level indices self-energies in the wide-band limit <span class="math display">\[
\Sigma_{L}=\left(\begin{array}{cc}
-\frac{i}{2} \Gamma_{L 1} &amp; 0 \\
0 &amp; -\frac{i}{2} \Gamma_{L 2}
\end{array}\right), \quad \Sigma_{R}=\left(\begin{array}{cc}
-\frac{i}{2} \Gamma_{R 1} &amp; 0 \\
0 &amp; -\frac{i}{2} \Gamma_{R 2}
\end{array}\right) .
\]</span> The expression for the Green function we obtain from (3.107) by replacing <span class="math inline">\(\eta\)</span> with the corresponding <span class="math inline">\(\Gamma_{1}=\left(\Gamma_{L 1}+\Gamma_{R 1}\right) / 2\)</span> or <span class="math inline">\(\Gamma_{2}=\left(\Gamma_{L 2}+\Gamma_{R 2}\right) / 2\)</span> : <span class="math display">\[
G^{R}(E)=\frac{1}{\left(E+i \Gamma_{1}-\varepsilon_{1}\right)\left(E+i \Gamma_{2}-\varepsilon_{2}\right)-t^{2}}\left(\begin{array}{cc}E+i \Gamma_{2}-\varepsilon_{2} &amp; t \\ t &amp; E+i \Gamma_{1}-\varepsilon_{1}\end{array}\right)
\]</span> This model describes several important limiting cases:</p>
<ul>
<li><ol type="i">
<li>the parallel coupling: <span class="math inline">\(\Gamma_{L 1}=\Gamma_{L 2}\)</span> and <span class="math inline">\(\Gamma_{R 1}=\Gamma_{R 2}\)</span>, in this case the levels are equivalently coupled to the electrodes and the current flows between the electrodes through both levels, also at <span class="math inline">\(t=0\)</span>;</li>
</ol></li>
<li><ol start="2" type="i">
<li>the sequential coupling:</li>
</ol></li>
</ul>
<p><span class="math display">\[
\Sigma_{L}=\left(\begin{array}{rr}
-\frac{i}{2} \Gamma_{L 1} 0 \\
0 &amp; 0
\end{array}\right), \quad \Sigma_{R}=\left(\begin{array}{cc}
0 &amp; 0 \\
0 &amp; -\frac{i}{2} \Gamma_{R 2}
\end{array}\right)
\]</span> in this case the current flows consequently through the first and the second level. At <span class="math inline">\(t=0\)</span> there is no current;</p>
<ul>
<li><ol start="3" type="i">
<li><span class="math inline">\(T\)</span> -junction:</li>
</ol></li>
</ul>
<p><span class="math display">\[
\Sigma_{L}=\left(\begin{array}{rr}
-\frac{i}{2} \Gamma_{L 1} &amp; 0 \\
0 &amp; 0
\end{array}\right), \quad \Sigma_{R}=\left(\begin{array}{rr}
-\frac{i}{2} \Gamma_{R 1} 0 \\
0 &amp; 0
\end{array}\right)
\]</span> in this case only first level is coupled to the electrodes, the second level participates in transport only through coupling <span class="math inline">\(t\)</span> to the first level.</p>
<p>Also other configurations are possible. For different couplings to the electrodes the transmission shows qualitatively different behavior.</p>
<p>Consider first symmetric parallel coupling with <span class="math inline">\(\Gamma_{L 1}=\Gamma_{R 1}=\Gamma_{L 2}=\Gamma_{R 2}=\Gamma / 2\)</span> thus <span class="math inline">\(\Gamma_{1}=\Gamma_{2}=\Gamma / 2\)</span>, which in the case of the uncoupled levels <span class="math inline">\((t=0)\)</span> gives the same broadening as for the single-level model above. The spectral function <span class="math inline">\(A(E)=\)</span> <span class="math inline">\(A_{11}+A_{22}=-2 \operatorname{Im}\left(G_{11}^{R}+G_{22}^{R}\right)\)</span> is presented in Fig.3.13 at <span class="math inline">\(\Gamma=1, \varepsilon_{1}=-2, \varepsilon_{2}=2\)</span> and three values of <span class="math inline">\(t=0,2,3 .\)</span> The dashed curve <span class="math inline">\((t=0)\)</span> is just a superposition of two spectral functions for two independent levels. At finite interaction between basis states <span class="math inline">\((t=2,3)\)</span> we observe the shift of the level positions, they reflect now the positions of the eigenenergies <span class="math inline">\(E_{1,2}\)</span>, and also some change of width. The transmission function looks again similar to the spectral function.</p>
<p>In all examples we considered so far, the resonant transmission functions have the Lorentzian (Breit-Wigner) form with the maxima corresponding to the eigenenergies of the central system and broadening being dependent by the coupling to the electrodes (the level-width functions). Situation can be very different if the interference effects are more important. Consider, for example, the <span class="math inline">\(T\)</span> -junction case when the second state is not coupled to the electrodes: <span class="math inline">\(\Gamma_{L 2}=\Gamma_{R 2}=0 .\)</span> We assume also that the first level is symmetrically coupled to the electrodes <span class="math inline">\(\Gamma_{L 1}=\Gamma_{R 1}(\)</span> Fig. <span class="math inline">\(3.14)\)</span>.</p>
<p>The spectral function is shown in Fig. 3.15. The second peak is much thinner because the second level is not directly coupled to the electrodes and broadening is possible only indirectly through the first level. Thus the level broadening is smaller for smaller <span class="math inline">\(t\)</span>. The form of the peaks is still Lorentz-like.</p>
<p>More interesting is the transmission function shown in Fig. <span class="math inline">\(3.16\)</span> at different interlevel couplings <span class="math inline">\(t\)</span>. First of all, at <span class="math inline">\(t=0\)</span> (dashed line) the transmission is nonzero only though the first level, the second level in this case is completely disconnected from the electrodes. Note that the spectral function takes the form <span class="math inline">\(A(\varepsilon) \propto \delta\left(E-\varepsilon_{2}\right)\)</span> near the energy of the second level. At finite <span class="math inline">\(t\)</span> the transmission appears near the energy of the second level (actually near the energy <span class="math inline">\(E_{2}\)</span> of the second eigenstate), but the shape of the resonance is not Lorentzian! Moreover, the transmission is exactly zero at the energy of the second level <span class="math inline">\(\varepsilon_{2}\)</span> independently of other parameters!</p>
<p>Qualitatively, the transmission can be exactly zero at some energy in the case of destructive interference, when the amplitudes for transmission for two paths have the same absolute values, but opposite sign because of the phase shift equal to <span class="math inline">\(\pi\)</span>. In our case the first path is the direct path through the first level, and the second path is the path from the left electrode to the first level, then to the second level, back to the first and finally to the right electrode. This situation is also called antiresonance. Consider the analytic expression for the transmission function (which is quite easy to calculate in this case) <span class="math display">\[
T(E)=\frac{\Gamma_{1}}{\left[E-\varepsilon_{1}-\frac{t^{2}}{E-\varepsilon_{2}}\right]^{2}+\Gamma_{1}^{2}}
\]</span> At <span class="math inline">\(t=0\)</span> the Breit-Wigner resonance is reproduced. At small <span class="math inline">\(t\)</span> the antiresonance is strongly pronounced because the second resonant maximum is only slightly shifted from the antiresonant point <span class="math inline">\(E=\varepsilon_{2}\)</span>. At larger <span class="math inline">\(t\)</span> the second maximum is shifted to larger energies, the shape of this peak is more and more Lorentzian and the antiresonant feature is disappearing.</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Condensed-matter-Physics/">Condensed matter Physics</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Transport/">Transport</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2021/05/07/CMP_15_Transport99_DR_04/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">纳米尺度下量子输运理论-4</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2021/05/07/CMP_06_SC02_Hub/">
                        <span class="hidden-mobile">一维Hubbard模型</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>


      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 1,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "纳米尺度下量子输运理论-3&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js" ></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  
















</body>
</html>
