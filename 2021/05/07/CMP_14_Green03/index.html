<!DOCTYPE html>
<html lang="en">





<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="JPZhuang">
  <meta name="keywords" content="">
  <title>格林函数 数值模拟 - JPZ</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Physics</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('https://jptanjing.oss-cn-beijing.aliyuncs.com/blog_QuantumAI/CMP_14_Green03.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2021-05-07 09:01">
      May 7, 2021 am
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      92
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>[TOC]</p>
<h2 id="参考">参考</h2>
<ol type="1">
<li>Pedagogical introduction to equilibrium Green's functions: condensed-matter examples with numerical implementations</li>
<li>Numerical methods for many-body quantum dynamics 加州理工学位论文</li>
</ol>
<h3 id="electron-greens-function">Electron Green's function</h3>
<p>We will start with formal definitions of the electron Green's function, our object of study. The single particle electron Green's function is defined as the statistical expectation value of the product of fermion operators at different positions <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> and different times <span class="math inline">\(t\)</span> and <span class="math inline">\(t^{\prime}\)</span>. For instance, the so-called "causal" Green's function reads <span class="math display">\[
G_{i j}^{c}\left(t, t^{\prime}\right)=-i\left\langle T\left[c_{i}(t) c_{j}^{\dagger}\left(t^{\prime}\right)\right]\right\rangle
\]</span> where <span class="math inline">\(c_{j}^{\dagger}\)</span> creates and electron at the <span class="math inline">\(j\)</span> -th site at time <span class="math inline">\(t^{\prime}\)</span> and <span class="math inline">\(c_{i}\)</span> annihilates an electron in the <span class="math inline">\(i\)</span> -th at time <span class="math inline">\(t\)</span>. We have already introduced this causal Green's function in Eq. (24). The difference is the imaginary factor <span class="math inline">\(-i\)</span>, which Mattuck describes as "decorative" [34], and the fermionic creation and annihilation operators, expressed in a discrete basis. In this paper we consider atomic units in which we set <span class="math inline">\(\hbar=e=m=1\)</span>, such that the usual prefactor <span class="math inline">\(-i / \hbar\)</span> is simplified. In Eq. (25) we have the time-ordering operator, <span class="math display">\[
T\left[c_{i}(t) c_{j}^{\dagger}\left(t^{\prime}\right)\right]=\theta\left(t-t^{\prime}\right) c_{i}(t) c_{j}^{\dagger}\left(t^{\prime}\right)-\theta\left(t^{\prime}-t\right) c_{j}^{\dagger}\left(t^{\prime}\right) c_{i}(t)
\]</span> which guarantees causal orderings. This is due to the properties of the Heaviside function <span class="math inline">\(\theta(x)^{6}\)</span>. Please verify that in each term of Eq. (26), the fermionic operator that appears on the left always acts at time later than the right one. This rule is known as "later to the left". Since we are dealing with electron operators, we should recall that the operators satisfy the anti-commutations <span class="math display">\[
\text { relations }\left\{c_{i}, c_{j}\right\}=0,\left\{c_{i}^{\dagger}, c_{j}^{\dagger}\right\}=0 \text { and }\left\{c_{i}, c_{j}^{\dagger}\right\}=\delta_{i j},
\]</span> where the anti-commutator is defined as <span class="math inline">\(\{A, B\}=A B+\)</span> <span class="math inline">\(B A\)</span>, and the Kronecker function <span class="math inline">\(\delta_{i j}\)</span> assumes the values 0 if <span class="math inline">\(i \neq j\)</span>, and 1 if <span class="math inline">\(i=j\)</span>.</p>
<p>Besides the causal Green's function defined above, we introduce two other Green's functions from which many important physical quantities are more easily extracted. For example, for times <span class="math inline">\(t&gt;t^{\prime}\)</span> and <span class="math inline">\(t&lt;t^{\prime}\)</span>, the retarded and advanced Green's functions are defined as <span class="math display">\[
\begin{array}{l}
G_{i j}^{r}\left(t, t^{\prime}\right)=-i \theta\left(t-t^{\prime}\right)\left\langle\left\{c_{i}(t), c_{j}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle \\
G_{i j}^{a}\left(t, t^{\prime}\right)=-i \theta\left(t-t^{\prime}\right)\left\langle\left\{c_{i}(t), c_{j}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle .
\end{array}
\]</span> where <span class="math inline">\(G^{r}\)</span> is non-zero only for <span class="math inline">\(t&gt;t^{\prime}\)</span>, such that we can calculate the response of the system after it has been perturbed. This is why it is called retarded Green's function. The advanced Green's function is defined as the adjoint of the retarded Green's function, <span class="math inline">\(\left[G^{r}\right]^{\dagger}=G^{a}\)</span>. This means that, having determined one of them, we can immediately calculate the other.</p>
<p>It is important to note that the Green's functions carry information about the system excitations, since their time evolution is ruled by the Hamiltonian of the system. In the Heisenberg picture, operators evolve in time via Heisenberg equation, where the Hamiltonian is present. For an arbitrary operator <span class="math inline">\(\hat{O}\)</span>, it reads <span class="math display">\[
i \frac{d \hat{O}}{d t}=[\hat{O}, \hat{H}]+i \frac{\partial}{\partial t} \hat{O}(t)
\]</span> where the last term accounts for possible explicit time dependence of the operator.</p>
<h3 id="d.-spectral-representation">D. Spectral representation</h3>
<p>So far we have presented the Green's function in the time domain. But very often it is convenient to represent it in the energy domain. For example, when our system is at equilibrium or when the Hamiltonian is timeindependent <span class="math inline">\(^{7}\)</span>. For such cases the Green's function will depend only on time differences <span class="math inline">\(t-t^{\prime}\)</span> and we can perform a Fourier transform. To illustrate this, let us first consider the spectral representation in the special case of a free particle Hamiltonian, which can be written as <span class="math display">\[
H=\sum_{m} \varepsilon_{m} c_{m}^{\dagger} c_{m}
\]</span> where <span class="math inline">\(c_{m}^{\dagger}\left(c_{m}\right)\)</span> creates (annihilates) and electron in the <span class="math inline">\(m\)</span> -th single-particle eigenstate of the system with energy <span class="math inline">\(\varepsilon_{m} .\)</span> In the Heisenberg picture, using Eq. (30), the equations of motion of our operators are <span class="math display">\[
\begin{array}{l}
\frac{d c_{n}}{d t}=-i\left[c_{n}, H\right]=-i \varepsilon_{n} c_{n} \\
\frac{d c_{n}^{\dagger}}{d t}=-i\left[c_{n}^{\dagger}, H\right]=i \varepsilon_{n} c_{n}^{\dagger}
\end{array}
\]</span> Therefore, the creation and the annihilation operators evolve as <span class="math inline">\(c_{n}(t)=e^{-i \varepsilon_{n} t} c_{n}\)</span> and <span class="math inline">\(c_{n}^{\dagger}(t)=e^{i \varepsilon_{n} t} c_{n}^{\dagger}\)</span>. From these expressions, the retarded and advanced Green's functions of Eq. <span class="math inline">\((28)\)</span> and <span class="math inline">\((29)\)</span> for the free-particle case are simple functions of the time difference <span class="math inline">\(t-t^{\prime}:\)</span> <span class="math display">\[
\begin{array}{l}
G_{n n^{\prime}}^{r}\left(t-t^{\prime}\right)=-i \theta\left(t-t^{\prime}\right) e^{-i \varepsilon_{n}\left(t-t^{\prime}\right)} \delta_{n n^{\prime}} \\
G_{n n^{\prime}}^{a}\left(t-t^{\prime}\right)=i \theta\left(t^{\prime}-t\right) e^{i \varepsilon_{n}\left(t^{\prime}-t\right)} \delta_{n n^{\prime}}
\end{array}
\]</span> where we have used <span class="math inline">\(\left\langle\left\{c_{n}, c_{n^{\prime}}^{\dagger}\right\}\right\rangle=\delta_{n n^{\prime}}\)</span>. Note that the Green's function is diagonal in the energy basis, which does not happen in the general interacting case, where the time evolution of the single particle operator involves different states. Here we assumed that the particle is in an eigenstate of a noninteracting Hamiltonian.</p>
<p>To write the spectral representations of <span class="math inline">\((34)\)</span> and <span class="math inline">\((35)\)</span>, let us consider the integral representation of the Heaviside step function: <span class="math display">\[
\theta\left(t-t^{\prime}\right)=-\frac{1}{2 \pi i} \int_{-\infty}^{\infty} d \omega \frac{e^{-i \omega\left(t-t^{\prime}\right)}}{\omega+i \eta}
\]</span> where <span class="math inline">\(\eta \rightarrow 0^{+}\)</span> is a positive infinitesimal real number. Inserting this expression in (34), we obtain <span class="math display">\[
G_{n n}^{r}\left(t-t^{\prime}\right)=\frac{1}{2 \pi} \int_{-\infty}^{\infty} d \omega \frac{e^{-i\left(\omega+\varepsilon_{n}\right)\left(t-t^{\prime}\right)}}{\omega+i \eta}
\]</span> By performing a change of variables <span class="math inline">\(\omega+\varepsilon_{n} \rightarrow \omega\)</span>, we have <span class="math display">\[
G_{n n}^{r}\left(t-t^{\prime}\right)=\frac{1}{2 \pi} \int_{-\infty}^{\infty} d \omega \frac{e^{-i \omega\left(t-t^{\prime}\right)}}{\omega-\varepsilon_{n}+i \eta} .
\]</span> Since <span class="math inline">\(G_{n n}^{r}\left(t-t^{\prime}\right)\)</span> is the Fourier transform <span class="math inline">\(^{8}\)</span> of <span class="math inline">\(G^{r}(\omega)\)</span>, we can identify the latter in the integrand of Eq. (38), <span class="math display">\[
G_{n n}^{r}(\omega)=\frac{1}{\omega-\varepsilon_{n}+i \eta}
\]</span> Analogously, we obtain for the noninteracting advanced Green's function, <span class="math display">\[
G_{n n}^{a}(\omega)=\frac{1}{\omega-\varepsilon_{n}-i \eta} .
\]</span> The Fourier transforms of the retarded/advanced Green's functions have different analyticity properties. This is a consequence of causality, expressed in the step functions of Eq. (28) and (29). The retarded(advanced) Green's function is analytic in the upper(lower) half of the complex <span class="math inline">\(\omega\)</span> plane and has poles in the lower(upper) half plane, corresponding to the eigenenergies in this simplified example, and single-particle excitations in the more general case. Converting to a site basis, <span class="math inline">\(G_{i j}=\sum_{n}\langle i \mid n\rangle\langle n \mid j\rangle G_{n n}\)</span>, thus we obtain <span class="math display">\[
G_{i j}^{r / a}(\omega)=\sum_{n} \frac{\langle i \mid n\rangle\langle n \mid j\rangle}{\omega-\varepsilon_{n} \pm i \eta}
\]</span> There are many physical properties hidden in the Green's function. At this point we can extract at least two important properties of the retarded and advanced Greens functions:</p>
<ol type="1">
<li>For the noninteracting Hamiltonian, the poles of the Green's function correspond exactly to the eigenenergies. This can be immediately noticed since <span class="math inline">\(\varepsilon_{n}\)</span> was assumed to be the eigenenergy of the free particle system, governing the time evolution of the creation and annihilation operators. This property refers only to the simplified case of a noninteracting Hamiltonian.</li>
<li>The imaginary part <span class="math inline">\(^{9}\)</span> of the diagonal <span class="math inline">\((j=i)\)</span> retarded or advanced Green's function provides the local density of states of the system:</li>
</ol>
<p><span class="math display">\[
\rho_{i}(\omega)=\mp \frac{1}{\pi} \operatorname{Im}\left\{G_{i i}^{r, a}(\omega)\right\}
\]</span> Here we used the Cauchy relation.</p>
<p>To generalize property 1, let us consider the expansion of the operators in the complete basis of a generic Hamiltonian. It is possible to show that the poles of the retarded/advanced Green's function contain information about the spectrum of the single-particle excitations (i.e., a single electron excitation) of the system. To show this, let <span class="math inline">\(H\)</span> be the Hamiltonian of the interacting manybody system. The Schrödinger equation is <span class="math inline">\(H|n\rangle=\varepsilon_{n}|n\rangle\)</span>, where <span class="math inline">\(|n\rangle\)</span> and <span class="math inline">\(\varepsilon_{n}\)</span> are the many-body eigenstates and eigenenergies, respectively. Note that <span class="math inline">\(|n\rangle\)</span> forms a complete basis with closure relation <span class="math display">\[
\sum_{n}|n\rangle\langle n|=1
\]</span> Within the Heisenberg picture, a given operator <span class="math inline">\(A(t)\)</span> evolves from <span class="math inline">\(t^{\prime}\)</span> to <span class="math inline">\(t\)</span> as <span class="math inline">\(A(t)=e^{i H\left(t-t^{\prime}\right)} A\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}\)</span></p>
<p>If <span class="math inline">\(H\)</span> is time-independent, the evolution depends only on the difference <span class="math inline">\(t-t^{\prime} .\)</span> The Green's function (28) becomes <span class="math display">\[
\begin{aligned}
G_{i j}^{r}\left(t, t^{\prime}\right) &amp;=-i \theta\left(t-t^{\prime}\right)\left\langle\left\{e^{i H\left(t-t^{\prime}\right)} c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}, c_{j}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle \\
&amp;=-i \theta\left(t-t^{\prime}\right)\left\langle\left[e^{i H\left(t-t^{\prime}\right)} c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)} c_{j}^{\dagger}\left(t^{\prime}\right)+c_{j}^{\dagger}\left(t^{\prime}\right) e^{i H\left(t-t^{\prime}\right)} c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}\right]\right\rangle \\
&amp;=-i \theta\left(t-t^{\prime}\right) \sum_{m}\left\langle\left[e^{i H\left(t-t^{\prime}\right)} c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}|m\rangle\left\langle m\left|c_{j}^{\dagger}\left(t^{\prime}\right)+c_{j}^{\dagger}\left(t^{\prime}\right) e^{i H\left(t-t^{\prime}\right)}\right| m\right\rangle\langle m| c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}\right]\right\rangle \\
&amp;=-i \theta\left(t-t^{\prime}\right) \sum_{m}\left\langle\left[e^{-i \varepsilon_{m}\left(t-t^{\prime}\right)} e^{i H\left(t-t^{\prime}\right)} c_{i}\left(t^{\prime}\right)|m\rangle\left\langle m\left|c_{j}^{\dagger}\left(t^{\prime}\right)+e^{i \varepsilon_{m}\left(t-t^{\prime}\right)} c_{j}^{\dagger}\left(t^{\prime}\right)\right| m\right\rangle\langle m| c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}\right]\right\rangle \\
&amp;=-i \frac{1}{Z} \theta\left(t-t^{\prime}\right) \sum_{n m} e^{-\beta \varepsilon_{n}}\left[e^{-i \varepsilon_{m}\left(t-t^{\prime}\right)}\left\langle n\left|e^{i H\left(t-t^{\prime}\right)} c_{i}\left(t^{\prime}\right)\right| m\right\rangle\left\langle m\left|c_{j}^{\dagger}\left(t^{\prime}\right)\right| n\right\rangle+e^{i \varepsilon_{m}\left(t-t^{\prime}\right)}\left\langle n\left|c_{j}^{\dagger}\left(t^{\prime}\right)\right| m\right\rangle\left\langle m\left|c_{i}\left(t^{\prime}\right) e^{-i H\left(t-t^{\prime}\right)}\right| n\right\rangle\right] \\
&amp;=-i \frac{1}{Z} \theta\left(t-t^{\prime}\right) \sum_{n m} e^{-\beta \varepsilon_{n}}\left[e^{-i\left(\varepsilon_{m}-\varepsilon_{n}\right)\left(t-t^{\prime}\right)}\left\langle n\left|c_{i}\left(t^{\prime}\right)\right| m\right\rangle\left\langle m\left|c_{j}^{\dagger}\left(t^{\prime}\right)\right| n\right\rangle+e^{i\left(\varepsilon_{m}-\varepsilon_{n}\right)\left(t-t^{\prime}\right)}\left\langle n\left|c_{j}^{\dagger}\left(t^{\prime}\right)\right| m\right\rangle\left\langle m\left|c_{i}\left(t^{\prime}\right)\right| n\right\rangle\right]
\end{aligned}
\]</span> In the lines above we have performed the quantum statistical average <span class="math inline">\(\langle A\rangle=Z^{-1} \operatorname{Tr}\left[e^{-\beta H} A\right]\)</span>, where <span class="math inline">\(Z\)</span> is the partition function and <span class="math inline">\(\beta\)</span> is proportional to the inverse of the temperature. For the diagonal Green's function <span class="math inline">\(j=i\)</span> we obtain, <span class="math display">\[
\begin{aligned}
G_{i i}^{r}\left(t, t^{\prime}\right) &amp;=-i \frac{1}{Z} \theta\left(t-t^{\prime}\right) \sum_{n m} e^{-\beta \varepsilon_{n}}\left[e^{-i\left(\varepsilon_{m}-\varepsilon_{n}\right)\left(t-t^{\prime}\right)}\left|\left\langle n\left|c_{i}\left(t^{\prime}\right)\right| m\right\rangle\right|^{2}+e^{i\left(\varepsilon_{m}-\varepsilon_{n}\right)\left(t-t^{\prime}\right)}\left|\left\langle m\left|c_{j}^{\dagger}\left(t^{\prime}\right)\right| n\right\rangle\right|^{2}\right] \\
&amp;=-i \frac{1}{Z} \theta\left(t-t^{\prime}\right) \sum_{n m}\left[e^{-\beta \varepsilon_{n}} e^{-i\left(\varepsilon_{m}-\varepsilon_{n}\right)\left(t-t^{\prime}\right)}\left|\left\langle n\left|c_{i}\left(t^{\prime}\right)\right| m\right\rangle\right|^{2}+e^{-\beta \varepsilon_{m}} e^{i\left(\varepsilon_{n}-\varepsilon_{m}\right)\left(t-t^{\prime}\right)}\left|\left\langle n\left|c_{j}^{\dagger}\left(t^{\prime}\right)\right| m\right\rangle\right|^{2}\right] \\
&amp;=-i \frac{1}{Z} \theta\left(t-t^{\prime}\right) \sum_{n m}\left|\left\langle n\left|c_{i}\left(t^{\prime}\right)\right| m\right\rangle\right|^{2} e^{-i\left(\varepsilon_{m}-\varepsilon_{n}\right)\left(t-t^{\prime}\right)}\left(e^{-\beta \varepsilon_{n}}+e^{-\beta \varepsilon_{m}}\right)
\end{aligned}
\]</span> We can now set <span class="math inline">\(t^{\prime}=0\)</span> and take the Fourier transform, as we did for the noninteracting case: <span class="math display">\[
G_{i i}^{r}(\omega)=\frac{1}{Z} \sum_{n m} \frac{\left|\left\langle n\left|c_{i}(0)\right| m\right\rangle\right|^{2}}{\omega-\left(\varepsilon_{m}-\varepsilon_{n}\right)+i \eta}\left(e^{-\beta \varepsilon_{n}}+e^{-\beta \varepsilon_{m}}\right)
\]</span> This expression is known as the Lehmann or spectral representation of the Green's functions [21]. Following property number 2 of the retarded/advanced Green's functions shown above, from the diagonal Green's function we can calculate the local density of states: <span class="math display">\[
\begin{aligned}
\rho_{i}(\omega)=&amp; \frac{1}{Z} \sum_{n m}\left|\left\langle n\left|c_{i}(0)\right| m\right\rangle\right|^{2}\left(e^{-\beta \varepsilon_{n}}+e^{-\beta \varepsilon_{m}}\right) \\
&amp; \times \delta\left[\omega-\left(\varepsilon_{m}-\varepsilon_{n}\right)\right]
\end{aligned}
\]</span> It is possible to show that Eq. (44) is recovered when considering a noninteracting Hamiltonian. In this case the Hamiltonian is separable, and the manyparticle eigenstates are a antisymmetrized product of single-particle states. The expectation value in (50) will connect states <span class="math inline">\(m\)</span> that have one additional electron in the site <span class="math inline">\(i\)</span> compared to state <span class="math inline">\(n\)</span>, thus <span class="math inline">\(E_{m}=E_{n}+\varepsilon_{i}\)</span>, where <span class="math inline">\(\varepsilon_{i}\)</span> is the energy of an additional bare electron at site <span class="math inline">\(i\)</span>. Careful manipulation of <span class="math inline">\((50)\)</span> and the partition function <span class="math inline">\(Z\)</span> results in a local density of states independent of the temperature, with poles at single-particle energies <span class="math inline">\(\varepsilon_{i}\)</span>. Among the many interesting properties of the interacting Green's function (48) we can also emphasize that: 1. The poles of the interacting Green's function are exactly at the many-body excitations <span class="math inline">\(\varepsilon_{m}-\varepsilon_{n}\)</span> of the system; 2. In contrast with the noninteracting case, both the Green's function (48) and the local density of states depend on the temperature. This is characteristic of interacting systems.</p>
<p>Although we have presented a more robust formalism, in the examples treated in this article, we will deal only with noninteracting Hamiltonians, neglecting Coulomb interactions, and our local density of states will map the spectra of each Hamiltonian.</p>
<h3 id="the-equation-of-motion-technique">THE EQUATION OF MOTION TECHNIQUE</h3>
<p>One way of obtaining the Green's function is to determine its time evolution via equation of motion (EOM) technique. Using the Heaviside function <span class="math inline">\(\theta\left(t-t^{\prime}\right)\)</span> and the Heisenberg equation of motion for the operator <span class="math inline">\(c_{i}(t)\)</span>, we derive the retarded Green's function (28) with respect to time: <span class="math display">\[
\begin{aligned}
i \partial_{t} G_{i j}^{r}\left(t, t^{\prime}\right)=&amp; i(-i) \partial_{t} \theta\left(t-t^{\prime}\right)\left\langle\left\{c_{i}(t), c_{j}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle \\
&amp;-i \theta\left(t-t^{\prime}\right)\left\langle\left\{i \dot{c}_{i}(t), c_{j}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle \\
=&amp; \delta\left(t-t^{\prime}\right) \delta_{i j} \\
&amp;-i \theta\left(t-t^{\prime}\right)\left\langle\left\{\left[c_{i}, H\right](t), c_{j}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle .
\end{aligned}
\]</span> In the last line, on the right-hand side (rhs) of Eq. (51), there is one propagator that yet needs to be determined, which depends on the commutator of the operator <span class="math inline">\(c_{i}\)</span> with the Hamiltonian. We first note that this result is not restricted to <span class="math inline">\(G^{r}\)</span> but rather, is general: the equation of motion will couple the original Green's function to a new one. In addition, its dependence with the Hamiltonian will influence the dynamics.</p>
<p>From now on, we shall use more frequently the spectral representation for the Green's functions. Therefore, we present a simplified notation for the retarded Green's function in the energy domain, adapted from Zubarev <span class="math inline">\([35]\)</span>, <span class="math display">\[
G_{i j}^{r}(\omega)=\left\langle\left\langle c_{i} ; c_{j}^{\dagger}\right\rangle\right\rangle
\]</span> Performing the Fourier transform defined in Eq. (40) on Eq. (51), we will obtain an factor <span class="math inline">\(i \omega\)</span> on the left coming from the time derivative. Since the Fourier transform of the <span class="math inline">\(\delta\)</span> -function is the unity, <span class="math inline">\({ }^{11}\)</span> the spectral representation of the equation of motion (51) acquires the form <span class="math display">\[
\omega G_{i j}^{r}(\omega)=\delta_{i j}+\left\langle\left\langle\left[c_{i}, H\right] ; c_{j}^{\dagger}\right\rangle\right\rangle .
\]</span> We stress that the presence of the commutator on the rhs of Eqs. (51) and (54) tells us that the dynamics of the Green's function is fully determined by the Hamiltonian of the system.</p>
<h3 id="example-the-non-interacting-linear-chain">example: the non-interacting linear chain</h3>
<p>Let us consider a linear chain described by the noninteracting Hamiltonian containing a single orbital (en-ergy ) per site and a kinetic term that connects all nearestneighbor sites via a hopping parameter <span class="math inline">\(t\)</span> <span class="math display">\[
\begin{aligned}
H &amp;=\sum_{l} \varepsilon_{l} c_{l}^{\dagger} c_{l}+\sum_{l}\left(t_{l+1, l} c_{l}^{\dagger} c_{l+1}+t_{l, l+1} c_{l+1}^{\dagger} c_{l}\right) \\
&amp;=h_{p o t}+h_{c i n}
\end{aligned}
\]</span> The first sum in Eq. (55) corresponds to a local external potential that is diagonal in a base of sites. The second term corresponds to the kinetic energy, describing the destruction of a particle in the site <span class="math inline">\(l+1\)</span> and creation of another particle in the site <span class="math inline">\(l\)</span> with probability amplitude <span class="math inline">\(t_{l+1, l} .\)</span> The third term describes the reverse process. The Hamiltonian is hermitian as it represents an observable, namely, the total energy of the system. To assure <span class="math display">\[
\text { hermicity, } t_{l, l+1}^{*}=t_{l+1, l}
\]</span> To calculate the commutator <span class="math inline">\(\left[c_{i}, H\right]\)</span> we simply use commutation rules <span class="math inline">\(^{12}\)</span> listed in Sec. ID, from which we obtain <span class="math display">\[
\left[c_{i}, h_{p o t}\right]=\sum_{l} \varepsilon_{l}\left[c_{i}, c_{l}^{\dagger} c_{l}\right]=\sum_{l} \varepsilon_{l} \delta_{i l} c_{l}=\varepsilon_{i} c_{i}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\left[c_{i}, h_{c i n}\right] &amp;=\sum_{l}\left\{t_{l+1, l}\left[c_{i}, c_{l}^{\dagger} c_{l+1}\right]+t_{l, l+1}\left[c_{i}, c_{l+1}^{\dagger} c_{l}\right]\right\} \\
&amp;=\sum_{l}\left(t_{l+1, l} \delta_{i, l} c_{l+1}+t_{l, l+1} \delta_{i, l+1} c_{l}\right) \\
&amp;=\sum_{l}\left(t_{i+1, i} c_{i+1}+t_{i-1, i} c_{i-1}\right) \\
&amp;=\sum_{j=\pm 1} t_{i+j, i} c_{i+j} .
\end{aligned}
\]</span> We now introduce these commutators into the equations of motion (EOMs) (51) or (54). In the energy do<span class="math inline">\(\operatorname{main}^{13}\)</span>, see Eq. (54), we have <span class="math display">\[
\left(\omega-\varepsilon_{i}+i \eta\right) G_{i j}^{r}(\omega)=\delta_{i j}+\sum_{k=\pm 1} t_{i+k, i} G_{i+k, j}^{r}(\omega)
\]</span> where the propagator <span class="math inline">\(G_{i j}^{r}(\omega)\)</span> couples to other propagators through first neighbor hopping. In this work we will consider only Hamiltonians that couple nearest neighbors in different geometries. As the reader becomes familiar with the technique, its operation and usage become clearer.</p>
<p>It is important to emphasize that the local potential and the kinetic energy are single particle operators and do not produce many-particle Green's functions. In a more general case where the Hamiltonian has two-particle operators, i.e., a product of four operators, it will generate multi-particle Green's functions. The resulting system of coupled Green's functions is a priori, infinite, but for practical purposes it is truncated at some level. Despite their importance in condensed matter physics, many-particle Hamiltonians are outside the scope of this work, but can be found elsewhere, e.g. Refs.[21] and [36] and references therein. In the example treated here, Hamiltonians are noninteracting and we can find exact solutions (at least numerically) for the Green's functions. Even for noninteracting systems, few examples grant an analytical expression for the Green's function. For the others we can at least obtain exact numerical solutions. Indeed, numerical solutions are the main motivation of this work.</p>
<h3 id="b.-two-site-chain-the-hydrogen-molecule">B. Two-site chain: the hydrogen molecule</h3>
<p>The simplest finite lattice has only two sites, see Fig. 1(a). Before deriving an exact expression for the Green's functions of this system, let us review its relevance in quantum chemistry as a prototype of the molecular bond between two hydrogen nuclei. In this model, each atom has its <span class="math inline">\(s\)</span> -type orbital localized around its <span class="math inline">\(H\)</span> nucleus with energy <span class="math inline">\(\varepsilon_{0}\)</span>, shown in Fig. 1(b). The proximity of the two atoms allows for the hybridization of their individual orbitals with overlap matrix element (hopping) t. This coupled system has two solutions, two molecular orbitals with even and odd symmetry with respect to spatial inversion, <span class="math inline">\({ }^{14}\)</span> known as bonding and anti-bonding states. They have energies <span class="math inline">\(\varepsilon_{0} \mp|t|\)</span>, illustrated in the energy diagram of Fig. <span class="math inline">\(1( c )\)</span>.</p>
<p>For the present case, with <span class="math inline">\(N=2\)</span>, the Hamiltonian (55) reads <span class="math display">\[
H=\varepsilon_{0}\left(n_{1}+n_{2}\right)+t c_{2}^{\dagger} c_{1}+t^{*} c_{1}^{\dagger} c_{2}
\]</span> where we define the local energy <span class="math inline">\(\varepsilon_{0}\)</span>, the number operator <span class="math inline">\(n_{i}=c_{i}^{\dagger} c_{i}\)</span> and the hopping matrix element <span class="math inline">\(t_{21}=t\)</span>. In this problem, we can distinguish the Hamiltonian for the two isolated sites, <span class="math inline">\(h _{0}\)</span>, and a perturbation (inter-site coupling) <span class="math inline">\(V\)</span>. This perturbative perspective allows us to write a Dyson equation for the Green's function of the system, as we will develop below. The matrix representing the Hamiltonian <span class="math inline">\((60)\)</span> on the local orbitals basis <span class="math inline">\(\{1,2\}\)</span> acquires the form <span class="math display">\[
H = h _{0}+ V =\left(\begin{array}{cc}
\varepsilon_{0} &amp; 0 \\
0 &amp; \varepsilon_{0}
\end{array}\right)+\left(\begin{array}{cc}
0 &amp; t^{*} \\
t &amp; 0
\end{array}\right)
\]</span> The energies of the molecular orbitals <span class="math inline">\(\varepsilon_{0} \mp|t|\)</span> are easily obtained by diagonalizing the Hamiltonian above.</p>
<p>Returning to the explicit calculation of the Green's functions, we see that the local Green's function for the first site, <span class="math inline">\(G_{11}^{r}\left(t, t^{\prime}\right)=-i \theta\left(t-t^{\prime}\right)\left\langle\left\{c_{1}(t), c_{1}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle\)</span> is coupled to the non-local Green's function (propagator) <span class="math inline">\(G_{21}^{r}\left(t, t^{\prime}\right)=-i \theta\left(t-t^{\prime}\right)\left\langle\left\{c_{2}(t), c_{1}^{\dagger}\left(t^{\prime}\right)\right\}\right\rangle\)</span>, introduced by the commutators indicated in Eqs. (51) and (59). In time domain we obtain the following equations of motion <span class="math inline">\(( EOMs )\)</span>, <span class="math display">\[
\begin{array}{l}
\left(i \partial_{t}-\varepsilon_{0}\right) G_{11}^{r}\left(t, t^{\prime}\right)=\delta\left(t-t^{\prime}\right)+t G_{21}^{r}\left(t, t^{\prime}\right) \\
\left(i \partial_{t}-\varepsilon_{0}\right) G_{21}^{r}\left(t, t^{\prime}\right)=t^{*} G_{11}^{r}\left(t, t^{\prime}\right)
\end{array}
\]</span> while in energy domain we have, <span class="math display">\[
\begin{array}{l}
\left(\omega-\varepsilon_{0}+i \eta\right) G_{11}^{r}(\omega)=1+t G_{21}^{r}(\omega) \\
\left(\omega-\varepsilon_{0}+i \eta\right) G_{21}^{r}(\omega)=t^{*} G_{11}^{r}(\omega)
\end{array}
\]</span> From the equations above we see that is useful to introduce the undressed local Green's functions for the isolated sites (that can be obtained by setting <span class="math inline">\(t=0\)</span> in the equations above), <span class="math display">\[
g^{r}(\omega)=\frac{1}{\omega-\varepsilon_{0}+i \eta}=g_{1}^{r}(\omega)=g_{2}^{r}(\omega)
\]</span> where we define the lowercase <span class="math inline">\(g\)</span> referring to the Green's function of an isolated site. This function, which we name undressed Green's function, is diagonal on the isolated site basis, similarly to the unperturbed Hamiltonian. For the hydrogen molecule [Fig. $1( a )]$, the dressed Green's function exhibits non-diagonal terms due to the couplings. In matrix form, the undressed and dressed Green's functions read <span class="math display">\[
g ^{r}=\left(\begin{array}{cc}
g_{1}^{r} &amp; 0 \\
0 &amp; g_{2}^{r}
\end{array}\right) \quad \text { and } \quad G ^{r}=\left(\begin{array}{ll}
G_{11}^{r} &amp; G_{12}^{r} \\
G_{21}^{r} &amp; G_{22}^{r}
\end{array}\right),
\]</span> where by inversion symmetry around the center of the mass of the molecule, we can write <span class="math inline">\(G_{22}^{r}(\omega)=G_{11}^{r}(\omega)\)</span>. In terms of the undressed Green's function (66), we obtain the coupled system of equations <span class="math display">\[
\begin{array}{l}
G_{11}(\omega)=g^{r}(\omega)+g^{r}(\omega) t G_{21}^{r}(\omega) \\
G_{21}(\omega)=g^{r}(\omega) t^{*} G_{11}^{r}(\omega)
\end{array}
\]</span></p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Condensed-matter-Physics/">Condensed matter Physics</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Green-Function/">Green Function</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2021/05/07/CMP_14_Green02/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">格林函数概览</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2021/05/06/CMP_15_Transport99_DR_02/">
                        <span class="hidden-mobile">纳米尺度下量子输运理论-2</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>


      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 1,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "格林函数 数值模拟&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js" ></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  
















</body>
</html>
