<!DOCTYPE html>
<html lang="en">





<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="JPZhuang">
  <meta name="keywords" content="">
  <title>纳米尺度下量子输运理论-2 - JPZ</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Physics</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/tag-bg.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2021-05-06 23:01">
      May 6, 2021 pm
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      9.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      191
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>[TOC]</p>
<h4 id="reference">Reference:</h4>
<ol type="1">
<li>《Theory of Quantum Transport at Nanoscale - An Introduction》 Dmitry A. Ryndyk</li>
</ol>
<style>
<p>/* 设置整个页面的字体 */ html, body, .markdown-body { font-family: KaiTi,"Microsoft YaHei",Georgia, sans, serif; font-size: 15px; }</p>
<style>
  /* 设置整个页面的字体 */
  html, body, .markdown-body {
    font-family: KaiTi,"Microsoft YaHei",Georgia, sans, serif;
    font-size: 15px;
  }
</style>
<p>outline</p>
<p>[TOC]</p>
<h2 id="概览">概览</h2>
<h2 id="green-functions">Green Functions</h2>
<p>In this chapter we formulate the Landauer approach using the Green function (GF) formalism. It is a mathematically elegant and numerically effective method to describe quantum scattering and transport. In Sect.3.1 we consider definitions and basic properties of retarded (and advanced) Green functions and discuss the <strong>relations</strong> between</p>
<ol type="1">
<li>Schrödinger equation,</li>
<li>wave functions,</li>
<li>GFs,</li>
<li>and the scattering matrix.</li>
</ol>
<p>Atomic and molecular scale systems are naturally described by discrete-level models, based, for example, on atomic orbitals and molecular orbitals. For continuous systems with complex geometries and/or disorder, <strong>discretization is a first step towards numerical computational methods</strong>.</p>
<ol type="1">
<li>Starting from discrete-level representations we come to matrix Green functions, being the main theoretical tool at nanoscale. On the other hand, electrodes are assumed to be infinitely large and have continuous energy spectrum.</li>
<li>To include the electrode effects systematically, it is reasonable to start from the discrete-level representation for the whole system. It can be made with a help of the tight-binding (TB) model, which was proposed to describe quantum systems in which the localized electronic states play essential role, it is widely used as an alternative to the plane wave description of electrons in solids, and also as a method to calculate the electronic structure of molecules in quantum chemistry.</li>
<li>All effects of the equilibrium electrodes can be included into the matrix equations for the central region through the self-energies.</li>
</ol>
<p>框架</p>
<ol type="1">
<li>We consider the matrix formalism in general in Sect. <span class="math inline">\(3.2\)</span></li>
<li>and the recursive method for long or complex systems in Sect. <span class="math inline">\(3.3\)</span>.</li>
<li>Finally, calculation of self-energies for semi-infinite electrodes requires some special methods, which are considered in Sect. <span class="math inline">\(3.4\)</span>.</li>
</ol>
<p>Note that Green functions introduced in this section are single-particle GFs in non-interacting systems. The extension of the technique to many-body systems with interactions will be considered in Chap. 7 .</p>
<h2 id="green-functions-and-the-scattering-problem">3.1 Green Functions and the Scattering Problem</h2>
<h3 id="retarded-and-advanced-green-functions">3.1.1 Retarded and Advanced Green Functions</h3>
<p>Green functions are known to be a convenient tool to solve linear differential equations, including the Schrödinger equation in quantum mechanics. Being completely <strong>equivalent</strong> to the Landauer scattering approach,</p>
<p>the GF technique has the <strong>advantage</strong> that</p>
<ol type="1">
<li>it calculates relevant transport quantities (e.g. transmission function) using effective numerical techniques.</li>
<li>Besides, the Green function formalism is well adopted for atomic and molecular discrete-level systems and can be easily extended to include inelastic and many-body effects.</li>
</ol>
<p>First of all, we give the formal general definition and the basic properties of retarded and advanced Green functions (also called propagators). Let us start from the time-dependent Schrödinger equation <span class="math display">\[
i \hbar \frac{\partial|\Psi(t)\rangle}{\partial t}=\hat{H}|\Psi(t)\rangle
\]</span> In this section we use general Dirac notations <span class="math inline">\(|\ldots\rangle\)</span> for quantum states and general operator notations <span class="math inline">\(\hat{.} .\)</span> to show that the representation is arbitrary (coordinate and matrix representations considered below are special cases).</p>
<p>The solution of this equation at time <span class="math inline">\(t\)</span> can be written in terms of the solution at time <span class="math inline">\(t^{\prime}:\)</span> <span class="math display">\[
|\Psi(t)\rangle=\hat{U}\left(t, t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> where <span class="math inline">\(\hat{U}\left(t, t^{\prime}\right)\)</span> is called the time-evolution operator.</p>
<p>Below we consider only the case of a time-independent Hermitian Hamiltonian <span class="math inline">\(\hat{H}\)</span>, so that the eigenstates <span class="math inline">\(\left|\Psi_{n}(t)\right\rangle=e^{-i E_{n} t / \hbar}\left|\Psi_{n}\right\rangle\)</span> with energies <span class="math inline">\(E_{n}\)</span> are found from the stationary Schrödinger equation <span class="math display">\[
\hat{H}\left|\Psi_{n}\right\rangle=E_{n}\left|\Psi_{n}\right\rangle
\]</span> The eigenfunctions <span class="math inline">\(\left|\Psi_{n}\right\rangle\)</span> are orthogonal and normalized, for discrete energy levels : <span class="math display">\[
\left\langle\Psi_{n} \mid \Psi_{m}\right\rangle=\delta_{n m}
\]</span> and form a complete set of states ( <span class="math inline">\(\hat{I}\)</span> is the unity operator) <span class="math display">\[
\sum_{n}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|=\hat{I}
\]</span> For continuous spectrum the orthogonality condition is <span class="math display">\[
\left\langle\Psi_{k} \mid \Psi_{k^{\prime}}\right\rangle=\delta\left(k-k^{\prime}\right),
\]</span> and the completeness in the case of combined (discrete and continuous) spectrum is written explicitly as <span class="math display">\[
\sum_{n}\left|\Psi_{n}\right\rangle \langle\Psi_{n} |+\int d k | \Psi_{k} \rangle\left\langle\Psi_{k}\right|=\hat{I} .
\]</span> The time-evolution operator for a time-independent Hamiltonian can be written as <span class="math display">\[
\hat{U}\left(t-t^{\prime}\right)=e^{-i\left(t-t^{\prime}\right) \hat{H} / \hbar}
\]</span> This formal solution is difficult to use directly in most cases, but one can obtain the useful eigenstate representation from it. From the identity <span class="math inline">\(\hat{U}=\hat{U} \hat{I}\)</span> and <span class="math inline">\((3.3),(3.5)\)</span>, (3.8) it follows that 2 <span class="math display">\[
\hat{U}\left(t-t^{\prime}\right)=\sum_{n} e^{-\frac{i}{\hbar} E_{n}\left(t-t^{\prime}\right)}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right| \text { , }
\]</span> which demonstrates the superposition principle. The wave function at time <span class="math inline">\(t\)</span> is <span class="math display">\[
|\Psi(t)\rangle=\hat{U}\left(t, t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle=\sum_{n} e^{-\frac{i}{\hbar} E_{n}\left(t-t^{\prime}\right)}\left\langle\Psi_{n} \mid \Psi\left(t^{\prime}\right)\right\rangle\left|\Psi_{n}\right\rangle
\]</span> where <span class="math inline">\(\left\langle\Psi_{n} \mid \Psi\left(t^{\prime}\right)\right\rangle\)</span> are the coefficients of the expansion of the initial function <span class="math inline">\(\left|\Psi\left(t^{\prime}\right)\right\rangle\)</span> in the basis of eigenstates.</p>
<p>It is equivalent and more convenient to introduce two Green operators, called also propagators,</p>
<ol type="1">
<li>retarded <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)\)</span></li>
<li>advanced <span class="math inline">\(\hat{G}^{A}\left(t, t^{\prime}\right)\)</span> :</li>
</ol>
<p><span class="math display">\[
\begin{aligned}
\hat{G}^{R}\left(t, t^{\prime}\right)=&amp;-\frac{i}{\hbar} \theta\left(t-t^{\prime}\right) \hat{U}\left(t, t^{\prime}\right)=-\frac{i}{\hbar} \theta\left(t-t^{\prime}\right) e^{-i\left(t-t^{\prime}\right) \hat{H} / \hbar} \\
\hat{G}^{A}\left(t, t^{\prime}\right)=&amp;\frac{i}{\hbar} \theta\left(t^{\prime}-t\right) \hat{U}\left(t, t^{\prime}\right)=\frac{i}{\hbar} \theta\left(t^{\prime}-t\right) e^{-i\left(t-t^{\prime}\right) \hat{H} / \hbar}
\end{aligned}
\]</span> so that at <span class="math inline">\(t&gt;t^{\prime}\)</span> one has <span class="math display">\[
|\Psi(t)\rangle=i \hbar \hat{G}^{R}\left(t-t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> while at <span class="math inline">\(t&lt;t^{\prime}\)</span> it follows <span class="math display">\[
|\Psi(t)\rangle=-i \hbar \hat{G}^{A}\left(t-t^{\prime}\right)\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span></p>
<p>From the definition one can see that</p>
<ul>
<li><span class="math inline">\(G^{R}\left(t-t^{\prime}\right)=0\)</span> at <span class="math inline">\(t&lt;t^{\prime},\)</span></li>
<li>$ G<sup>{A}(t-t</sup>{})=0$ at <span class="math inline">\(t^{\prime}&lt;t\)</span>,</li>
</ul>
<p><span class="math display">\[
\hat{G}^{A}\left(t, t^{\prime}\right)=\hat{G}^{R \dagger}\left(t^{\prime}, t\right)
\]</span> We can conclude that</p>
<ul>
<li>retarded functions describe propagation into future,</li>
<li>while advanced into past.</li>
</ul>
<p>Actually retarded and advanced propagators are related because of the <strong>time-symmetry of quantum mechanics</strong> (we neglect here any dissipation). The operators <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)\)</span> at <span class="math inline">\(t \geqslant t^{\prime}\)</span> and <span class="math inline">\(\hat{G}^{A}\left(t, t^{\prime}\right)\)</span> at <span class="math inline">\(t \leqslant t^{\prime}\)</span> are the solutions of the equation <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}\right] \hat{G}^{R(A)}\left(t, t^{\prime}\right)=\hat{I} \delta\left(t-t^{\prime}\right)
\]</span> with the boundary conditions <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)=0\)</span> at <span class="math inline">\(t&lt;t^{\prime}, \hat{G}^{A}\left(t, t^{\prime}\right)=0\)</span> at <span class="math inline">\(t&gt;t^{\prime}\)</span>. Indeed, at <span class="math inline">\(t&gt;t^{\prime}\)</span> (3.13) satisfies the Schrödinger equation (3.1) due to (3.16). And integrating (3.16) from <span class="math inline">\(t=t^{\prime}-\eta\)</span> to <span class="math inline">\(t=t^{\prime}+\eta\)</span>, where <span class="math inline">\(\eta\)</span> is an infinitesimally small positive number <span class="math inline">\(\eta=0^{+}\)</span>, one gets <span class="math display">\[
\hat{G}^{R}\left(t+\eta, t^{\prime}\right)=\frac{1}{i \hbar} \hat{I},
\]</span> giving correct boundary condition at <span class="math inline">\(t=t^{\prime} .\)</span> Thus, if we know the retarded Green operator <span class="math inline">\(\hat{G}^{R}\left(t, t^{\prime}\right)\)</span>, we can find the time-dependent wave function at any initial condition (and make many other useful things, as we will see below).</p>
<p>For a time-independent Hamiltonian the Green function is a function of the time difference <span class="math inline">\(\tau=t-t^{\prime}\)</span>, and one can consider the Fourier transform <span class="math display">\[
\hat{G}^{R(A)}(E)=\int_{-\infty}^{\infty} \hat{G}^{R(A)}(\tau) e^{i E \tau / \hbar} d \tau
\]</span> This transform, however, can not be performed in all cases, because <span class="math inline">\(G^{R(A)}(\tau)\)</span> includes oscillating terms <span class="math inline">\(e^{-\frac{i}{\hbar} E_{n} \tau} .\)</span> To avoid this problem we define the retarded Fourier transform <span class="math display">\[
\hat{G}^{R}(E)=\lim _{\eta \rightarrow 0^{+}} \int_{-\infty}^{\infty} \hat{G}^{R}(\tau) e^{i(E+i \eta) \tau / \hbar} d \tau
\]</span> and the advanced one <span class="math display">\[
\hat{G}^{A}(E)=\lim _{\eta \rightarrow 0^{+}} \int_{-\infty}^{\infty} \hat{G}^{A}(\tau) e^{i(E-i \eta) \tau / \hbar} d \tau
\]</span> where the limit <span class="math inline">\(\eta \rightarrow 0\)</span> is assumed in the end of calculation. With this addition the integrals are convergent. This definition is equivalent to the definition of a retarded (advanced) function as a function of complex energy variable at the upper (lower) part of the complex plain.</p>
<p>Applying this transform to (3.16), we get the equation for the retarded Green <span class="math display">\[
\text { operator } \hat{G}^{R}(E)
\]</span> Or <span class="math display">\[
\hat{G}^{R}(E)=[(E+i \eta) \hat{I}-\hat{H}]^{-1}
\]</span> The advanced operator <span class="math inline">\(\hat{G}^{A}(E)\)</span> is related to the retarded one through <span class="math display">\[
\hat{G}^{A}(E)=\hat{G}^{R \dagger}(E)
\]</span> It is possible to represent the Green function in the basis of the eigenstates <span class="math inline">\(\left|\Psi_{n}\right\rangle .\)</span> Using the completeness property <span class="math inline">\(\sum_{n}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|=1\)</span>, we obtain <span class="math display">\[
\begin{aligned}
\hat{G}^{R}(E)=&amp;\frac{1}{(E+i \eta) \hat{I}-\hat{H}} \sum_{n}\left|\Psi_{n}\right\rangle \langle\Psi_{n} |\\=&amp;\sum_{n} \frac{1}{(E+i \eta) \hat{I}-\hat{H}} | \Psi_{n} \rangle \langle\Psi_{n} |
\end{aligned}
\]</span> if we expand now <span class="math inline">\([(E+i \eta) \hat{I}-\hat{H}]^{-1}\)</span> into a power series and use <span class="math inline">\(\hat{H} \Psi_{n}=E_{n} \Psi_{n}\)</span>, we obtain the eigenstate expansion <span class="math display">\[
\hat{G}^{R}(E)=\sum_{n} \frac{\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|}{E-E_{n}+i \eta}
\]</span> Note, that if we apply the ordinary inverse Fourier transform to <span class="math inline">\(\hat{G}^{R}(E)\)</span>, we automatically obtain the retarded function <span class="math display">\[
\hat{G}^{R}(\tau)=\int_{-\infty}^{\infty} \hat{G}^{R}(E) e^{-i E \tau / \hbar} \frac{d E}{2 \pi \hbar}=-\frac{i}{\hbar} \theta(\tau) \sum_{n} e^{-\frac{i}{\hbar} E_{n} \tau}\left|\Psi_{n}\right\rangle\left\langle\Psi_{n}\right|
\]</span> Indeed, a simple pole in the complex <span class="math inline">\(E\)</span> plain is at <span class="math inline">\(E=E_{n}-i \eta\)</span>, the residue in this point determines the integral at <span class="math inline">\(\tau&gt;0\)</span> when the integration contour is closed through the lower half-plane, while at <span class="math inline">\(\tau&lt;0\)</span> the integration should be closed through the upper half-plane and the integral is zero.</p>
<h3 id="green-functions-in-the-coordinate-representation">3.1.2 Green Functions in the Coordinate Representation</h3>
<p>The formalism of retarded Green functions is quite general and can be applied to quantum systems in an arbitrary representation. Below in this section we consider the scattering problem in the coordinate representation for the wave function <span class="math inline">\(|\Psi(t)\rangle \equiv \Psi( r , t) .\)</span> The coordinate representation can be obtained from the general equations of the previous section, if one uses the position states <span class="math inline">\(| r \rangle(\)</span> the eigenvectors of the position operator) as a basis. The orthonormality conditions are <span class="math display">\[
\begin{array}{c}
\left\langle r \mid r ^{\prime}\right\rangle=\delta\left( r - r ^{\prime}\right) \\
\int d r | r \rangle\langle r |=1
\end{array}
\]</span> The scalar product is defined as <span class="math inline">\(\langle\Phi \mid \Psi\rangle=\int \Phi^{*}( r ) \Psi( r ) d r\)</span>, the unity operator is <span class="math inline">\(\hat{I}=\delta\left( r - r ^{\prime}\right)\)</span></p>
<p>The following transition rules relate the Dirac states and operators with the states and operators in the ordinary coordinate representation (time or energy variable is omitted): <span class="math display">\[
\Psi( r )=\langle r \mid \Psi\rangle, \quad \Psi^{*}( r )=\langle\Psi \mid r \rangle
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\delta\left( r - r ^{\prime}\right) \hat{H}( r )=&amp; \langle r |\hat{H}| r ^{\prime} \rangle \\
G^{R}\left( r , r ^{\prime}\right)=&amp; \langle r  |\hat{G}^{R} | r ^{\prime} \rangle \\
\sum_{n} \Psi_{n}( r ) \Psi_{n}^{*}\left( r ^{\prime}\right)=&amp;\delta\left( r - r ^{\prime}\right)
\end{aligned}
\]</span> Applying these rules to (3.13), we obtain <span class="math display">\[
\Psi( r , t)=i \hbar \int d r ^{\prime} G^{R}\left( r , t, r ^{\prime}, t^{\prime}\right) \Psi\left( r ^{\prime}, t^{\prime}\right)
\]</span> where <span class="math inline">\(G^{R}\left( r , t, r ^{\prime}, t^{\prime}\right)\)</span> is the retarded Green function, to be defined from the equation <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}( r )\right] G^{R}\left( r , t, r ^{\prime}, t^{\prime}\right)=\delta\left( r - r ^{\prime}\right) \delta\left(t-t^{\prime}\right)
\]</span> where <span class="math inline">\(\hat{H}( r )\)</span> is the single-particle Hamiltonian <span class="math display">\[
\hat{H}( r )=-\frac{\hbar^{2}}{2 m} \nabla^{2}+V( r )
\]</span> The equation (3.34) is obtained from the operator equation (3.16), if one takes the matrix element <span class="math inline">\(\left\langle r |\ldots| r ^{\prime}\right\rangle\)</span> of the left and right parts of <span class="math inline">\((3.16)\)</span> The equation for the stationary retarded Green function is <span class="math display">\[
[E+i \eta-\hat{H}( r )] G^{R}\left( r , r ^{\prime}, E\right)=\delta\left( r - r ^{\prime}\right)
\]</span> This Green function corresponds to the Schrödinger equation <span class="math display">\[
\left[-\frac{\hbar^{2}}{2 m} \nabla^{2}+V( r )\right] \Psi( r )=E \Psi( r )
\]</span> Let us consider as an example the one dimensional GF for free electrons. The corresponding equation is <span class="math display">\[
\left[E \pm i \eta+\frac{\hbar^{2}}{2 m} \frac{\partial^{2}}{\partial x^{2}}\right] G^{R(A)}\left(x, x^{\prime}, E\right)=\delta\left(x-x^{\prime}\right)
\]</span> This equation has two exact solutions: <span class="math display">\[
\begin{array}{l}
G_{1}\left(x-x^{\prime}, E\right)=-\frac{i m}{\hbar^{2} k} e^{i k\left|x-x^{\prime}\right|} \\
G_{2}\left(x-x^{\prime}, E\right)=\frac{i m}{\hbar^{2} k} e^{-i k\left|x-x^{\prime}\right|}
\end{array}
\]</span> where <span class="math inline">\(\hbar k=\sqrt{2 m(E \pm i \eta)}\)</span>. Note, that <span class="math inline">\(k\)</span> has an imaginary part, positive for retarded and negative for advanced Green functions: <span class="math display">\[
k=\frac{\sqrt{2 m(E \pm i \eta)}}{\hbar}=\frac{\sqrt{2 m E}}{\hbar} \sqrt{1 \pm \frac{i \eta}{E}} \approx \frac{\sqrt{2 m E}}{\hbar}\left(1 \pm \frac{i \eta}{2 E}\right) .
\]</span> From the condition of being finite at infinity, we select <span class="math inline">\(G_{1}\left(x-x^{\prime}, E\right)\)</span> to be the retarded function <span class="math inline">\((\hbar k=\sqrt{2 m(E+i \eta)})\)</span> and <span class="math inline">\(G_{2}\left(x-x^{\prime}, E\right)\)</span> to be the advanced function <span class="math inline">\((\hbar k=\sqrt{2 m(E-i \eta)}) .\)</span> At the same time, we can consider <span class="math inline">\(x^{\prime}\)</span> as a position of the scatterer. From this point of view, <span class="math inline">\(G_{1}\left(x-x^{\prime}, E\right)\)</span> corresponds to the outgoing wave, while <span class="math inline">\(G_{2}\left(x-x^{\prime}, E\right)\)</span> for incoming.</p>
<p>The coordinate retarded function has many useful properties. In particular, it is related to the local density of states <span class="math inline">\(\rho( r , E)\)</span>, which can be determined as <span class="math display">\[
\rho( r , E)=\sum_{n}\left|\Psi_{n}( r )\right|^{2} \delta\left(E-E_{n}\right)
\]</span> On the other hand, from (3.25) we get the eigenstate expansion <span class="math display">\[
G^{R}\left( r , r ^{\prime}, E\right)=\sum_{n} \frac{\left\langle r \mid \Psi_{n}\right\rangle\left\langle\Psi_{n} \mid r ^{\prime}\right\rangle}{E-E_{n}+i \eta}=\sum_{n} \frac{\Psi_{n}( r ) \Psi_{n}^{*}\left( r ^{\prime}\right)}{E-E_{n}+i \eta}
\]</span> or for the coinciding coordinates <span class="math inline">\(r = r ^{\prime}\)</span> : <span class="math display">\[
G^{R}( r , r , E)=\sum_{n} \frac{\left\langle r \mid \Psi_{n}\right\rangle\left\langle\Psi_{n} \mid r \right\rangle}{E-E_{n}+i \eta}=\sum_{n} \frac{\left|\Psi_{n}( r )\right|^{2}}{E-E_{n}+i \eta}
\]</span> Comparing these expressions and using the relation <span class="math display">\[
\frac{1}{x \pm i \eta}=P\left(\frac{1}{x}\right) \mp i \pi \delta(x)
\]</span> where <span class="math inline">\(P\)</span> stands for the principal value in the case of integration, one obtains <span class="math display">\[
\rho( r , E)=-\frac{1}{\pi} \operatorname{Im}\left\{G^{R}( r , r , E)\right\}
\]</span> It is also possible to show that the real and imaginary parts of <span class="math inline">\(G^{R(A)}(E)\)</span> are related through a Hilbert transformation <span class="math display">\[
\operatorname{Re}\left\{G^{R(A)}(E)\right\}=\mp P \int_{-\infty}^{\infty} \frac{\operatorname{Im}\left\{G^{R(A)}\left(E^{\prime}\right)\right\}}{E-E^{\prime}} \frac{d E^{\prime}}{\pi}
\]</span> and the following representation holds: <span class="math display">\[
G^{R(A)}( r , r , E)=\int_{-\infty}^{\infty} \frac{\rho\left( r , E^{\prime}\right) d E^{\prime}}{E-E^{\prime} \pm i \eta}
\]</span></p>
<h3 id="用格林算散射-lippmann-schwinger-equation">3.1.3 用格林算散射 Lippmann-Schwinger Equation</h3>
<p>Using Green functions, we can reformulate the scattering theory. Assume that our system can be divided into an unperturbed part with the Hamiltonian <span class="math inline">\(\hat{H}_{0}\)</span> and the perturbation <span class="math inline">\(\hat{V}\)</span>, both time-independent: <span class="math display">\[
\hat{H}=\hat{H}_{0}+\hat{V}
\]</span> This decomposition can be naturally done for scattering of particles in free space, where <span class="math inline">\(\hat{H}_{0}\)</span> includes only (the operators of) kinetic energies and <span class="math inline">\(\hat{V}\)</span> is the scattering potential. For quantum junctions <span class="math inline">\(\hat{H}_{0}\)</span> can be taken for infinite electrodes and <span class="math inline">\(\hat{V}\)</span> should then describe all possible scattering events between electrodes and channels. Usually it is difficult to formulate such a problem explicitly, but the analysis is important for qualitative understanding.</p>
<p>Writing the time-dependent equation <span class="math inline">\((3.16)\)</span> for the full Hamiltonian <span class="math inline">\(\hat{H}=\hat{H}_{0}+\hat{V}\)</span> and for <span class="math inline">\(\hat{H}_{0}\)</span> only: <span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}_{0}-\hat{V}\right] \hat{G}^{R}\left(t, t_{0}\right)=\hat{I} \delta\left(t-t_{0}\right)
\]</span></p>
<p><span class="math display">\[
\left[i \hbar \frac{\partial}{\partial t}-\hat{H}_{0}\right] \hat{G}_{0}^{R}\left(t, t_{0}\right)=\hat{I} \delta\left(t-t_{0}\right)
\]</span> combining these equations together and integrating over the time we get the Lippmann-Schwinger equation for the Green functions in two different forms: <span class="math display">\[
\hat{G}^{R}\left(t-t_{0}\right)=\hat{G}_{0}^{R}\left(t-t_{0}\right)+\int_{t_{0}}^{t} \hat{G}_{0}^{R}\left(t-t^{\prime}\right) \hat{V} \hat{G}^{R}\left(t^{\prime}-t_{0}\right) d t^{\prime}
\]</span> Or <span class="math display">\[
\hat{G}^{R}\left(t-t_{0}\right)=\hat{G}_{0}^{R}\left(t-t_{0}\right)+\int_{t_{0}}^{t} \hat{G}^{R}\left(t-t^{\prime}\right) \hat{V} \hat{G}_{0}^{R}\left(t^{\prime}-t_{0}\right) d t^{\prime}
\]</span> Before going further we define the incoming state as a result of the time evolution of the initial state <span class="math inline">\(\Psi_{0}\left(t_{0}\right)\)</span> from the infinite past under the action of unperturbed Hamiltonian, in accordance with (3.13) it is determined by the Green function <span class="math inline">\(\hat{G}_{0}\left(t-t_{0}\right)\)</span> while the full scattering state is obtained by the full Green function <span class="math inline">\(\hat{G}\left(t-t_{0}\right):\)</span> <span class="math display">\[
\begin{aligned}
\left|\Psi^{i n}(t)\right\rangle &amp;=i \hbar \lim _{t_{0} \rightarrow-\infty} \hat{G}_{0}^{R}\left(t-t_{0}\right)\left|\Psi_{0}\left(t_{0}\right)\right\rangle \\
|\Psi(t)\rangle &amp;=i \hbar \lim _{t_{0} \rightarrow-\infty} \hat{G}^{R}\left(t-t_{0}\right)\left|\Psi_{0}\left(t_{0}\right)\right\rangle
\end{aligned}
\]</span> The sense of this procedure is to "clean" the time-dependent state from the transient contributions and stay only with the state supported by the boundary conditions.</p>
<p>Now we substitute <span class="math inline">\((3.53)\)</span> into <span class="math inline">\((3.55)\)</span> and replace the upper limit of integration over <span class="math inline">\(t\)</span> by <span class="math inline">\(\infty\)</span>, we can do that because <span class="math inline">\(\hat{G}^{R}\left(t-t^{\prime}&lt;0\right)=0 .\)</span> We obtain the LippmannSchwinger equation for the wave function: <span class="math display">\[
|\Psi(t)\rangle=\left|\Psi^{i n}(t)\right\rangle+\int_{-\infty}^{\infty} d t^{\prime} \hat{G}^{R}\left(t-t^{\prime}\right) \hat{V}\left|\Psi^{i n}\left(t^{\prime}\right)\right\rangle
\]</span> or (if we use <span class="math inline">\((3.52)\)</span> instead <span class="math inline">\()\)</span> <span class="math display">\[
|\Psi(t)\rangle=\left|\Psi^{i n}(t)\right\rangle+\int_{-\infty}^{\infty} d t^{\prime} \hat{G}_{0}^{R}\left(t-t^{\prime}\right) \hat{V}\left|\Psi\left(t^{\prime}\right)\right\rangle
\]</span> Making the Fourier transform (3.19) we get the time-independent LippmannSchwinger equations, e.g. with the retarded functions <span class="math display">\[
\begin{aligned}
\hat{G}^{R}(E) &amp;=\hat{G}_{0}^{R}(E)+\hat{G}^{R}(E) \hat{V} \hat{G}_{0}^{R}(E) \\
\left|\Psi_{E}\right\rangle &amp;=\left|\Psi_{E}^{i n}\right\rangle+\hat{G}^{R}(E) \hat{V}\left|\Psi_{E}^{i n}\right\rangle
\end{aligned}
\]</span> Or <span class="math display">\[
\begin{aligned}
\hat{G}^{R}(E) &amp;=\hat{G}_{0}^{R}(E)+\hat{G}_{0}^{R}(E) \hat{V} \hat{G}^{R}(E) \\
\left|\Psi_{E}\right\rangle &amp;=\left|\Psi_{E}^{i n}\right\rangle+\hat{G}_{0}^{R}(E) \hat{V}\left|\Psi_{E}\right\rangle
\end{aligned}
\]</span> In the coordinate representation <span class="math display">\[
\Psi_{E}( r )=\Psi_{E}^{i n}( r )+\int d r ^{\prime} G^{R}\left( r , r ^{\prime}, E\right) V\left( r ^{\prime}\right) \Psi_{E}^{i n}\left( r ^{\prime}\right)
\]</span> Or <span class="math display">\[
\Psi_{E}( r )=\Psi_{E}^{i n}( r )+\int d r ^{\prime} G_{0}^{R}\left( r , r ^{\prime}, E\right) V\left( r ^{\prime}\right) \Psi_{E}\left( r ^{\prime}\right)
\]</span> Both equations describe the wave function as a superposition of incoming wave and all outgoing waves produced by this incoming wave. As a direct computational tool the Lippmann-Schwinger equations are useful in free space with localized scattering region or in rather simple geometries, when the unperturbed Green functions can be easily defined analytically.</p>
<p>Consider as an example scattering at the <span class="math inline">\(\delta\)</span> -potential <span class="math inline">\(V(x)=\alpha \delta(x)\)</span>. The retarded Green function for free <span class="math inline">\(1 D\)</span> electrons is given by <span class="math inline">\((3.39)\)</span> : <span class="math display">\[
G_{0}^{R}\left(x-x^{\prime}, E\right)=-\frac{i m}{\hbar^{2} k} e^{i k\left|x-x^{\prime}\right|}
\]</span> Using the equation (3.63) we get <span class="math inline">\(\left(\Psi^{i n}(x)=e^{i k x}\right)\)</span> : <span class="math display">\[
\Psi(x)=e^{i k x}-\frac{i m \alpha}{\hbar^{2} k} \int d x^{\prime} e^{i k\left|x-x^{\prime}\right|} \delta\left(x^{\prime}\right) \Psi\left(x^{\prime}\right)=e^{i k x}-\frac{i m \alpha}{\hbar^{2} k} e^{i k|x|} \Psi(0) .
\]</span> Boundary conditions at infinity suggest that the solution has the form <span class="math display">\[
\Psi(x)=A\left\{\begin{array}{ll}
e^{i k x}+r e^{-i k x}, &amp; x&lt;0, \\
t e^{i k x}, &amp; x&gt;0
\end{array}\right.
\]</span> Substituting it into (3.65) for <span class="math inline">\(x=+0\)</span> and <span class="math inline">\(x=-0\)</span> we obtain the equations for the reflection amplitude <span class="math inline">\(r\)</span> and the transmission amplitude <span class="math inline">\(t\)</span> <span class="math display">\[
1+r=1-\frac{i m \alpha}{\hbar^{2} k}(1+r), \quad t=1-\frac{i m \alpha}{\hbar^{2} k} t,
\]</span> with the solution <span class="math display">\[
r=\frac{1}{i \frac{\hbar^{2} k}{m \alpha}-1}, \quad t=\frac{i \frac{\hbar^{2} k}{m \alpha}}{i \frac{\hbar^{2} k}{m \alpha}-1} .
\]</span> It is exactly the same result which we obtained solving the Schrödinger equation <span class="math inline">\((2.29)-(2.36)\)</span> For more details about the Lippmann-Schwinger equations we recommend the book of M. Di Ventra [1], Sect. 3.4. 3.1.4 Fisher-Lee Relation Between <span class="math inline">\(S\)</span> and <span class="math inline">\(G^{R}\)</span> Finally, let us establish the relation between the Green function <span class="math inline">\(G^{R}\left( r _{1}, r _{2}, E\right)\)</span> and the scattering matrix <span class="math inline">\(S\)</span>. Although we will not use it explicitly below (instead we derive more practical matrix formulas), it is important to demonstrate equivalence between the Landauer's scattering approach based on the wave function picture and the Green function formalism.</p>
<p>Let us start from a simple <span class="math inline">\(1 D\)</span> case. The multi-channel scattering states <span class="math inline">\((2.126)\)</span>, (2.127) become <span class="math display">\[
\begin{array}{l}
\Psi_{L E}(z)=\left\{\begin{array}{l}
\frac{1}{\sqrt{2 \pi \hbar v_{L}}} e^{i k z}+\frac{r(E)}{\sqrt{2 \pi \hbar v_{L}}} e^{-i k z}, z&lt;z_{L} \\
\frac{t(E)}{\sqrt{2 \pi \hbar v_{R}}} e^{i k^{\prime} z}, \quad z&gt;z_{R}
\end{array}\right. \\
\Psi_{R E}(z)=\left\{\begin{array}{l}
\frac{1}{\sqrt{2 \pi \hbar v_{R}}} e^{-i k^{\prime} z}+\frac{r^{\prime}(E)}{\sqrt{2 \pi \hbar v_{R}}} e^{i k^{\prime} z}, z&gt;z_{R} \\
\frac{t^{\prime}(E)}{\sqrt{2 \pi \hbar v_{L}}} e^{-i k z}, z&lt;z_{L}
\end{array}\right.
\end{array}
\]</span> where we keep different left and right velocities <span class="math inline">\(v_{L}=\hbar k / m, v_{R}=\hbar k^{\prime} / m, k(E)\)</span> and <span class="math inline">\(k^{\prime}(E)\)</span> can be different. These states form a full set of eigenstates and we can use the representation (3.43): <span class="math display">\[
G^{R}\left(z, z^{\prime}, E\right)=\int_{0}^{\infty} \frac{\Psi_{L E_{k}}(z) \Psi_{L E_{k}}^{*}\left(z^{\prime}\right)}{E-E_{k}+i \eta} d E_{k}+\int_{0}^{\infty} \frac{\Psi_{R E_{k}}(z) \Psi_{R E_{k}}^{*}\left(z^{\prime}\right)}{E-E_{k}+i \eta} d E_{k} .
\]</span> Let us calculate these integrals at <span class="math inline">\(z \rightarrow \infty, z^{\prime} \rightarrow-\infty\)</span> taking into account that <span class="math inline">\(t(E) r^{*}(E)+r^{\prime}(E) t^{\prime *}(E)=0\)</span> from (2.53). Finally we get the relation between the retarded Green function and the transmission amplitude: <span class="math display">\[
G^{R}\left(z, z^{\prime}, E\right)=\frac{-i t(E)}{\hbar \sqrt{v_{L} v_{R}}} e^{i k^{\prime} z-i k z^{\prime}}
\]</span> or <span class="math display">\[
t(E)=i \hbar \sqrt{v_{L} v_{R}} G^{R}\left(z, z^{\prime}, E\right) e^{-i k^{\prime} z+i k z^{\prime}}
\]</span> Now we can extend this approach to multi-channel and multi-terminal case. In the general case of multi-terminal scattering the wave functions in the leads, far from the scattering region, are determined by the asymptotic expressions (2.154). The Green functions for scattering from the electrode <span class="math inline">\(s\)</span> into the electrode <span class="math inline">\(p\)</span> at energy <span class="math inline">\(E\)</span> are: <span class="math display">\[
\begin{array}{l}
G^{R}\left( r _{p}, r _{s}, E\right)=\sum_{m n} \frac{-i t_{m n}}{\hbar \sqrt{v_{m} v_{n}}} \phi_{m}\left( r _{p}\right) \phi_{n}^{*}\left( r _{s}\right) e^{-i k_{m} z_{p}-i k_{n} z_{s}}, m \in p, n \in s, \\
G^{R}\left( r _{s}^{\prime}, r _{s}, E\right)=\sum_{n^{\prime} n}\left[-\frac{i \delta_{n^{\prime} n}}{\hbar v_{n}}-\frac{i r_{n^{\prime} n}}{\hbar \sqrt{v_{n^{\prime}} v_{n}}}\right] \phi_{n^{\prime}}\left( r _{s}^{\prime}\right) \phi_{n}^{*}\left( r _{s}\right) e^{-i k_{n} z_{p}^{\prime}-i k_{n} z_{s}}, n, n^{\prime} \in s .
\end{array}
\]</span> Making the inversion of these expressions and assuming the points with coordinates <span class="math inline">\(z_{s}=z_{p}=0\)</span> in the leads (we are free to choose the beginning of coordinate axes), we get the Fisher-Lee relations <span class="math inline">\([2]\)</span> in the form: <span class="math display">\[
\begin{array}{l}
t_{p m, s n}=i \hbar \sqrt{v_{n} v_{m}} \int d r _{s} \int d r _{p} \phi_{m}^{*}\left( r _{p}\right) G^{R}\left( r _{p}, r _{s}\right) \phi_{n}\left( r _{s}\right), p \neq s \\
r_{s n^{\prime}, s n}=-\delta_{n^{\prime} n}+i \hbar \sqrt{v_{n} v_{n^{\prime}}} \int d r _{s} \int d r _{s}^{\prime} \phi_{n^{\prime}}^{*}\left( r _{s}^{\prime}\right) G^{R}\left( r _{s}^{\prime}, r _{s}\right) \phi_{n}\left( r _{s}\right)
\end{array}
\]</span> or, combining both together, <span class="math display">\[
S_{p m, s n}=-\delta_{p s} \delta_{m n}+i \hbar \sqrt{v_{n} v_{m}} \int d r _{s} \int d r _{p} \phi_{m}^{*}\left( r _{p}\right) G^{R}\left( r _{p}, r _{s}\right) \phi_{n}\left( r _{s}\right)
\]</span> Using these expressions and <span class="math inline">\((2.157)\)</span> we can get the transmission function <span class="math inline">\(T_{s p}(E)\)</span> from the lead <span class="math inline">\(p\)</span> into <span class="math inline">\(s\)</span> : <span class="math display">\[
\begin{aligned}
T_{s p}(E)=\sum_{n m}\left|t_{s n, p m}\right|^{2}=&amp; \int d r _{p 2} \int d r _{p 1} \int d r _{s 1} \int d r _{s 2} \\
&amp; \Gamma_{p}\left( r _{p 2}, r _{p 1}\right) G^{R}\left( r _{p 1}, r _{s 1}\right) \Gamma_{s}\left( r _{s 1}, r _{s 2}\right) G^{A}\left( r _{s 2}, r _{p 2}\right)
\end{aligned}
\]</span> where we introduced the functions <span class="math display">\[
\Gamma_{s}\left( r _{s 1}, r _{s 2}\right)=\hbar \sum_{n} v_{n} \phi_{n}\left( r _{s 1}\right) \phi_{n}^{*}\left( r _{s 2}\right)
\]</span> which describe the properties of the <span class="math inline">\(s\)</span> -th electrode and are independent from other electrodes.</p>
<h2 id="matrix-green-functions">3.2 Matrix Green Functions</h2>
<h3 id="matrix-tight-binding-lattice-hamiltonian">3.2.1 Matrix (Tight-Binding, Lattice) Hamiltonian</h3>
<p>Before we considered only continuous quantum systems described by wave functions in real space. However, the nanoscale systems are typically discrete-level systems due to spatial quantization in quantum dots and molecules or importance of atomistic structure. From here on our focus will be on the systems described by the matrix Hamiltonians <span class="math display">\[
H =\left(\begin{array}{cccc}
H_{11} &amp; H_{12} &amp; \cdots &amp; H_{1 N} \\
H_{21} &amp; H_{22} &amp; \cdots &amp; H_{2 N} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
H_{N 1} &amp; H_{N 2} &amp; \cdots &amp; H_{N N}
\end{array}\right)
\]</span> Actually, any Hamiltonian of this type has some basis states <span class="math inline">\(|i\rangle, i=1, \ldots, N\)</span> in its origin. The physical nature of these states is not important from mathematical point of view, but we note that the matrix structure appears as a result of matrix element calculation of some Hamiltonian <span class="math inline">\(\langle i|\hat{H}| j\rangle\)</span>, and the vector wave function <span class="math display">\[
\Psi =\left(\begin{array}{c}
c_{1} \\
c_{2} \\
\vdots \\
c_{N}
\end{array}\right)
\]</span> represents the coefficients of the expansion <span class="math display">\[
|\Psi\rangle=\sum_{i} c_{i}|i\rangle
\]</span> The Hamilton operator can be written also using the basis states and matrix elements (3.81) as <span class="math display">\[
\hat{H}=\sum_{i j}|i\rangle H_{i j}\langle j|
\]</span> The eigenstates <span class="math inline">\(\Psi_{n}\)</span> are to be found from the matrix Schrödinger equation <span class="math display">\[
H \Psi _{n}=E_{n} \Psi _{n}
\]</span></p>
<p>Let us consider some typical systems, for which the matrix method is appropriate starting point.</p>
<h4 id="examplequantum-dot">example：quantum dot</h4>
<p>The simplest example is a single quantum dot, in the basis formed by the eigenstates, the corresponding Hamiltonian is diagonal: <span class="math display">\[
H =\left(\begin{array}{ccccc}
\varepsilon_{1} &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; \varepsilon_{2} &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; 0 &amp; \varepsilon_{N-1} &amp; 0 \\
0 &amp; \cdots &amp; 0 &amp; 0 &amp; \varepsilon_{N}
\end{array}\right)
\]</span> We can write it also, using Dirac notations and second quantization, as <span class="math display">\[
\hat{H}=\sum_{i}|i\rangle \varepsilon_{i}\langle i|=\sum_{i} \varepsilon_{i} d_{i}^{\dagger} d_{i}
\]</span> #### example：nearest couplings</p>
<p>The next typical example is a linear chain of single-state sites with only nearest neighbor couplings (Fig. 3.1)</p>
<p><img src="https://jptanjing.oss-cn-beijing.aliyuncs.com/img/image-20210507200906366.png" srcset="/img/loading.gif" style="zoom:50%;" /></p>
<blockquote>
<p>Fig. 3.1 A linear chain of sites</p>
</blockquote>
<p><span class="math display">\[
H =\left(\begin{array}{ccccc}
\varepsilon_{1} &amp; t &amp; 0 &amp; \cdots &amp; 0 \\
t &amp; \varepsilon_{2} &amp; t &amp; \cdots &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \vdots \\
0 &amp; \cdots &amp; t &amp; \varepsilon_{N-1} &amp; t \\
0 &amp; \cdots &amp; 0 &amp; t &amp; \varepsilon_{N}
\end{array}\right)
\]</span></p>
<p>Two important ways to obtain discrete Hamiltonians are the tight-binding approximation and discretization of the Scrödinger equation (or the equivalent equations for Green functions) using finite differences and discretized space grid (lattice) instead of derivatives in continuous space.</p>
<h4 id="tight-binding-model">Tight-Binding Model</h4>
<p>The main idea of the method is to represent the wave function of a particle as a linear combination of some known localized states <span class="math inline">\(\psi_{\alpha}( r , \sigma)\)</span>, where <span class="math inline">\(\alpha\)</span> denote the set of quantum numbers, and <span class="math inline">\(\sigma\)</span> is the spin index (for example, atomic orbitals, in this particular case the method is called LCAO- linear combination of atomic orbitals) <span class="math display">\[
\psi(\xi)=\sum_{\alpha} c_{\alpha} \psi_{\alpha}(\xi)
\]</span> here and below we use <span class="math inline">\(\xi \equiv( r , \sigma)\)</span> to denote both spatial coordinates and spin.</p>
<p>Using the Dirac notations <span class="math inline">\(|\alpha\rangle \equiv \psi_{\alpha}(\xi)\)</span> and assuming that <span class="math inline">\(\psi_{\alpha}(\xi)\)</span> are orthonormal functions <span class="math inline">\(\langle\alpha \mid \beta\rangle=\delta_{\alpha \beta}\)</span> we can write the single-particle tight-binding Hamiltonian in the Hilbert space formed by <span class="math inline">\(\psi_{\alpha}(\xi)\)</span> <span class="math display">\[
\hat{H}=\sum_{\alpha}\left(\varepsilon_{\alpha}+e \varphi_{\alpha}\right)|\alpha\rangle \langle\alpha |+\sum_{\alpha \beta} t_{\alpha \beta} | \alpha \rangle\langle\beta|
\]</span> the first term in this Hamiltonian describes the states with energies <span class="math inline">\(\varepsilon_{\alpha}, \varphi_{\alpha}\)</span> is the electrical potential, the second term should be included if the states <span class="math inline">\(|\alpha\rangle\)</span> are not eigenstates of the Hamiltonian. In the TB model <span class="math inline">\(t_{\alpha \beta}\)</span> is the hopping matrix element between states <span class="math inline">\(|\alpha\rangle\)</span> and <span class="math inline">\(|\beta\rangle\)</span>, which is nonzero, as a rule, for nearest neighbor sites. The two-particle interaction is described by the Hamiltonian <span class="math display">\[
\hat{H}=\sum_{\alpha \beta, \delta \gamma} V_{\alpha \beta, \delta \gamma}|\alpha\rangle|\beta\rangle\langle\delta|\langle\gamma|
\]</span> in the two-particle Hilbert space, and so on. The energies and hopping matrix elements in this Hamiltonian can be calculated as matrix elements of the single-particle real-space Hamiltonian <span class="math inline">\(\hat{h}(\xi)\)</span> : <span class="math display">\[
\varepsilon_{\alpha \beta}=\varepsilon_{\alpha} \delta_{\alpha \beta}+t_{\alpha \beta}\left(1-\delta_{\alpha \beta}\right)=\int \psi_{\alpha}^{*}(\xi) \hat{h}(\xi) \psi_{\beta}(\xi) d \xi
\]</span> We combined in this expression the energies and hopping terms into one energy matrix <span class="math inline">\(\varepsilon_{\alpha \beta}\)</span> with the matrix elements of the single-particle Hamiltonian <span class="math display">\[
H_{\alpha \beta} \equiv \varepsilon_{\alpha \beta}=\left\{\begin{array}{ll}
\varepsilon_{\alpha}+e \varphi_{\alpha}, &amp; \alpha=\beta \\
t_{\alpha \beta}, &amp; \alpha \neq \beta
\end{array}\right.
\]</span> This approach was developed originally as an approximate method, if the wave functions of isolated atoms are taken as a basis wave functions <span class="math inline">\(\psi_{\alpha}(\xi)\)</span>, but also can be formulated exactly with the help of Wannier functions. Only in the last case the expansion (3.89) and the Hamiltonian (3.90) are exact, but some extension to the arbitrary basis functions is possible. The method is useful to calculate the conductance of complex quantum systems in combination with <span class="math inline">\(a b\)</span> initio methods. It is particular important to describe small molecules, when the atomic orbitals form the basis. Finally, in the second quantized form the tight-binding Hamiltonian is <span class="math display">\[
\hat{H}=\sum_{\alpha}\left(\varepsilon_{\alpha}+e \varphi_{\alpha}\right) c_{\alpha}^{\dagger} c_{\alpha}+\sum_{\alpha \neq \beta} t_{\alpha \beta} c_{\alpha}^{\dagger} c_{\beta}
\]</span> The formalism of second quantization we will use in the second part devoted to advanced methods.</p>
<p>In the mathematical sense, the TB model represents also a discrete (grid) version of the continuous Schrödinger equation, thus it is routinely used in numerical calculations.</p>
<h5 id="example">example</h5>
<p>Consider, as an example, the one-dimensional Schrödinger equation with the Hamiltonian <span class="math display">\[
\hat{H}(x)=-\frac{\hbar^{2}}{2 m} \frac{d^{2}}{d x^{2}}+V(x)
\]</span> For numerical calculation we introduce the discrete lattice of sites with coordinates <span class="math inline">\(x_{i}=a i, i \in Z, a\)</span> is the lattice constant. The continuous functions are replaced by their values in points <span class="math inline">\(x_{i}\)</span> : <span class="math display">\[
\Psi(x) \Rightarrow \Psi_{i}, \quad V(x) \Rightarrow V_{i}
\]</span> the derivatives are approximated by the finite differences <span class="math inline">\(^{4}\)</span> <span class="math display">\[
\begin{array}{c}
\frac{d}{d x} \Psi(x) \Rightarrow\left(\frac{d}{d x} \Psi(x)\right)_{i}=\frac{\Psi_{i+1}-\Psi_{i}}{a}, \\
\left(\frac{d^{2}}{d x^{2}} \Psi(x)\right)_{i}=\frac{1}{a}\left[\left(\frac{d}{d x} \Psi(x)\right)_{i}-\left(\frac{d}{d x} \Psi(x)\right)_{i-1}\right]=\frac{\Psi_{i+1}-2 \Psi_{i}+\Psi_{i-1}}{a^{2}} .
\end{array}
\]</span> Introducing <span class="math inline">\(t=\frac{\hbar^{2}}{2 m a}\)</span>, we get the TB Hamiltonian <span class="math display">\[
\hat{H}=\sum_{i}\left[\left(2 t+V_{i}\right)|i\rangle\langle i|-t| i\rangle\langle i-1|-t| i\rangle\langle i+1|\right] .
\]</span> This Hamiltonian in the matrix form is <span class="math display">\[
H =\left(\begin{array}{ccccc}
\ddots &amp; -t &amp; 0 &amp; 0 &amp; \ddots \\
-t &amp; 2 t+V_{i-1} &amp; -t &amp; 0 &amp; 0 \\
0 &amp; -t &amp; 2 t+V_{i} &amp; -t &amp; 0 \\
0 &amp; 0 &amp; -t &amp; 2 t+V_{i+1} &amp; -t \\
\ddots &amp; 0 &amp; 0 &amp; -t &amp; \ddots
\end{array}\right)
\]</span></p>
<h3 id="retarded-single-particle-matrix-green-function">3.2.2 Retarded Single-Particle Matrix Green Function</h3>
<p>The solution of single-particle quantum problems, formulated with the help of a matrix Hamiltonian, is possible along the usual line of finding the wave-functions on a lattice, solving the Schrödinger equation (3.85). The other method, namely matrix Green functions, considered in this section, was found to be more convenient for transport calculations, especially when interactions are included. The retarded single-particle matrix Green function <span class="math display">\[
G^{R}(E)=\left(\begin{array}{cccc}
G_{11} &amp; G_{12} &amp; \cdots &amp; G_{1 N} \\
G_{21} &amp; G_{22} &amp; \cdots &amp; G_{2 N} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
G_{N 1} &amp; G_{N 2} &amp; \cdots &amp; G_{N N}
\end{array}\right)
\]</span> is determined by the equation <span class="math display">\[
[(E+i \eta) I - H ] G ^{R}= I
\]</span> where <span class="math inline">\(\eta\)</span> is an infinitesimally small positive number <span class="math inline">\(\eta=0^{+}\)</span>. For an isolated non-interacting system the Green function is simply obtained after the matrix inversion <span class="math display">\[
G ^{R}(E)=[(E+i \eta) I - H ]^{-1}
\]</span> All general properties of GFs, discussed above, are applicable also for matrix GFs. For example, the local density of states in state <span class="math inline">\(\alpha\)</span> at energy <span class="math inline">\(E\)</span> is determined by <span class="math display">\[
\rho_{\alpha}(E)=-\frac{1}{\pi} \operatorname{Im} G_{\alpha \alpha}^{R}(E)
\]</span> For simple quantum dot Hamiltonian (3.87) the matrix Green function is easily found to be <span class="math display">\[
G_{\alpha \beta}^{R}(E)=\frac{\delta_{\alpha \beta}}{E-\varepsilon_{\alpha}+i \eta}
\]</span> Let us consider the example of a two-level system with the Hamiltonian <span class="math display">\[
H =\left(\begin{array}{cc}
\varepsilon_{1} &amp; t \\
t &amp; \varepsilon_{2}
\end{array}\right)
\]</span> The retarded <span class="math inline">\(GF\)</span> is <span class="math display">\[
G^{R}(E)=\frac{1}{\left(E+i \eta-\varepsilon_{1}\right)\left(E+i \eta-\varepsilon_{2}\right)-t^{2}}\left(\begin{array}{cc}
E+i \eta-\varepsilon_{2} &amp; t \\
t &amp; E+i \eta-\varepsilon_{1}
\end{array}\right) .
\]</span> The tight-binding and lattice Hamiltonians are applied as well to consider the semi-infinite leads. Although the matrices are formally infinitely-dimensional in this case, we shall show below, that the problem is reduced to the finite-dimensional problem for the quantum system of interest, and the semi-infinite leads can be integrated out.</p>
<p>For more details about the lattice Hamiltonians and Green functions we recommend the book of D.K. Ferry and S.M. Goodnick [3], Sect. <span class="math inline">\(3.8\)</span>.</p>
<h3 id="electrode-self-energies">3.2.3 Electrode Self-Energies</h3>
<p>Now let us consider the case, when the system of interest is coupled to the electrodes and forms the nanojunction (Fig. 3.2).</p>
<p><img src="https://jptanjing.oss-cn-beijing.aliyuncs.com/img/image-20210507200736403.png" srcset="/img/loading.gif" style="zoom:50%;" /></p>
<blockquote>
<p>Fig. 3.2 A quantum system coupled to the left and right equilibrium electrodes</p>
</blockquote>
<p>We assume here that the electrodes are also described by the tight-binding model and by the matrix GFs. Actually, the semiinfinite contacts should be described by the matrix of infinite dimension. We shall consider the semi-infinite contacts later. As usually, we assume, that the electrodes are equilibrium (with possibly different electrochemical potentials), and the central region includes leads and scatterer.</p>
<p>Let us present the full Hamiltonian of the considered system in the following block form <span class="math display">\[
H =\left(\begin{array}{ccc} 
H _{L} &amp; V _{L C} &amp; 0 \\
V _{C L} &amp; H _{C} &amp; V _{C R} \\
0 &amp; V _{R C} &amp; H _{R}
\end{array}\right)
\]</span> where <span class="math inline">\(H _{L}, H _{C}\)</span>, and <span class="math inline">\(H _{R}\)</span> are the matrix Hamiltonians of the left electrode, the central region, and the right electrode respectively. And the off-diagonal terms describe the coupling to the electrodes. Here we neglect the direct coupling between the electrodes. The Hamiltonian should be Hermitian, such that <span class="math display">\[
V _{C L}= V _{L C}^{\dagger}, \quad V _{C R}= V _{R C}^{\dagger}
\]</span> The equation (3.102) can be written as <span class="math display">\[
\left(\begin{array}{ccc} 
E - H _{L} &amp; - V _{L C} &amp; 0 \\
- V _{L C}^{\dagger} &amp; E - H _{C} &amp; - V _{R C}^{\dagger} \\
0 &amp; - V _{R C} &amp; E - H _{R}
\end{array}\right)\left(\begin{array}{ccc} 
G _{L} &amp; G _{L C} &amp; 0 \\
G _{C L} &amp; G _{C} &amp; G _{C R} \\
0 &amp; G _{R C} &amp; G _{R}
\end{array}\right)= I
\]</span> where we introduce the matrix <span class="math inline">\(E =(E+i \eta) I\)</span>, and represent the matrix Green function in a convenient form, the notation of retarded function is omitted in intermediate formulas. Now our first goal is to find the system Green function <span class="math inline">\(G _{C}\)</span> which defines all quantities of interest. From the matrix equation ( <span class="math inline">\(3.110\)</span> ) <span class="math display">\[
\begin{aligned}
\left( E - H _{L}\right) G _{L C}- V _{L C} G _{C} &amp;=0 \\
- V _{L C}^{\dagger} G _{L C}+\left( E - H _{C}\right) G _{C}- V _{R C}^{\dagger} G _{R C} &amp;= I \\
- V _{R C} G _{C}+\left( E - H _{R}\right) G _{R C} &amp;=0 .
\end{aligned}
\]</span> From the first and the third equations one has <span class="math display">\[
G _{L C}=\left( E - H _{L}\right)^{-1} V _{L C} G _{C}
\]</span> <span class="math display">\[
G _{R C}=\left( E - H _{R}\right)^{-1} V _{R C} G _{C}
\]</span> and substituting it into the second equation we arrive at the equation <span class="math display">\[
\left( E - H _{C}- \Sigma \right) G _{C}= I
\]</span> where we introduce the electrode self-energy (which should be also called retarded) <span class="math display">\[
\Sigma = V _{L C}^{\dagger}\left( E - H _{L}\right)^{-1} V _{L C}+ V _{R C}^{\dagger}\left( E - H _{R}\right)^{-1} V _{R C}
\]</span> Finally, we found, that the retarded GF of a nanosystem coupled to the leads is determined by the expression (we restore the <span class="math inline">\(R\)</span> notation for retarded functions) <span class="math display">\[
G _{C}^{R}(E)=\left[ E - H _{C}- \Sigma ^{R}\right]^{-1}
\]</span> the effects of the leads are included through the self-energy. Here we should stress the important property of the self-energy (3.117), it is determined only by the coupling Hamiltonians <span class="math inline">\(V _{s C}\)</span> and the retarded GFs of the isolated leads <span class="math inline">\(G _{s}^{R}(s=L, R)\)</span> <span class="math display">\[
\begin{array}{c} 
G _{s}^{R}=\left( E - H _{s}\right)^{-1} \\
\Sigma _{s}^{R}= V _{s C}^{\dagger}\left( E - H _{s}\right)^{-1} V _{s C}= V _{s C}^{\dagger} G _{s}^{R} V _{s C}
\end{array}
\]</span> or, in index notation, <span class="math display">\[
\Sigma _{s ; \alpha \beta}^{R}=\sum_{\delta \gamma}\left( V _{s C}^{\dagger}\right)_{\alpha \delta} G_{s ; \delta \gamma}^{R} V_{s ; \gamma \beta}=\sum_{\delta \gamma} V_{s ; \delta \alpha}^{*} V_{s ; \gamma \beta} G_{s ; \delta \gamma}^{R}
\]</span> It means, that the contact self-energy is independent of the state of the nanosystem itself and describes completely the influence of the electrodes. Later we shall see that this property is also conserved for interacting central systems, if the leads are still non-interacting.</p>
<p>The extension from two-electrode to multi-electrode case is straightforward, the self-energies <span class="math inline">\((s=1, \ldots, N)\)</span> are given by the formulas <span class="math inline">\((3.119)-(3.121)\)</span> and <span class="math inline">\(\Sigma^{R}\)</span> in (3.118) is the sum over all electrodes <span class="math display">\[
\Sigma^{R}=\sum_{s} \Sigma_{s}^{R}
\]</span> ### 3.2.4 Transmission Function and Current</p>
<p>Now we want to calculate the current through a junction. We assume, as before, that the electrodes are equilibrium, and there is the voltage <span class="math inline">\(V\)</span> applied between the left and right electrodes. The calculation of the current in a general case is more convenient to perform using the full power of the nonequilibrium Green function method. Here we present a simplified approach, valid for non-interacting systems only.</p>
<p>First, we consider a very simple approach, following Paulsson [4]. Let us come back to the Schrödinger equation in the matrix representation (3.85), and write it in the following form <span class="math display">\[
\left(\begin{array}{ccc} 
H _{L}^{0} &amp; V _{L S} &amp; 0 \\
V _{L S}^{\dagger} &amp; H _{C}^{0} &amp; V _{R S}^{\dagger} \\
0 &amp; V _{R S} &amp; H _{R}^{0}
\end{array}\right)\left(\begin{array}{c} 
\Psi _{L} \\
\Psi _{C} \\
\Psi _{R}
\end{array}\right)=E\left(\begin{array}{c} 
\Psi _{L} \\
\Psi _{C} \\
\Psi _{R}
\end{array}\right)
\]</span> where <span class="math inline">\(\Psi _{L}, \Psi _{C}\)</span>, and <span class="math inline">\(\Psi _{R}\)</span> are vector wave functions of the left lead, the central system, and the right lead correspondingly.</p>
<p>Now we find the solution in the scattering form (which is difficult to call true scattering because we do not define explicitly the geometry of the leads). Namely, in the left lead <span class="math inline">\(\Psi _{L}= \Psi _{L}^{0}+ \Psi _{L}^{1}\)</span>, where <span class="math inline">\(\Psi _{L}^{0}\)</span> is the eigenstate of <span class="math inline">\(H _{L}^{0}\)</span>, and is considered as known initial wave. The "reflected" wave <span class="math inline">\(\Psi _{L}^{1}\)</span>, as well as the transmitted wave in the right lead <span class="math inline">\(\Psi _{R}\)</span>, appear only as a result of the interaction between subsystems. The main trick is, that we find a retarded solution.</p>
<p>Solving the equation (3.123) with these conditions, the solution is <span class="math display">\[
\begin{array}{c} 
\Psi _{L}=\left(1+ G _{L}^{0 R} V _{L S} G _{C}^{R} V _{L S}^{\dagger}\right) \Psi _{L}^{0} \\
\Psi _{R}= G _{R}^{0 R} V _{R S} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L}^{0} \\
\Psi _{C}= G _{C}^{R} V _{L S}^{\dagger} \Psi _{L}^{0}
\end{array}
\]</span> The physical sense of this expressions is quite transparent, they describe the quantum amplitudes of the scattering processes. Three functions <span class="math inline">\(\Psi _{L}, \Psi _{C}\)</span>, and <span class="math inline">\(\Psi _{R}\)</span> are equivalent together to the scattering state in the Landauer-Büttiker theory. Note, that <span class="math inline">\(G_{C}^{R}\)</span> here is the full GF of the nanosystem including the lead self-energies.</p>
<p>Now the next step. We want to calculate the current. The partial (for some particular eigenstate <span class="math inline">\(\Psi _{L \lambda}^{0}\)</span> ) current from the lead to the system is <span class="math display">\[
j_{s=L, R}=\frac{i e}{\hbar}\left( \Psi _{s}^{\dagger} V _{s C} \Psi _{C}- \Psi _{C}^{\dagger} H _{s C}^{\dagger} \Psi _{s}\right)
\]</span> To calculate the total current we should substitute the expressions for the wave functions (3.124)-(3.126), and summarize all contributions [4]. As a result the Landauer formula is obtained. We present the calculation for the transmission function. First, after substitution of the wave functions we have for the partial current through the system <span class="math display">\[
\begin{aligned}
j_{\lambda} &amp;=j_{L}=-j_{R}=-\frac{i e}{\hbar}\left( \Psi _{R}^{\dagger} V _{R S} \Psi _{C}- \Psi _{C}^{\dagger} H _{R S}^{\dagger} \Psi _{R}\right) \\
&amp;=-\frac{i e}{\hbar}\left( \Psi _{L}^{0 \dagger} V _{L S} G _{C}^{A} V _{R S}^{\dagger}\left( G _{R}^{0 \dagger}- G _{R}^{0}\right) V _{R S} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L}^{0}\right) \\
&amp;=\frac{e}{\hbar}\left( \Psi _{L}^{0 \dagger} V _{L S} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L}^{0}\right)
\end{aligned}
\]</span> Here we introduce and use for the first time the new function (matrix) <span class="math display">\[
\Gamma _{s}=i\left( \Sigma _{s}^{R}- \Sigma _{s}^{A}\right),
\]</span> called the level-width function. The full current of all possible left eigenstates is given by <span class="math display">\[
I=\sum_{\lambda} j_{\lambda}=\sum_{\lambda} \frac{e}{\hbar}\left( \Psi _{L \lambda}^{0 \dagger} V _{L S} G _{C}^{A} \Gamma _{R} G _{C}^{R} H _{L S}^{\dagger} \Psi _{L \lambda}^{0}\right) f_{L}\left(E_{\lambda}\right)
\]</span> the distribution function <span class="math inline">\(f_{L}\left(E_{\lambda}\right)\)</span> describes the population of the left states, the distribution function of the right lead is absent here, because we consider only the current from the left to the right.</p>
<p>The same current is given by the Landauer formula through the transmission function <span class="math inline">\(T(E)\)</span> <span class="math display">\[
I=\frac{e}{h} \int_{-\infty}^{\infty} T(E) f_{L}(E) d E
\]</span> If one compares these two expressions for the current, the transmission function at some energy is obtained as <span class="math display">\[
\begin{aligned}
T(E) &amp;=2 \pi \sum_{\lambda} \delta\left(E-E_{\lambda}\right)\left( \Psi _{L \lambda}^{0 \dagger} V _{L S} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L \lambda}^{0}\right) \\
&amp;=2 \pi \sum_{\lambda} \sum_{\delta} \delta\left(E-E_{\lambda}\right)\left( \Psi _{L \lambda}^{0 \dagger} V _{L S} \Psi _{\delta}\right)\left( \Psi _{\delta}^{\dagger} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger} \Psi _{L \lambda}^{0}\right) \\
&amp;=\sum_{\delta}\left( \Psi _{\delta}^{\dagger} G _{C}^{A} \Gamma _{R} G _{C}^{R} V _{L S}^{\dagger}\left(2 \pi \sum_{\lambda} \delta\left(E-E_{\lambda}\right) \Psi _{L \lambda}^{0} \Psi _{L \lambda}^{0 \dagger}\right) V _{L S} \Psi _{\delta}\right) \\
&amp;=\operatorname{Tr}\left( \Gamma _{L} G _{C}^{A} \Gamma _{R} G _{C}^{R}\right)
\end{aligned}
\]</span> To evaluate the sum in brackets we used the eigenfunction expansion (3.162) for the left contact.</p>
<p>We obtained a new representation for the transmission function, which is very convenient for numerical calculations <span class="math display">\[
T(E)=\operatorname{Tr}\left(t t^{\dagger}\right)=\operatorname{Tr}\left(\Gamma_{L}(E) G^{R}(E) \Gamma_{R}(E) G^{A}(E)\right)
\]</span> If one compares this expression with (3.79), obtained from the Fisher-Lee relation, it becomes clear that our new formula is the discretized version of <span class="math inline">\((3.79)\)</span> and the function <span class="math inline">\(\Gamma_{s}\left( r _{s 1}, r _{s 2}\right)\)</span> is analog of the level-width function. Indeed, one can calculate the self-energy explicitly from the wave functions of a semi-infinite electrode. It means that (3.133) can be derived from the Landauer approach directly.</p>
<p>Finally, one important remark, at finite voltage the diagonal energies in the Hamiltonians <span class="math inline">\(H _{L}^{0}, H _{C}^{0}\)</span>, and <span class="math inline">\(H _{R}^{0}\)</span> are shifted <span class="math inline">\(\varepsilon_{\alpha} \rightarrow \varepsilon_{\alpha}+e \varphi_{\alpha} .\)</span> Consequently, the energy dependencies of the self-energies defined by (3.121) are also changed and the lead self-energies are voltage dependent. However, it is convenient to define the selfenergies using the Hamiltonians at zero voltage, in that case the voltage dependence should be explicitly shown in the transmission formula <span class="math display">\[
T(E)=\operatorname{Tr}\left[\tilde{\Gamma}_{L}\left(E-e \varphi_{L}\right) G^{R}(E) \tilde{\Gamma}_{R}\left(E-e \varphi_{R}\right) G^{A}(E)\right]
\]</span> where <span class="math inline">\(\varphi_{R}\)</span> and <span class="math inline">\(\varphi_{L}\)</span> are electrical potentials of the right and left leads.</p>
<h2 id="recursive-method">3.3 Recursive Method</h2>
<h3 id="dyson-equation">3.3.1 Dyson Equation</h3>
<p>The recursive Green function method is an approach to calculate the Green functions of multi-component systems if the Green functions of isolated subsystems and the coupling matrices between subsystems are known. Starting at one end of the system (usually one of the electrodes), the subsystems are added one by one, finally the Green function of the whole system can be found. It is a convenient way to calculate the relevant Green function components for large complex systems which can be divided into many connected parts. From computational point of view the recursive method can be much faster than direct solution of the equations for large systems. The method is based on the Dyson equation <span class="math inline">\(^{5}\)</span> for the full Green function <span class="math inline">\(G\)</span>, the Green function for a disconnected system <span class="math inline">\(G _{0}\)</span> and the coupling matrix <span class="math inline">\(V\)</span> : <span class="math display">\[
G = G _{0}+ G _{0} V G
\]</span> The full GF is defined by the full Hamiltonian <span class="math inline">\(H = H _{0}+ V :( E - H ) G = I\)</span>, the GF of the particular parts of the system is defined as <span class="math inline">\(\left( E - H _{0}\right) G _{0}= I\)</span>. Comparing this two equations, it is easy to get (3.135). The advantage of the Dyson equation is that if one connects an additional external system to the system of interest, it is enough to know the Green function of this external system (independently of how it was calculated) and the coupling matrix. Note, that this procedure works only for non-interacting systems or as a perturbation in <span class="math inline">\(V\)</span> for interacting systems, otherwise <span class="math inline">\(V\)</span> should be replaced by a more general self-energy. However, the recursive method can be applied to interacting systems in combination with the iterative procedure.</p>
<p>Consider how this equation works if we couple two systems with Green functions <span class="math inline">\(G_{A}^{0}\)</span> and <span class="math inline">\(G_{B}^{0}\)</span> (Fig.3.3), note that we do not need any explicit Hamiltonian for the subsystems <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, they can be connected to an arbitrary number of other systems and electrodes through corresponding self-energies. The functions <span class="math inline">\(G _{A}^{0}\)</span> and <span class="math inline">\(G _{B}^{0}\)</span> are defined in the subspaces <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with the numbers of states <span class="math inline">\(N_{A}\)</span> and <span class="math inline">\(N_{B}\)</span> respectively, the full matrices <span class="math inline">\(G , G _{0}, V\)</span> have the dimensions <span class="math inline">\(\left(N_{A}+N_{B}\right) \times\left(N_{A}+N_{B}\right)\)</span>, and we write the equation <span class="math inline">\((3.135)\)</span> as <span class="math display">\[
\left(\begin{array}{cc} 
G _{A} &amp; G _{A B} \\
G _{B A} &amp; G _{B}
\end{array}\right)=\left(\begin{array}{cc} 
G _{A}^{0} &amp; 0 \\
0 &amp; G _{B}^{0}
\end{array}\right)+\left(\begin{array}{cc} 
G _{A}^{0} &amp; 0 \\
0 &amp; G _{B}^{0}
\end{array}\right)\left(\begin{array}{cc}
0 &amp; V _{A B} \\
V _{B A} &amp; 0
\end{array}\right)\left(\begin{array}{cc} 
G _{A} &amp; G _{A B} \\
G _{B A} &amp; G _{B}
\end{array}\right)
\]</span> where <span class="math inline">\(V _{A B}\)</span> is the coupling matrix between subsystems with the dimensions <span class="math inline">\(N_{A} \times N_{B}\)</span>. We are interested in calculation of the function <span class="math inline">\(G^{A}\)</span> describing the subsystem <span class="math inline">\(A\)</span> and</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Condensed-matter-Physics/">Condensed matter Physics</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Green-Function/">Green Function</a>
                    
                      <a class="hover-with-bg" href="/tags/Transport/">Transport</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2021/05/06/CMP_15_Transport99_DR_01/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">纳米尺度下量子输运理论</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2021/05/04/CMP_03_SuperC_05_TSC/">
                        <span class="hidden-mobile">拓扑超导</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>


      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 1,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "纳米尺度下量子输运理论-2&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js" ></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  
















</body>
</html>
