<!DOCTYPE html>
<html lang="en">





<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="JPZhuang">
  <meta name="keywords" content="">
  <title>TI笔记2 Berry相位与陈数 - JPZ</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Physics</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('https://jptanjing.oss-cn-beijing.aliyuncs.com/blog_QuantumAI/topology07_book_short01.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2016-11-03 14:02">
      November 3, 2016 pm
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      8.3k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      165
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <p>拓扑入门第一例</p>
<p>[TOC]</p>
<h2 id="简介">简介</h2>
<h2 id="参考">参考</h2>
<ul>
<li>《A Short Course on Topological Insulators 》
<ul>
<li>Chapter 2 Berry Phase, Chern Number</li>
</ul></li>
<li><a href="https://github.com/oroszl/topins" target="_blank" rel="noopener">Github jupyter notebooks</a> 这个作者还有transport的课程</li>
<li><a href="http://optics.szfki.kfki.hu/~asboth/topins_course/" target="_blank" rel="noopener">课程</a></li>
</ul>
<h2 id="chapter-2-berry-phase-chern-number">Chapter 2 Berry Phase, Chern Number</h2>
<p>To describe the theory of topological band insulators we will use the language of adiabatic phases. In this chapter we review the basic concepts: the Berry phase, the Berry curvature, and the Chern number. We further describe the relation between the Berry phase and adiabatic dynamics in quantum mechanics. Finally, we illustrate these concepts using a two-level system as a simple example.</p>
<p>For pedagogical introductions, we refer the reader to Berry's original paper [6], and papers from the American Journal of Physics [14, 18]. For the application to solid state physics, we will mostly build on Resta's lecture note [26], and the review paper [36].</p>
<h2 id="discrete-case">2.1 Discrete Case</h2>
<p>The subject of adiabatic phases is strongly related to adiabatic quantum dynamics, when a Hamiltonian is slowly changed in time, and the time evolution of the quantum state follows the instantaneous eigenstate of the Hamiltonian. In that context, as time is a continuous variable and the time-dependent Schrödinger equation is a differential equation, the adiabatic phase and the related concepts are expressed using differential operators and integrals. We will arrive to that point later during this chapter; however, we start the discussion using the language of discrete quantum states. Besides the conceptual simplicity, this language also offers an efficient tool for the numerical evaluation of the Chern number, which is an important topological invariant for two-dimensional electron systems.</p>
<h4 id="relative-phase-of-two-nonorthogonal-quantum-states">2.1.1 Relative Phase of Two Nonorthogonal Quantum States</h4>
<p>In quantum mechanics, the state of a physical system is represented by an equivalence class of vectors in a Hilbert space: a multiplication by a complex phase factor does not change the physical content. A gauge transformation is precisely such a multiplication: <span class="math display">\[
|\Psi\rangle \rightarrow e^{i \alpha}|\Psi\rangle, \quad \text { with } \alpha \in[0,2 \pi) .
\]</span> In that sense, the phase of a vector <span class="math inline">\(|\Psi\rangle\)</span> does not represent physical information. We can try to define the relative phase <span class="math inline">\(\gamma_{12}\)</span> of two nonorthogonal states <span class="math inline">\(\left|\Psi_{1}\right\rangle\)</span> and <span class="math inline">\(\left|\Psi_{2}\right\rangle\)</span> as <span class="math display">\[
\gamma_{12}=-\arg \left\langle\Psi_{1} \mid \Psi_{2}\right\rangle
\]</span> where <span class="math inline">\(\arg (z)\)</span> denotes the phase of the complex number <span class="math inline">\(z\)</span>, with the specification that <span class="math inline">\(\arg (z) \in(-\pi, \pi]\)</span>. Clearly, the relative phase <span class="math inline">\(\gamma_{12}\)</span> fulfils <span class="math display">\[
e^{-i \gamma_{12}}=\frac{\left\langle\Psi_{1} \mid \Psi_{2}\right\rangle}{\left|\left\langle\Psi_{1} \mid \Psi_{2}\right\rangle\right|}
\]</span> However, the relative phase is not invariant under a local gauge transformation, <span class="math display">\[
\left|\Psi_{j}\right\rangle \rightarrow e^{i \alpha_{j}}\left|\Psi_{j}\right\rangle \quad e^{-i \gamma_{12}} \rightarrow e^{-i \gamma_{12}+i\left(\alpha_{2}-\alpha_{1}\right)} .
\]</span> #### 2.1.2 Berry Phase</p>
<p>Take <span class="math inline">\(N \geq 3\)</span> states in a Hilbert space, order them in a loop, and ask about the phase around the loop. As we show below, the answer-the Berry phaseis gauge invariant. For states <span class="math inline">\(\left|\Psi_{j}\right\rangle\)</span>, with <span class="math inline">\(j=1,2, \ldots, N\)</span>, and for the ordered list <span class="math inline">\(L=(1,2, \ldots, N)\)</span> which define the loop, shown in Fig. <span class="math inline">\(2.1\)</span>, the Berry phase is defined as <span class="math display">\[
\gamma_{L}=-\arg e^{-i\left(\gamma_{12}+\gamma_{23}+\ldots+\gamma_{N 1}\right)}=-\arg \left(\left\langle\Psi_{1} \mid \Psi_{2}\right\rangle\left\langle\Psi_{2} \mid \Psi_{3}\right\rangle \ldots\left\langle\Psi_{N} \mid \Psi_{1}\right\rangle\right)
\]</span> To show the gauge invariance of the Berry phase, it can be rewritten as <span class="math display">\[
\gamma_{L}=-\arg \operatorname{Tr}\left(\left|\Psi_{1}\right\rangle\left\langle\Psi_{1}|| \Psi_{2}\right\rangle\left\langle\Psi_{2}|\ldots| \Psi_{N}\right\rangle\left\langle\Psi_{N}\right|\right) .
\]</span> Here, we expressed the Berry phase <span class="math inline">\(\gamma_{L}\)</span> using projectors that are themselves gauge invariant.</p>
<p>Even though the Berry phase is not the expectation value of some operator, it is a gauge invariant quantity, and as such, it can have a direct physical significance. We will find such a significance, but first, we want to gain more intuition about its behaviour.</p>
<h4 id="berry-flux">2.1.3 Berry Flux</h4>
<p>Consider a Hilbert space of quantum states, and a finite two-dimensional square lattice with points labelled by <span class="math inline">\(n, m \in Z , 1 \leq n \leq N\)</span>, and <span class="math inline">\(1 \leq m \leq M .\)</span> Assign a quantum state <span class="math inline">\(\left|\Psi_{n, m}\right\rangle\)</span> from the Hilbert space to each lattice site. Say you want to know the Berry phase of the loop <span class="math inline">\(L\)</span> around this set, <span class="math display">\[
\begin{aligned}
\gamma_{L}=-\arg \exp \left[-i\left(\sum_{n=1}^{N-1} \gamma_{(n, 1),(n+1,1)}+\sum_{m=1}^{M-1} \gamma_{(N, m),(N, m+1)}\right.\right.\\
&amp;\left.\left.+\sum_{n=1}^{N-1} \gamma_{(n+1, M),(n, M)}+\sum_{m=1}^{M-1} \gamma_{(1, m+1),(1, m)}\right)\right]
\end{aligned}
\]</span> as shown in Fig. 2.1. Although the Berry phase is a gauge invariant quantity, calculating it according to the recipe above involves multiplying together many gauge dependent complex numbers. The alternative route, via Eq. (2.6), involves multiplying gauge independent matrices, and then taking the trace.</p>
<p>There is a way to break the calculation of the Berry phase of the loop down to a product of gauge independent complex numbers. To each plaquette (elementary square) on the grid, with <span class="math inline">\(n, m\)</span> indexing the lower left corner, we define the Berry flux <span class="math inline">\(F_{n, m}\)</span> of the plaquette using the sum of the relative phases around its boundary, <span class="math display">\[
\begin{aligned}
F_{n m}=-\arg \exp \left[-i\left(\gamma_{(n, m),(n+1, m)}\right.\right.&amp;+\gamma_{(n+1, m),(n+1, m+1)} \\
+&amp;\left.\left.\gamma(n+1, m+1),(n, m+1)+\gamma_{(n, m+1),(n, m)}\right)\right],
\end{aligned}
\]</span> for <span class="math inline">\(n=1, \ldots, N\)</span> and <span class="math inline">\(m=1, \ldots, M\)</span>. Note that the Berry flux is itself a Berry phase and is therefore gauge invariant. Alternatively, we can also write <span class="math display">\[
\begin{array}{r}
F_{n m}=-\arg \left(\left\langle\Psi_{n, m} \mid \Psi_{n+1, m}\right\rangle\left\langle\Psi_{n+1, m} \mid \Psi_{n+1, m+1}\right\rangle\right. \\
\left.\left\langle\Psi_{n+1, m+1} \mid \Psi_{n, m+1}\right\rangle\left\langle\Psi_{n, m+1} \mid \Psi_{n, m}\right\rangle\right)
\end{array}
\]</span> Now consider the product of all plaquette phase factors <span class="math inline">\(e^{-i F_{n m}}\)</span> <span class="math display">\[
\begin{array}{c}
\prod_{n=1}^{N-1} \prod_{m=1}^{M-1} e^{-i F_{n m}}=\exp \left[-i \sum_{n=1}^{N-1} \sum_{m=1}^{M-1} F_{n m}\right]=\exp \left[-i \sum_{n=1}^{N-1} \sum_{m=1}^{M-1}\left(\gamma_{(n, m),(n+1, m)}\right.\right. \\
\left.\left.+\gamma_{(n+1, m),(n+1, m+1)}+\gamma_{(n+1, m+1),(n, m+1)}+\gamma_{(n, m+1),(n, m)}\right)\right]
\end{array}
\]</span> Each internal edge of the lattice is shared between two plaquettes, and therefore occurs twice in the product. However, since we fixed the orientation of the plaquette phases, these two contributions will always be complex conjugates of each other, and cancel each other. Therefore the exponent in the right-hand-side of Eq. <span class="math inline">\((2.10)\)</span> simplifies to the exponent appearing in Eq. (2.7), implying <span class="math display">\[
\exp \left[-i \sum_{n=1}^{N-1} \sum_{m=1}^{M-1} F_{n m}\right]=e^{-i \gamma_{L}}
\]</span> This result is reminiscent of the Stokes theorem connecting the integral of the curl of a vector field on an open surface and the line integral of the vector field along the boundary of the surface. In Eq. (2.11), the sum of the relative phases, i.e., the Berry phase <span class="math inline">\(\gamma_{L}\)</span>, plays the role of the line integral, whereas the double sum of the Berry fluxes plays the role of the surface integral. There is an important difference with respect to the Stokes theorem, namely, the equality of the total Berry flux and the Berry phase is not guaranteed: Eq. ( <span class="math inline">\(2.11\)</span> ) only tells that they are either equal or have a difference of <span class="math inline">\(2 \pi\)</span> times an integer.</p>
<h4 id="chern-number">2.1.4 Chern Number</h4>
<p>Consider states in a Hilbert space arranged on a grid as above, <span class="math inline">\(\left|\Psi_{n, m}\right\rangle\)</span>, with <span class="math inline">\(n, m \in Z\)</span>, <span class="math inline">\(1 \leq n \leq N\)</span>, and <span class="math inline">\(1 \leq m \leq M\)</span>, but now imagine this grid to be on the surface of a torus. We use the same definition for the Berry flux per plaquette as in <span class="math inline">\((2.9)\)</span>, but now with <span class="math inline">\(n \bmod N+1\)</span> in place of <span class="math inline">\(n+1\)</span> and <span class="math inline">\(m \bmod M+1\)</span> in place of <span class="math inline">\(m+1\)</span> The product of the Berry flux phase factors of all plaquettes is now 1 . <span class="math display">\[
\prod_{m=1}^{M} \prod_{n=1}^{N} e^{-i F_{n m}}=1
\]</span> The same derivation can be applied as for Eq. (2.11) above, but now every edge is an internal edge, and so all contributions to the product cancel.</p>
<p>The Chern number <span class="math inline">\(Q\)</span> associated to our structure is defined via the sum of the Berry fluxes of all the plaquettes forming the closed torus surface: <span class="math display">\[
Q=\frac{1}{2 \pi} \sum_{n m} F_{n m}
\]</span> The fact that the Chern number <span class="math inline">\(Q\)</span> is defined via the gauge invariant Berry fluxes ensures that <span class="math inline">\(Q\)</span> itself is gauge invariant. Furthermore, taking the arg of Eq. (2.12) proves that the Chern number <span class="math inline">\(Q\)</span> is an integer.</p>
<p>It is worthwhile to look a little deeper into the discrete formula for the Chern number. We can define modified Berry fluxes <span class="math inline">\(\tilde{F}_{n m}\)</span> as <span class="math inline">\(\tilde{F}_{n m}=\gamma_{(n, m),(n+1, m)}+\gamma_{(n+1, m),(n+1, m+1)}+\gamma_{(n+1, m+1),(n, m+1)}+\gamma_{(n, m+1),(n, m)}\)</span> Since each edge is shared between two neighboring plaquettes, the sum of the modified Berry fluxes over all plaquettes vanishes. <span class="math display">\[
\sum_{m=1}^{M} \sum_{n=1}^{N} \tilde{F}_{n m}=0
\]</span> If <span class="math inline">\(-\pi \leq \tilde{F}_{n m}&lt;\pi\)</span>, then we have <span class="math inline">\(\tilde{F}_{n m}=F_{n m} .\)</span> However, <span class="math inline">\(\tilde{F}_{n m}\)</span> can be outside the range <span class="math inline">\([-\pi, \pi):\)</span> then as the logarithm is taken in Eq. (2.8), <span class="math inline">\(F_{n m}\)</span> is taken back into <span class="math inline">\([-\pi, \pi)\)</span> by adding a (positive or negative) integer multiple of <span class="math inline">\(2 \pi .\)</span> In that case, we say the plaquette <span class="math inline">\(n m\)</span> contains a number <span class="math inline">\(Q_{n m} \in Z\)</span> of vortices, with <span class="math display">\[
Q_{n m}=\frac{F_{n m}-\tilde{F}_{n m}}{2 \pi} \in Z
\]</span> We have found a simple picture for the Chern number: The Chern number <span class="math inline">\(Q\)</span>, that is, the sum of the Berry fluxes of all the plaquettes of a closed surface, is the number of vortices on the surface, <span class="math display">\[
Q=\frac{1}{2 \pi} \sum_{n m} F_{n m}=\sum_{n m} Q_{n m} \in Z .
\]</span> Although we proved it here for the special case of a torus, the derivation is easily generalized to all orientable closed surfaces. We focused on the torus, because this construction can be used as a very efficient numerical recipe to discretize and calculate the (continuum) Chern number of a 2-dimensional insulator [12], to be defined in Sect. <span class="math inline">\(2.2 .4\)</span></p>
<h2 id="continuum-case">2.2 Continuum Case</h2>
<p>We now assume that instead of a discrete set of states, <span class="math inline">\(\left.\left\{\mid \Psi_{j}\right\}\right\}\)</span>, we have a continuum, <span class="math inline">\(|\Psi( R )\rangle\)</span>, where the R's are elements of some <span class="math inline">\(D\)</span> -dimensional parameter space <span class="math inline">\(P\)</span></p>
<h4 id="berry-connection">Berry Connection</h4>
<p>We take a smooth directed path <span class="math inline">\(C\)</span>, i.e., a curve in the parameter space <span class="math inline">\(P\)</span>, <span class="math display">\[
E :[0,1) \rightarrow P , \quad t \mapsto R (t) .
\]</span> We assume that all components of <span class="math inline">\(|\Psi( R )\rangle\)</span> are smooth, at least in an open neighborhood of the curve <span class="math inline">\(C\)</span>. The relative phase between two neighbouring states on the curve <span class="math inline">\(C\)</span>, corresponding to the parameters <span class="math inline">\(R\)</span> and <span class="math inline">\(R +d R\)</span>, is <span class="math display">\[
e^{-i \Delta \gamma}=\frac{\langle\Psi( R ) \mid \Psi( R +d R )\rangle}{|\langle\Psi( R ) \mid \Psi( R +d R )\rangle|} ; \quad \Delta \gamma=i\left\langle\Psi( R )\left|\nabla_{ R }\right| \Psi( R )\right\rangle \cdot d R
\]</span> obtained to first order in <span class="math inline">\(d R \rightarrow 0\)</span>. The quantity multiplying <span class="math inline">\(d R\)</span> on the right-hand side defines the Berry connection, <span class="math display">\[
A ( R )=i\left\langle\Psi( R ) \mid \nabla_{ R } \Psi( R )\right\rangle=-\operatorname{Im}\left\langle\Psi( R ) \mid \nabla_{ R } \Psi( R )\right\rangle
\]</span> Here <span class="math inline">\(\left|\nabla_{ R } \Psi( R )\right\rangle\)</span> is defined by requiring for every Hilbert space vector <span class="math inline">\(|\Phi\rangle\)</span>, that <span class="math display">\[
\left\langle\Phi \mid \nabla_{ R } \Psi( R )\right\rangle=\nabla_{ R }\langle\Phi \mid \Psi( R )\rangle .
\]</span> The second equality in Eq. (2.20) follows from the conservation of the norm, <span class="math inline">\(\nabla_{ R }\langle\Psi( R ) \mid \Psi( R )\rangle=0\)</span> We have seen in the discrete case that the relative phase of two states is not gauge invariant; neither is the Berry connection. Under a gauge transformation, it changes as <span class="math display">\[
|\Psi( R )\rangle \rightarrow e^{i \alpha( R )}|\Psi( R )\rangle: \quad A ( R ) \rightarrow A ( R )-\nabla_{ R } \alpha( R )
\]</span> #### 2.2.2 Berry Phase</p>
<p>Consider a closed directed curve <span class="math inline">\(C\)</span> in parameter space. The Berry phase along the curve is defined as <span class="math display">\[
\gamma( E )=-\arg \exp \left[-i \oint_{ E } A \cdot d R \right]
\]</span> The Berry phase of a closed directed curve is gauge invariant, since it can be interpreted as a limiting case of the discrete Berry phase, via Eqs. (2.20), (2.19), and <span class="math inline">\((2.5)\)</span>, and the latter has been shown to be gauge invariant.</p>
<h4 id="berry-curvature">2.2.3 Berry Curvature</h4>
<p>As in the discrete case above, we would like to express the gauge invariant Berry phase as a surface integral of a gauge invariant quantity. This quantity is the Berry curvature. Similarly to the discrete case, we consider a two-dimensional parameter space, and for simplicity denote the parameters as <span class="math inline">\(x\)</span> and <span class="math inline">\(y .\)</span> We take a simply connected region <span class="math inline">\(F\)</span> in this two-dimensional parameter space, with the oriented boundary curve of this surface denoted by <span class="math inline">\(\partial F\)</span>, and consider the continuum Berry phase corresponding to the boundary.</p>
<h5 id="smoothness-of-the-manifold-of-states">2.2.3.1 Smoothness of the Manifold of States</h5>
<p>Before relating the Berry phase to the Berry curvature, an important note on the manifold <span class="math inline">\(|\Psi( R )\rangle\)</span> of considered states is in order. From now on, we consider a manifold of states, living in our two-dimensional parameter space, that is smooth, in the sense that the map <span class="math inline">\(R \mapsto|\Psi( R )\rangle\langle\Psi( R )|\)</span> is smooth. Importantly, this condition does not necessarily imply that that the function <span class="math inline">\(R \mapsto|\Psi( R )\rangle\)</span>, also referred to as a gauge describing our manifold, is smooth. (For further discussion and examples, see Sect. 2.5.1.) Nevertheless, even if the gauge <span class="math inline">\(R \mapsto|\Psi( R )\rangle\)</span> is not smooth in a</p>
<p>point <span class="math inline">\(R _{0}\)</span> of the parameter space, one can always find an alternative gauge <span class="math inline">\(\left|\Psi^{\prime}( R )\right\rangle\)</span> which is (i) locally smooth, that is, smooth in the point <span class="math inline">\(R _{0}\)</span>, and (ii) locally generates the same map as <span class="math inline">\(|\Psi( R )\rangle\)</span>, that is, for which <span class="math inline">\(\left|\Psi^{\prime}( R )\right\rangle\left\langle\Psi^{\prime}( R )|=| \Psi( R )\right\rangle\langle\Psi( R )\)</span> in an infinitesimal neighborhood of <span class="math inline">\(R _{0}\)</span>. Let us formulate an intuitive argument supporting the latter claim using quantum-mechanical perturbation theory. Take the Hamiltonian <span class="math inline">\(\hat{H}( R )=-|\Psi( R )\rangle\langle\Psi( R )|\)</span>, which can be substituted in the infinitesimal neighborhood of <span class="math inline">\(R _{0}\)</span> with <span class="math inline">\(\hat{H}\left( R _{0}+\Delta R \right)=\hat{H}\left( R _{0}\right)+\Delta R \cdot(\nabla \hat{H})\left( R _{0}\right)\)</span> According to first-order perturbation theory, the ground state of the latter is given by <span class="math display">\[
\left|\Psi^{\prime}\left( R _{0}+\Delta R \right)\right\rangle=\left|\Psi\left( R _{0}\right)\right\rangle-\sum_{n=2}^{D}\left|\Psi_{n}\left( R _{0}\right)\right\rangle\left\langle\Psi_{n}\left( R _{0}\right)\left|\Delta R \cdot(\nabla \hat{H})\left( R _{0}\right)\right| \Psi\left( R _{0}\right)\right\rangle,
\]</span> where the states <span class="math inline">\(\left|\Psi_{n}\left( R _{0}\right)\right\rangle(n=2,3, \ldots, D)\)</span>, together with <span class="math inline">\(\left|\Psi\left( R _{0}\right)\right\rangle\)</span>, form a basis of the Hilbert space. On the one hand, Eq. (2.24) defines a function that is smooth in <span class="math inline">\(R _{0}\)</span>, hence the condition (i) above is satisfied. On the other hand, as <span class="math inline">\(\left|\Psi^{\prime}\left( R _{0}+\Delta R \right)\right\rangle\)</span> is the ground state of <span class="math inline">\(\hat{H}\left( R _{0}+\Delta R \right)\)</span>, condition (ii) is also satisfied.</p>
<h5 id="berry-phase-and-berry-curvature">2.2.3.2 Berry Phase and Berry Curvature</h5>
<p>Now return to our original goal and try to express the Berry phase as a surface integral of a gauge invariant quantity. We start by relating the Berry phase to its discrete counterpart: <span class="math display">\[
\oint_{\partial, F } A \cdot d R =\lim _{\Delta x, \Delta y \rightarrow 0} \gamma_{\partial F },
\]</span> where we discretize the parameter space using a square grid of steps <span class="math inline">\(\Delta x, \Delta y\)</span>, and express the integral as the discrete Berry phase <span class="math inline">\(\gamma_{\partial F }\)</span> of a loop approximating <span class="math inline">\(\partial F\)</span>, in the limit of an infinitesimally fine grid. Then, from Eq. (2.25) and the Stokes-type theorem in Eq. (2.11), we obtain <span class="math display">\[
\exp \left[-i \oint_{\partial F } A \cdot d R \right]=\lim _{\Delta x, \Delta y \rightarrow 0} e^{-i \sum_{n m} F_{n m}}
\]</span> where the <span class="math inline">\(n m\)</span> sum goes for the plaquettes forming the open surface <span class="math inline">\(F\)</span>. Furthermore, let us take a gauge <span class="math inline">\(\left|\Psi^{\prime}( R )\right\rangle\)</span> and the corresponding Berry connection <span class="math inline">\(A ^{\prime}\)</span> that is smooth in the plaquette <span class="math inline">\(n m ;\)</span> this could be <span class="math inline">\(|\Psi( R )\rangle\)</span> and <span class="math inline">\(A\)</span> if that was already smooth. Then, due to the gauge invariance of the Berry flux we have <span class="math display">\[
e^{-i F_{n m}}=e^{-i F_{n m}^{\prime}}
\]</span> where <span class="math inline">\(F_{n m}^{\prime}\)</span> is the Berry flux corresponding to the locally smooth gauge. Furthermore, in the limit of an infinitely fine grid it holds that <span class="math display">\[
\begin{aligned}
F_{n m}^{\prime} &amp;=A_{x}^{\prime}\left(x_{n}+\frac{\Delta x}{2}, y_{m}\right) \Delta x+A_{y}^{\prime}\left(x_{n+1}, y_{m}+\frac{\Delta y}{2}\right) \Delta y \\
&amp;-A_{x}^{\prime}\left(x_{n}+\frac{\Delta x}{2}, y_{m+1}\right) \Delta x-A_{y}^{\prime}\left(x_{n}, y_{m}+\frac{\Delta y}{2}\right) \Delta y .
\end{aligned}
\]</span> Taylor expansion of the Berry connection around <span class="math inline">\(R _{n m}=\left(x_{n}+\frac{\Delta x}{2}, y_{n}+\frac{\Delta y}{2}\right)\)</span> to first order yields <span class="math display">\[
F_{n m}^{\prime}=\left[\partial_{x} A_{y}^{\prime}\left( R _{n m}\right)-\partial_{y} A_{x}^{\prime}\left( R _{n m}\right)\right] \Delta x \Delta y .
\]</span> Thereby, with the definition of the Berry curvature as <span class="math display">\[
B=\lim _{\Delta x, \Delta y \rightarrow 0} \frac{F_{n m}^{\prime}}{\Delta x \Delta y},
\]</span> we obtain a quantity that is gauge invariant, as it is defined via the gauge invariant Berry flux, and is related to the Berry connection via <span class="math display">\[
B=\partial_{x} A_{y}^{\prime}\left( R _{n m}\right)-\partial_{y} A_{x}^{\prime}\left( R _{n m}\right)
\]</span> We can rephrase Eq. (2.29) as follows: the Berry flux for the <span class="math inline">\(n m\)</span> plaquette is expressed as the product of the Berry curvature on the plaquette and the surface area of the plaquette. Substituting Eqs. (2.27) and (2.29) into Eq. (2.26) yields <span class="math display">\[
\exp \left[-i \oint_{\partial F } A \cdot d R \right]=\exp \left[-i \int_{ F } B(x, y) d x d y\right]
\]</span> which is the continuum version of the result (2.11). Equation ( <span class="math inline">\(2.32\)</span> ) can also be rephrased as <span class="math display">\[
\gamma(\partial F )=-\arg e^{-i \int_{ A } B(x, y) d x d y}
\]</span> ##### 2.2.3.3 A Special Case Where the Usual Stokes Theorem Works</p>
<p>A shortcut towards a stronger result than Eq. (2.32) is offered in the special case when <span class="math inline">\(|\Psi( R )\rangle\)</span> is smooth on the open surface <span class="math inline">\(F\)</span>. Then, a direct application of the two-dimensional Stokes theorem implies <span class="math display">\[
\oint_{\partial F } A \cdot d R =\int_{ F }\left(\partial_{x} A_{y}-\partial_{y} A_{x}\right) d x d y=\int_{ F } B d x d y
\]</span> Summarizing Eqs. (2.32) and (2.34), we can say that line integral of the Berry connection equals the surface integral of the Berry curvature if the set of states <span class="math inline">\(|\Psi( R )\rangle\)</span> is smooth on <span class="math inline">\(F\)</span>, but they might differ with an integer multiple of <span class="math inline">\(2 \pi\)</span> otherwise.</p>
<h5 id="the-case-of-the-three-dimensional-parameter-space">2.2.3.4 The Case of the Three-Dimensional Parameter Space</h5>
<p>Let us briefly discuss also the case of a three-dimensional parameter space. This will be particularly useful in the context of two-level systems. Starting with the case when the gauge <span class="math inline">\(|\Psi( R )\rangle\)</span> on the two-dimensional open surface <span class="math inline">\(F\)</span> embedded in the three-dimensional parameter space is smooth in the neighborhood of <span class="math inline">\(F\)</span>, we can directly apply the three-dimensional Stokes theorem to convert the line integral of A to the surface integral of the curl of A to obtain <span class="math display">\[
\oint_{\partial F } A \cdot d R =\int_{ F } B \cdot d S
\]</span> where the Berry curvature is defined as the vector field <span class="math inline">\(B ( R )\)</span> via <span class="math display">\[
B ( R )=\nabla_{ R } \times A ( R )
\]</span> which is gauge invariant as in the two-dimensional case. Even if <span class="math inline">\(|\Psi( R )\rangle\)</span> is not smooth on <span class="math inline">\(F\)</span>, the relation holds, similarly to the two-dimensional result Eq. (2.32). Note furthermore that the Berry phase <span class="math inline">\(\gamma(\partial F )\)</span> for a fixed boundary curve <span class="math inline">\(\partial F\)</span> is not only gauge invariant, but also invariant against continuous deformations of the two-dimensional surface <span class="math inline">\(F\)</span> embedded in three dimensions, as long as the Berry curvature is smooth everywhere along the way.</p>
<p>We also remark that although we used the three-dimensional notation here, but the above results can be generalized for any dimensionality of the parameter space. The notation <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> for the Berry connection and Berry curvature suggest that they are much like the vector potential and the magnetic field. This is a useful analogy, for instance, <span class="math inline">\(\nabla_{ R } B =0\)</span>, from the definition ( <span class="math inline">\(2.36\)</span> ). Nevertheless, it is not true that in every problem where the Berry curvature is nonzero, there is a physical magnetic field.</p>
<h4 id="chern-number-1">2.2.4 Chern Number</h4>
<p>In the discrete case, we defined the Chern number as a sum of Berry fluxes for a square lattice living on a torus (or any other orientable closed surface). Here, we take a continuum parameter space that has the topology of a torus. The motivation is that certain physical parameter spaces in fact have this torus topology, and the corresponding Chern number does have physical significance. One example will be the Brillouin zone of a two-dimensional lattice representing a solid crystalline material. where the momentum vectors <span class="math inline">\(\left(k_{x}, k_{y}\right),\left(k_{x}+2 \pi, k y\right)\)</span>, and <span class="math inline">\(\left(k_{x}, k_{v}+2 \pi\right)\)</span> are equivalent.</p>
<p>Quite naturally, in the continuum definition of the Chern number, the sum of Berry fluxes is replaced by the surface integral of the Berry curvature over the whole of the parameter space <span class="math inline">\(P\)</span>. <span class="math display">\[
Q=-\frac{1}{2 \pi} \int_{ P } B d x d y
\]</span> As this can be interpreted as a continuum limit of the discrete Chern number, it inherits the properties of the latter: the continuum Chern number is a gauge invariant integer.</p>
<p>For future reference, let us lay down the notation to be used for calculating the Chern numbers of electronic energy bands in two-dimensional crystals. Consider a square lattice for simplicity, which has a square-shaped Brillouin zone as well. Our parameter space <span class="math inline">\(P\)</span> is the two-dimensional Brillouin zone now, which has a torus topology as discussed above. The parameters are the Cartesian components <span class="math inline">\(k_{x}, k_{y} \in[-\pi, \pi)\)</span> of the momentum vector <span class="math inline">\(k\)</span>. The electronic energy bands and the corresponding electron wavefunctions can be obtained from the bulk momentumspace Hamiltonian <span class="math inline">\(\hat{H}\left(k_{x}, k_{y}\right)\)</span>. The latter defines the Schrödinger equation <span class="math display">\[
\hat{H}( k )\left|u_{n}( k )\right\rangle=E_{n}( k )\left|u_{n}( k )\right\rangle
\]</span> where <span class="math inline">\(n=1,2, \ldots\)</span> is the band index, which has as many possible values as the dimension of the Hilbert space of the internal degree of freedom of our lattice model. Note that defining the Berry connection, the Berry curvature and the Chern number for the <span class="math inline">\(n\)</span> th band is possible only if that band is separated from other bands by energy gaps. The Berry connection of the <span class="math inline">\(n\)</span> th band, in line with the general definition <span class="math inline">\((2.20)\)</span>, reads <span class="math display">\[
A_{j}^{(n)}( k )=i\left\langle u_{n}( k )\left|\partial_{k_{j}}\right| u_{n}( k )\right\rangle, \quad \text { for } \quad j=x, y
\]</span> The Chern number of the <span class="math inline">\(n\)</span> th band, in correspondence with Eqs. (2.38) and (2.31), reads <span class="math display">\[
Q^{(n)}=-\frac{1}{2 \pi} \int_{B Z} d k_{x} d k_{y}\left(\frac{\partial A_{y}^{(n)}}{\partial k_{x}}-\frac{\partial A_{x}^{(n)}}{\partial k_{y}}\right)
\]</span> Certain approximations of the band structure theory of electrons provide lowdimensional momentum-space Hamiltonians that can be diagonalized analytically, allowing for an analytical derivation of the Chern numbers of the electronic bands. More often, however, the electronic wave functions are obtained from numerical techniques on a finite-resolution grid of <span class="math inline">\(\left(k_{x}, k_{y}\right)\)</span> points in the Brillouin zone. In that case, the Chern number of a chosen band can still be effectively evaluated using the discrete version of its definition ( <span class="math inline">\(2.13\)</span> ).</p>
<p>The Chern number of a band of an insulator is a topological invariant in the following sense. One can imagine that the Hamiltonian describing the electrons on the lattice is deformed adiabatically, that is, continuously and with the energy gaps separating the <span class="math inline">\(n\)</span> th band from the other bands kept open. In this case, the Berry curvature varies continuously, and therefore its integral for the Brillouin zone, which is the Chern number, cannot change as the value of the latter is restricted to integers. If the deformation of the crystal Hamiltonian is such that some energy gaps separating the <span class="math inline">\(n\)</span> th band from a neighboring band is closed and reopened, that is, the deformation of the Hamiltonian is not adiabatic, then the Chern number might change. In this sense, the Chern number is a similar topological invariant for twodimensional lattice models as the winding number is for the one-dimensional SSH model.</p>
<h2 id="berry-phase-and-adiabatic-dynamics">2.3 Berry Phase and Adiabatic Dynamics</h2>
<p>In most physical situations of interest, the set of states whose geometric features (Berry phases) we are interested in are eigenstates of some Hamiltonian <span class="math inline">\(\hat{H}\)</span>. Take a physical system with <span class="math inline">\(D\)</span> real parameters that are gathered into a formal vector <span class="math inline">\(R =\)</span> <span class="math inline">\(\left(R_{1}, R_{2}, \ldots, R_{D}\right) .\)</span> The Hamiltonian is a smooth function <span class="math inline">\(\hat{H}( R )\)</span> of the parameters, at least in the region of interest. We order the eigenstates of the Hamiltonian according to the energies <span class="math inline">\(E_{n}( R )\)</span>, <span class="math display">\[
\hat{H}( R )|n( R )\rangle=E_{n}( R )|n( R )\rangle .
\]</span> We call the set of eigenstates <span class="math inline">\(|n( R )\rangle\)</span> the snapshot basis The definition of the snapshot basis involves gauge fixing, i.e., specifying the otherwise arbitrary phase prefactor for every <span class="math inline">\(|n( R )\rangle .\)</span> This can be a tricky issue: even in cases where a gauge exists where all elements of the snapshot basis are smooth functions of the parameters, this gauge might be very challenging to construct. We consider the following problem. We assume that the system is initialized with <span class="math inline">\(R = R _{0}\)</span> and in an eigenstate <span class="math inline">\(\left|n\left( R _{0}\right)\right\rangle\)</span> that is in the discrete part of the spectrum, i.e. <span class="math inline">\(E_{n}( R )-E_{n-1}( R )\)</span> and <span class="math inline">\(E_{n+1}( R )-E_{n}( R )\)</span> are nonzero. At time <span class="math inline">\(t=0\)</span> we thus have <span class="math display">\[
R (t=0)= R _{0} ; \quad|\psi(t=0)\rangle=\left|n\left( R _{0}\right)\right\rangle
\]</span> Now assume that during the time <span class="math inline">\(t=0 \rightarrow T\)</span> the parameter vector <span class="math inline">\(R\)</span> is slowly changed: <span class="math inline">\(R\)</span> becomes <span class="math inline">\(R (t)\)</span>, and the values of <span class="math inline">\(R (t)\)</span> define a continuous directed curve <span class="math inline">\(C\)</span>. Also, assume that <span class="math inline">\(|n( R )\rangle\)</span> is smooth along the curve <span class="math inline">\(C .\)</span> The state of the system evolves according to the time-dependent Schrödinger equation: <span class="math display">\[
i \frac{d}{d t}|\psi(t)\rangle=\hat{H}( R (t))|\psi(t)\rangle .
\]</span> Further, assume that <span class="math inline">\(R\)</span> is varied in such a way that at all times the energy gaps around the state <span class="math inline">\(|n( R (t))\rangle\)</span> remain finite. We can then choose the rate of variation of <span class="math inline">\(R (t)\)</span> along the path <span class="math inline">\(C\)</span> to be slow enough compared to the frequencies corresponding to the energy gap, so the adiabatic approximation holds In that case, the system remains in the energy eigenstate <span class="math inline">\(|n( R (t))\rangle\)</span>, only picking up a phase. We are now going to find this phase. By virtue of the adiabatic approximation, we take as Ansatz <span class="math display">\[
|\psi(t)\rangle=e^{i \gamma_{n}(t)} e^{-i \int_{0}^{t} E_{n}\left( R \left(t^{\prime}\right)\right) d t^{\prime}}|n( R (t))\rangle
\]</span> For better readability, in the following we often drop the <span class="math inline">\(t\)</span> argument where this leads to no confusion. The time derivative of Eq. <span class="math inline">\((2.45)\)</span> reads <span class="math display">\[
i \frac{d}{d t}|\psi(t)\rangle=e^{i \gamma_{n}} e^{-i \int_{0}^{t} E_{n}\left( R \left(t^{\prime}\right)\right) d t^{\prime}}\left(-\frac{d \gamma_{n}}{d t}|n( R )\rangle+E_{n}( R )|n( R )\rangle+i\left|\frac{d}{d t} n( R )\right\rangle\right)
\]</span> To show what we mean by <span class="math inline">\(\left|\frac{d}{d t} n( R (t))\right\rangle\)</span>, we write it out explicitly in terms of a fixed basis, that of the eigenstates at <span class="math inline">\(R = R _{0}\)</span> : <span class="math display">\[
\begin{aligned}
|n( R )\rangle &amp;=\sum_{m} c_{m}( R )\left|m\left( R _{0}\right)\right\rangle \\
\left|\frac{d}{d t} n( R (t))\right\rangle &amp;=\frac{d R }{d t} \cdot\left|\nabla_{ R } n( R )\right\rangle=\frac{d R }{d t} \sum_{m} \nabla_{ R } c_{m}( R )\left|m\left( R _{0}\right)\right\rangle
\end{aligned}
\]</span> We insert the Ansatz ( <span class="math inline">\(2.45\)</span> ) into the right hand side of the Schrödinger equation (2.44), use the snapshot eigenvalue relation (2.42), simplify and reorder the Schrödinger equation, and obtain <span class="math display">\[
-\frac{d \gamma_{n}}{d t}|n( R )\rangle+i\left|\frac{d}{d t} n( R )\right\rangle=0
\]</span> Multiplying from the left by <span class="math inline">\(\langle n( R )|\)</span>, and using Eq. <span class="math inline">\((2.48)\)</span>, we obtain <span class="math display">\[
\frac{d}{d t} \gamma_{n}(t)=i \langle n( R (t)) \mid \frac{d}{d t} n( R (t)) \rangle=\frac{d R }{d t} i\left\langle n( R ) \mid \nabla_{ R } n( R )\right\rangle .
\]</span> We have found that for the directed curve <span class="math inline">\(C\)</span> in parameter space, traced out by <span class="math inline">\(R (t)\)</span>, there is an adiabatic phase <span class="math inline">\(\gamma_{n}( C )\)</span>, which reads <span class="math display">\[
\gamma_{n}( C )=\int_{ E } i\left\langle n( R ) \mid \nabla_{ R } n( R )\right\rangle d R
\]</span> A related result is obtained after a similar derivation, if the parameter space of the <span class="math inline">\(R\)</span> points is omitted and the snapshot basis <span class="math inline">\(|n(t)\rangle\)</span> is parametrized directly by the time variable. Then, the adiabatic phase is <span class="math display">\[
\gamma_{n}(t)=\int_{0}^{t} i\left\langle n\left(t^{\prime}\right) \mid \partial_{t^{\prime}} n\left(t^{\prime}\right)\right\rangle d t^{\prime} .
\]</span> Equation <span class="math inline">\((2.51)\)</span> allows us to formulate the key message of this section as the following. Consider the case of an adiabatic and cyclic change of the Hamiltonian, that is, when the curve <span class="math inline">\(C\)</span> is closed, implying <span class="math inline">\(R (T)= R _{0}\)</span>. In this case, the adiabatic phase reads <span class="math display">\[
\gamma_{n}( E )=\oint_{ E } i\left\langle n( R ) \mid \nabla_{ R } n( R )\right\rangle d R
\]</span> Therefore, the adiabatic phase picked up by the state during a cyclic adiabatic change of the Hamiltonian is equivalent to the Berry phase corresponding to the closed oriented curve representing the Hamiltonian's path in the parameter space. Two further remarks are in order. First, on the face of it, our derivation seems to do too much. It seems that we have produced an exact solution of the Schrödinger equation. Where did we use the adiabatic approximation? In fact, Eq. <span class="math inline">\((2.50)\)</span> does not imply Eq. (2.49). For the more complete derivation, showing how the nonadiabatic terms appear, see [15].</p>
<p>The second remark concerns the measurability of the Berry phase. The usual way to experimentally detect phases is by an interferometric setup. This means coherently splitting the wavefunction of the system into two parts, taking them through two adiabatic trips in parameter space, via <span class="math inline">\(R (t)\)</span> and <span class="math inline">\(R ^{\prime}(t)\)</span>, and bringing the parts back together. The interference only comes from the overlap between the states: it is maximal if <span class="math inline">\(|n( R (T))\rangle=\left|n\left( R ^{\prime}(T)\right)\right\rangle\)</span>, which is typically ensured if <span class="math inline">\(R (T)= R ^{\prime}(T)\)</span>. The difference in the adiabatic phases <span class="math inline">\(\gamma_{n}\)</span> and <span class="math inline">\(\gamma_{n}^{\prime}\)</span> is the adiabatic phase associated with the closed loop <span class="math inline">\(C\)</span>, which is the path obtained by going forward along <span class="math inline">\(t=0 \rightarrow T: R (t)\)</span>, then coming back along <span class="math inline">\(t=T \rightarrow 0:\)</span> <span class="math inline">\(R ^{\prime}(t) .\)</span></p>
<h2 id="berrys-formulas-for-the-berry-curvature">2.4 Berry's Formulas for the Berry Curvature</h2>
<p>Berry provided [6] two practical formulas for the Berry curvature. Here we present them in a form corresponding to a three-dimensional parameter space. To obtain the two-dimensional case, where the Berry curvature <span class="math inline">\(B\)</span> is a scalar, one can identify the latter with the component <span class="math inline">\(B_{z}\)</span> of the three-dimensional case treated below; for generalization to higher than 3 dimensions, see the discussion in Berry's paper [6]. First, <span class="math display">\[
B_{j}=-\operatorname{Im} \epsilon_{j k l} \partial_{k}\left\langle n \mid \partial_{l} n\right\rangle=-\operatorname{Im} \epsilon_{j k l}\left\langle\partial_{k} n \mid \partial_{l} n\right\rangle+0
\]</span> where the second term is 0 because <span class="math inline">\(\partial_{k} \partial_{l}=\partial_{l} \partial_{k}\)</span> but <span class="math inline">\(\epsilon_{j k l}=-\epsilon_{j l k}\)</span> To obtain Berry's second formula, inserting a resolution of identity in the snapshot basis in the above equation, we obtain <span class="math display">\[
B ^{(n)}=-\operatorname{Im} \sum_{n^{\prime} \neq n}\left\langle\nabla n \mid n^{\prime}\right\rangle \times\left\langle n^{\prime} \mid \nabla n\right\rangle,
\]</span> where the parameter set <span class="math inline">\(R\)</span> is suppressed for brevity. The term with <span class="math inline">\(n^{\prime}=n\)</span> is omitted from the sum, as it is zero, since because of the conservation of the norm, <span class="math inline">\(\langle\nabla n \mid n\rangle=\)</span> <span class="math inline">\(-\langle n \mid \nabla n\rangle .\)</span> To calculate <span class="math inline">\(\left\langle n^{\prime} \mid \nabla n\right\rangle\)</span>, start from the definition of the eigenstate <span class="math inline">\(|n\rangle\)</span>, act on both sides with <span class="math inline">\(\nabla\)</span>, and then project unto <span class="math inline">\(\left|n^{\prime}\right\rangle\)</span> : <span class="math display">\[
\begin{aligned}
\hat{H}|n\rangle &amp;=E_{n}|n\rangle \\
(\nabla \hat{H})|n\rangle+\hat{H}|\nabla n\rangle &amp;=\left(\nabla E_{n}\right)|n\rangle+E_{n}|\nabla n\rangle \\
\left\langle n^{\prime}|\nabla \hat{H}| n\right\rangle+\left\langle n^{\prime}|\hat{H}| \nabla n\right\rangle &amp;=0+E_{n}\left\langle n^{\prime} \mid \nabla n\right\rangle .
\end{aligned}
\]</span> Act with <span class="math inline">\(\hat{H}\)</span> towards the left in Eq. (2.58), rearrange, substitute into <span class="math inline">\((2.55)\)</span>, and you obtain the second form of the Berry curvature, which is manifestly gauge invariant: <span class="math display">\[
B ^{(n)}=-\operatorname{Im} \sum_{n^{\prime} \neq n} \frac{\left\langle n|\nabla \hat{H}| n^{\prime}\right\rangle \times\left\langle n^{\prime}|\nabla \hat{H}| n\right\rangle}{\left(E_{n}-E_{n^{\prime}}\right)^{2}}
\]</span> This shows that the monopole sources of the Berry curvature, if they exist, are the points of degeneracy.</p>
<p>A direct consequence of Eq. <span class="math inline">\((2.59)\)</span>, is that the sum of the Berry curvatures of all eigenstates of a Hamiltonian is zero. If all the spectrum of <span class="math inline">\(\hat{H}( R )\)</span> is discrete</p>
<p>along a closed curve <span class="math inline">\(C\)</span>, then one can add up the Berry phases of all the energy eigenstates. <span class="math display">\[
\begin{aligned}
\sum_{n} B ^{(n)}=&amp;-\operatorname{Im} \sum_{n} \sum_{n^{\prime} \neq n} \frac{\left\langle n\left|\nabla_{ R } \hat{H}\right| n^{\prime}\right\rangle \times\left\langle n^{\prime}\left|\nabla_{ R } \hat{H}\right| n\right\rangle}{\left(E_{n}-E_{n^{\prime}}\right)^{2}} \\
=&amp;-\operatorname{Im} \sum_{n} \sum_{n^{\prime}&lt;n} \frac{1}{\left(E_{n}-E_{n^{\prime}}\right)^{2}}\left(\left\langle n\left|\nabla_{ R } \hat{H}\right| n^{\prime}\right\rangle \times\left\langle n^{\prime}\left|\nabla_{ R } \hat{H}\right| n\right\rangle\right.\\
&amp;\left.+\left\langle n^{\prime}\left|\nabla_{ R } \hat{H}\right| n\right\rangle \times\left\langle n\left|\nabla_{ R } \hat{H}\right| n^{\prime}\right\rangle\right)=0
\end{aligned}
\]</span> The last equation holds because <span class="math inline">\(a \times b =- b \times a\)</span> for any two vectors <span class="math inline">\(a , b .\)</span></p>
<h2 id="example-the-two-level-system">2.5 Example: The Two-Level System</h2>
<p>So far, most of the discussion on the Berry phase and the related concepts have been kept rather general. In this section, we illustrate these concepts via the simplest nontrivial example, that is, the two-level system.</p>
<h4 id="no-continuous-global-gauge">2.5.1 No Continuous Global Gauge</h4>
<p>Consider a Hamiltonian describing a two-level system: <span class="math display">\[
\hat{H}( d )=d_{x} \hat{\sigma}_{x}+d_{y} \hat{\sigma}_{y}+d_{z} \hat{\sigma}_{z}= d \cdot \hat{\sigma}
\]</span> with <span class="math inline">\(d =\left(d_{x}, d_{y}, d_{z}\right) \in R ^{3} \backslash\{0\} .\)</span> Here, the vector <span class="math inline">\(d\)</span> plays the role of the parameter <span class="math inline">\(R\)</span> in of preceding sections, and the parameter space is the punctured three-dimensional Euclidean space <span class="math inline">\(R ^{3} \backslash\{0\}\)</span>, to avoid the degenerate case of the energy spectrum. Note the absence of a term proportional to <span class="math inline">\(\sigma_{0}:\)</span> this would play no role in adiabatic phases. Because of the anticommutation relations of the Pauli matrices, the Hamiltonian above squares to a multiple of the identity operator, <span class="math inline">\(\hat{H}( d )^{2}= d ^{2} \sigma_{0} .\)</span> Thus, the eigenvalues of <span class="math inline">\(\hat{H}( d )\)</span> have to have absolute value <span class="math inline">\(| d |\)</span>.</p>
<p>A practical graphical representation of <span class="math inline">\(\hat{H}( d )\)</span> is the Bloch sphere, shown in Fig. 2.2. The spherical angles <span class="math inline">\(\theta \in[0, \pi)\)</span> and <span class="math inline">\(\varphi \in[0,2 \pi)\)</span> are defined as <span class="math display">\[
\cos \theta=\frac{d_{z}}{| d |} ; \quad e^{i \varphi}=\frac{d_{x}+i d_{y}}{\sqrt{d_{x}^{2}+d_{y}^{2}}} .
\]</span> We denote the two eigenstates of the Hamiltonian <span class="math inline">\(\hat{H}( d )\)</span> by <span class="math inline">\(|+ d \rangle\)</span> and <span class="math inline">\(|- d \rangle\)</span>, with <span class="math display">\[
\hat{H}( d )\left|\pm_{ d }\right\rangle=\pm| d |\left|\pm_{ d }\right\rangle
\]</span> These eigenstates depend on the direction of the 3 -dimensional vector <span class="math inline">\(d\)</span>, but not on its length. The eigenstate with <span class="math inline">\(E=+| d |\)</span> of the corresponding Hamiltonian is: <span class="math display">\[
\left|+_{ d }\right\rangle=e^{i \alpha(\theta, \varphi)}\left(\begin{array}{c}
e^{-i \varphi / 2} \cos \theta / 2 \\
e^{i \varphi / 2} \sin \theta / 2
\end{array}\right)
\]</span> while the eigenstate with <span class="math inline">\(E=-| d |\)</span> is <span class="math inline">\(\left|-_{ d }\right\rangle=e^{i \beta( d )}|+- d \rangle .\)</span> The choice of the phase factors <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> above corresponds to fixing a gauge. We will now review a few gauge choices.</p>
<p>Consider fixing <span class="math inline">\(\alpha(\theta, \varphi)=0\)</span> for all <span class="math inline">\(\theta, \varphi .\)</span> This is a very symmetric choice, in this way in formula (2.64), we find <span class="math inline">\(\theta / 2\)</span> and <span class="math inline">\(\varphi / 2\)</span>. There is problem, however, as you can see if you consider a full circle in parameter space: at any fixed value of <span class="math inline">\(\theta\)</span>, let <span class="math inline">\(\varphi=0 \rightarrow 2 \pi\)</span>. We should come back to the same Hilbert space vector, and we do, but we also pick up a phase of <span class="math inline">\(\pi\)</span>. We can either say that this choice of gauge led to a discontinuity at <span class="math inline">\(\varphi=0\)</span>, or that our representation is not single-valued. We now look at some attempts at fixing these problems, to find a gauge that is both continuous and single valued.</p>
<p>As a first attempt, let us fix <span class="math inline">\(\alpha=\varphi / 2\)</span>; denoting this gauge by subscript <span class="math inline">\(S\)</span>, we have <span class="math display">\[
|+ d \rangle_{S}=\left(\begin{array}{c}
\cos \theta / 2 \\
e^{i \varphi} \sin \theta / 2
\end{array}\right)
\]</span> The phase prefactor now gives an additional factor of <span class="math inline">\(-1\)</span> as we make the circle in <span class="math inline">\(\varphi\)</span> at fixed <span class="math inline">\(\theta\)</span>, and so it seems we have a continuous, single valued representation. There are two tricky points, however: the North Pole, <span class="math inline">\(\theta=0\)</span>, and the South Pole, <span class="math inline">\(\theta=\pi\)</span>. At the North Pole, <span class="math inline">\(|(0,0,1)\rangle_{S}=(1,0)\)</span> no problems. This gauge is problematic at the South Pole, however (which explains the choice of subscript): there, <span class="math inline">\(|(0,0,-1)\rangle_{S}=\)</span> <span class="math inline">\(\left(0, e^{i \varphi}\right)\)</span>, the value of the wavefunction depends on which direction we approach the South Pole from.</p>
<p>We can try to solve the problem at the South Pole by choosing <span class="math inline">\(\alpha=-\varphi / 2\)</span>, which gives us <span class="math display">\[
|+ d \rangle_{N}=\left(\begin{array}{c}
e^{-i \varphi} \cos \theta / 2 \\
\sin \theta / 2
\end{array}\right) .
\]</span> As you can probably already see, this representation runs into trouble at the North Pole: <span class="math inline">\(|(0,0,1)\rangle_{N}=\left(e^{-i \varphi}, 0\right)\)</span>. We can try to overcome the problems at the poles by taking linear combinations of <span class="math inline">\(|+ d \rangle_{S}\)</span> and <span class="math inline">\(|+ d \rangle_{N}\)</span>, with prefactors that vanish at the South and North Poles, respectively. A family of options is: <span class="math display">\[
\begin{aligned}
|+ d \rangle_{\chi} &amp;=e^{i \chi} \sin \frac{\theta}{2}|+ d \rangle_{S}+\cos \frac{\theta}{2}|+ d \rangle_{N} \\
&amp;=\left(\begin{array}{c}
\cos \frac{\theta}{2}\left(\cos \frac{\theta}{2}+\sin \frac{\theta}{2} e^{i \chi} e^{-i \varphi}\right) \\
\sin \frac{\theta}{2} e^{i \varphi}\left(\cos \frac{\theta}{2}+\sin \frac{\theta}{2} e^{i \chi} e^{-i \varphi}\right)
\end{array}\right)
\end{aligned}
\]</span> This is single valued everywhere, solves the problems at the Poles. However. it has its own problems: somewhere on the Equator, at <span class="math inline">\(\theta=\pi / 2, \varphi=\chi \pm \pi\)</span>, its norm disappears.</p>
<p>It is not all that surprising that we could not find a well-behaved gauge: there is none. By the end of this chapter, it should be clear, why.</p>
<h4 id="calculating-the-berry-curvature-and-the-berry-phase">2.5.2 Calculating the Berry Curvature and the Berry Phase</h4>
<p>Consider the two-level system as defined in the previous section. Take a closed curve <span class="math inline">\(C\)</span> in the parameter space <span class="math inline">\(R ^{3} \backslash\{0\} .\)</span> We are going to calculate the Berry phase <span class="math inline">\(\gamma_{-}\)</span> of the <span class="math inline">\(|- d \rangle\)</span> eigenstate on this curve: <span class="math display">\[
\gamma_{-}( C )=\oint_{ E } A ( d ) d d
\]</span> with the Berry vector potential defined as <span class="math display">\[
A ( d )=i\left\langle- d \left|\nabla_{ d }\right|- d \right\rangle .
\]</span> The calculation becomes straightforward if we use the Berry curvature, <span class="math display">\[
\begin{array}{c} 
B ( d )=\nabla_{ d } \times A ( d ) \\
\gamma_{-}( C )=\int_{ S } B ( d ) d S
\end{array}
\]</span> where <span class="math inline">\(S\)</span> is any surface whose boundary is the loop <span class="math inline">\(C\)</span>. (Alternatively, it is a worthwhile exercise to calculate the Berry phase directly in a fixed gauge, e.g., one of the three gauges introduced above.)</p>
<p>Specifically, we make use of Berry's gauge invariant formulation ( <span class="math inline">\(2.59\)</span> ) of the Berry curvature, derived in the last chapter. In the case of the generic two-level Hamiltonian (2.61), Eq. (2.59) gives <span class="math display">\[
B ^{\pm}( d )=-\operatorname{Im} \frac{\left\langle\pm\left|\nabla_{ d } \hat{H}\right| \mp\right\rangle \times\left\langle\mp\left|\nabla_{ d } \hat{H}\right| \pm\right\rangle}{4 d ^{2}}
\]</span> with <span class="math display">\[
\nabla_{ d } \hat{H}=\hat{\sigma}
\]</span> To evaluate <span class="math inline">\((2.73)\)</span>, we choose the quantization axis parallel to <span class="math inline">\(d\)</span>, thus the eigenstates simply read <span class="math display">\[
\left|+_{ d }\right\rangle=\left(\begin{array}{l}
1 \\
0
\end{array}\right) ; \quad\left|-_{ d }\right\rangle=\left(\begin{array}{l}
0 \\
1
\end{array}\right) .
\]</span> The matrix elements can now be computed as <span class="math display">\[
\left\langle-\left|\hat{\sigma}_{x}\right|+\right\rangle=\left(\begin{array}{ll}
0 &amp; 1
\end{array}\right)\left(\begin{array}{ll}
0 &amp; 1 \\
1 &amp; 0
\end{array}\right)\left(\begin{array}{l}
1 \\
0
\end{array}\right)=1
\]</span> and similarly, <span class="math display">\[
\begin{array}{l}
\left\langle-\left|\sigma_{y}\right|+\right\rangle=i ; \\
\left\langle-\left|\sigma_{z}\right|+\right\rangle=0 .
\end{array}
\]</span> So the cross product of the vectors reads <span class="math display">\[
\langle-|\hat{\sigma}|+\rangle \times\langle+|\hat{\sigma}|-\rangle=\left(\begin{array}{l}
1 \\
i \\
0
\end{array}\right) \times\left(\begin{array}{c}
1 \\
-i \\
0
\end{array}\right)=\left(\begin{array}{c}
0 \\
0 \\
2 i
\end{array}\right) .
\]</span> This gives us for the Berry curvature, <span class="math display">\[
B ^{\pm}( d )=\pm \frac{ d }{| d |} \frac{1}{2 d ^{2}}
\]</span> We can recognize in this the field of a pointlike monopole source in the origin. Alluding to the analog between the Berry curvature and the magnetic field of electrodynamics (both are derived from a "vector potential") we can refer to this field, as a "magnetic monopole". Note however that this monopole exists in the abstract space of the vectors <span class="math inline">\(d\)</span> and not in real space.</p>
<p>The Berry phase of the closed loop <span class="math inline">\(C\)</span> in parameter space, according to Eq. (2.72), is the flux of the monopole field through a surface <span class="math inline">\(S\)</span> whose boundary is <span class="math inline">\(C .\)</span> It is easy to convince yourself that this is half of the solid angle subtended by the curve. <span class="math display">\[
\gamma_{-}( E )=\frac{1}{2} \Omega_{ E }
\]</span> In other words, the Berry phase is half of the area enclosed by the image of <span class="math inline">\(C\)</span>, projected onto the surface of the unit sphere, as illustrated in Fig. <span class="math inline">\(2.2\)</span></p>
<p>What about the Berry phase of the other energy eigenstate? From Eq. (2.73), the corresponding Berry curvature <span class="math inline">\(B _{+}\)</span> is obtained by inverting the order of the factors in the cross product: this flips the sign of the cross product. Therefore the Berry phases of the ground and excited state fulfil the relation <span class="math display">\[
\gamma_{+}( E )=-\gamma_{-}( C )
\]</span> One can see the same result on the Bloch sphere. Since <span class="math inline">\(\langle+\mid-\rangle=0\)</span>, the point corresponding to <span class="math inline">\(|-\rangle\)</span> is antipodal to the point corresponding to <span class="math inline">\(|+\rangle\)</span>. Therefore, the curve traced by the <span class="math inline">\(|-\rangle\)</span> on the Bloch sphere is the inverted image of the curve traced by <span class="math inline">\(|+\rangle\)</span>. These two curves have the same orientation, therefore the same area, with opposite signs.</p>
<h4 id="two-band-lattice-models-and-their-chern-numbers">2.5 .3 Two-Band Lattice Models and Their Chern Numbers</h4>
<p>The simplest case where a Chern number can arise is a two-band system. Consider a particle with two internal states, hopping on a two-dimensional lattice. The two internal states can be the spin of the conduction electron, but can also be some sublattice index of a spin polarized electron. In the translation invariant bulk, the wave vector <span class="math inline">\(k =\left(k_{x}, k_{y}\right)\)</span> is a good quantum number, and the Hamiltonian reads <span class="math display">\[
\hat{H}( k )= d ( k ) \hat{\sigma}
\]</span> with the function <span class="math inline">\(d ( k )\)</span> mapping each point of the Brillouin Zone to a threedimensional vector. Since the Brillouin zone is a torus, the endpoints of the vectors <span class="math inline">\(d ( k )\)</span> map out a deformed torus in <span class="math inline">\(R ^{3} \backslash\{0\} .\)</span> This torus is a directed surface: its inside can be painted red, its outside, blue.</p>
<p>The Chern number of <span class="math inline">\(|-\rangle\)</span> (using the notation of Sect. <span class="math inline">\(1.2\)</span>, of <span class="math inline">\(\left.\left|u_{1}( k )\right\rangle\right)\)</span> is the flux of <span class="math inline">\(B _{-}( d )\)</span> through this torus. We have seen above that <span class="math inline">\(B _{-}( d )\)</span> is the magnetic field of a monopole at the origin <span class="math inline">\(d =0\)</span>. If the origin is on the inside of the torus, this flux is <span class="math inline">\(+1\)</span>. If it is outside of the torus, it is 0 . If the torus is turned inside out, and contains the origin, the flux is <span class="math inline">\(-1\)</span>. The torus can also intersect itself, and therefore contain the origin any number of times.</p>
<p>One way to count the number of times the torus contains the origin is as follows. Take any line from the origin to infinity, and count the number of times it intersects the torus, with a <span class="math inline">\(+1\)</span> for intersecting from the inside, and <span class="math inline">\(a -1\)</span> for intersecting from the outside. The sum is independent of the shape of the line, as long as it goes all the way from the origin to infinity.</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Topological-Physics/">Topological Physics</a>
                    
                      <a class="hover-with-bg" href="/categories/Topological-Physics/Book-Short-TI/">Book Short TI</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Topology/">Topology</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2016/11/03/topology07_book_short03/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">TI笔记3 极化与Berry相位</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2016/11/03/topology07_book_short01/">
                        <span class="hidden-mobile">TI笔记1 (SSH) Model</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>


      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 1,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "TI笔记2 Berry相位与陈数&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-svg.js" ></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  
















</body>
</html>
